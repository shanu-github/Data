<!DOCTYPE html>
<html style="min-height: 100%;" class=" js csstransforms3d csstransitions" lang="en-US"><head>
<meta charset="UTF-8">

<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<link rel="pingback" href="https://machinelearningmastery.com/xmlrpc.php">

<!--  Mobile viewport scale -->
<meta content="initial-scale=1.0, maximum-scale=1.0, user-scalable=yes" name="viewport">

<!-- This site is optimized with the Yoast SEO plugin v11.3 - https://yoast.com/wordpress/plugins/seo/ -->
<title>How to Grid Search Hyperparameters for Deep Learning Models in Python With Keras</title>
<link rel="canonical" href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/">
<meta property="og:locale" content="en_US">
<meta property="og:type" content="article">
<meta property="og:title" content="How to Grid Search Hyperparameters for Deep Learning Models in Python With Keras">
<meta property="og:description" content="Hyperparameter optimization is a big part of deep learning. The reason is that neural networks are notoriously difficult to configure and there are a lot of parameters&nbsp;that need to be set. On top of that, individual models can be very slow to train. In this post you will discover how you can use the grid …">
<meta property="og:url" content="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/">
<meta property="og:site_name" content="Machine Learning Mastery">
<meta property="article:publisher" content="https://www.facebook.com/MachineLearningMastery/">
<meta property="article:author" content="https://www.facebook.com/jason.brownlee.39">
<meta property="article:section" content="Deep Learning">
<meta property="article:published_time" content="2016-08-08T19:00:08+00:00">
<meta property="article:modified_time" content="2019-05-09T22:55:48+00:00">
<meta property="og:updated_time" content="2019-05-09T22:55:48+00:00">
<meta property="og:image" content="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/08/How-to-Grid-Search-Hyperparameters-for-Deep-Learning-Models-in-Python-With-Keras.jpg">
<meta property="og:image:secure_url" content="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/08/How-to-Grid-Search-Hyperparameters-for-Deep-Learning-Models-in-Python-With-Keras.jpg">
<meta property="og:image:width" content="640">
<meta property="og:image:height" content="359">
<script type="text/javascript" async="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/client.js"></script><script id="twitter-wjs" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/widgets.js"></script><script id="twitcount_plugins" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/twitcount.js"></script><script type="text/javascript" async="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/9556588.js"></script><script async="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/analytics.htm"></script><script type="application/ld+json" class="yoast-schema-graph yoast-schema-graph--main">{"@context":"https://schema.org","@graph":[{"@type":"Organization","@id":"https://machinelearningmastery.com/#organization","name":"Machine Learning Mastery","url":"https://machinelearningmastery.com/","sameAs":["https://www.facebook.com/MachineLearningMastery/","https://www.linkedin.com/in/jasonbrownlee","https://www.youtube.com/user/TeachTheMachine","https://twitter.com/TeachTheMachine"],"logo":{"@type":"ImageObject","@id":"https://machinelearningmastery.com/#logo","url":"https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon.png","width":512,"height":512,"caption":"Machine Learning Mastery"},"image":{"@id":"https://machinelearningmastery.com/#logo"}},{"@type":"WebSite","@id":"https://machinelearningmastery.com/#website","url":"https://machinelearningmastery.com/","name":"Machine Learning Mastery","publisher":{"@id":"https://machinelearningmastery.com/#organization"},"potentialAction":{"@type":"SearchAction","target":"https://machinelearningmastery.com/?s={search_term_string}","query-input":"required name=search_term_string"}},{"@type":"WebPage","@id":"https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#webpage","url":"https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/","inLanguage":"en-US","name":"How to Grid Search Hyperparameters for Deep Learning Models in Python With Keras","isPartOf":{"@id":"https://machinelearningmastery.com/#website"},"image":{"@type":"ImageObject","@id":"https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#primaryimage","url":"https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/08/How-to-Grid-Search-Hyperparameters-for-Deep-Learning-Models-in-Python-With-Keras.jpg","width":640,"height":359,"caption":"How to Grid Search Hyperparameters for Deep Learning Models in Python With Keras"},"primaryImageOfPage":{"@id":"https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#primaryimage"},"datePublished":"2016-08-08T19:00:08+00:00","dateModified":"2019-05-09T22:55:48+00:00"},{"@type":"Article","@id":"https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#article","isPartOf":{"@id":"https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#webpage"},"author":{"@id":"https://machinelearningmastery.com/author/jasonb/#author"},"headline":"How to Grid Search Hyperparameters for Deep Learning Models in Python With Keras","datePublished":"2016-08-08T19:00:08+00:00","dateModified":"2019-05-09T22:55:48+00:00","commentCount":"483","mainEntityOfPage":"https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#webpage","publisher":{"@id":"https://machinelearningmastery.com/#organization"},"image":{"@id":"https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#primaryimage"},"articleSection":"Deep Learning"},{"@type":["Person"],"@id":"https://machinelearningmastery.com/author/jasonb/#author","name":"Jason Brownlee","image":{"@type":"ImageObject","@id":"https://machinelearningmastery.com/#authorlogo","url":"https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=96&d=mm&r=g","caption":"Jason Brownlee"},"description":"Jason Brownlee, PhD is a machine learning specialist who teaches developers how to get results with modern machine learning methods via hands-on tutorials.","sameAs":["https://www.facebook.com/jason.brownlee.39","https://twitter.com/teachthemachine"]}]}</script>
<!-- / Yoast SEO plugin. -->

<link rel="dns-prefetch" href="https://s.w.org/">
<link rel="alternate" type="application/rss+xml" title="Machine Learning Mastery » Feed" href="https://feeds.feedburner.com/MachineLearningMastery">
<link rel="alternate" type="application/rss+xml" title="Machine Learning Mastery » Comments Feed" href="https://machinelearningmastery.com/comments/feed/">
<link rel="alternate" type="application/rss+xml" title="Machine Learning Mastery » How to Grid Search Hyperparameters for Deep Learning Models in Python With Keras Comments Feed" href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/feed/">
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/12.0.0-1\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/12.0.0-1\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/machinelearningmastery.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=5.2.1"}};
			!function(a,b,c){function d(a,b){var c=String.fromCharCode;l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,a),0,0);var d=k.toDataURL();l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,b),0,0);var e=k.toDataURL();return d===e}function e(a){var b;if(!l||!l.fillText)return!1;switch(l.textBaseline="top",l.font="600 32px Arial",a){case"flag":return!(b=d([55356,56826,55356,56819],[55356,56826,8203,55356,56819]))&&(b=d([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]),!b);case"emoji":return b=d([55357,56424,55356,57342,8205,55358,56605,8205,55357,56424,55356,57340],[55357,56424,55356,57342,8203,55358,56605,8203,55357,56424,55356,57340]),!b}return!1}function f(a){var c=b.createElement("script");c.src=a,c.defer=c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var g,h,i,j,k=b.createElement("canvas"),l=k.getContext&&k.getContext("2d");for(j=Array("flag","emoji"),c.supports={everything:!0,everythingExceptFlag:!0},i=0;i<j.length;i++)c.supports[j[i]]=e(j[i]),c.supports.everything=c.supports.everything&&c.supports[j[i]],"flag"!==j[i]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[j[i]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(h=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",h,!1),a.addEventListener("load",h,!1)):(a.attachEvent("onload",h),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),g=c.source||{},g.concatemoji?f(g.concatemoji):g.wpemoji&&g.twemoji&&(f(g.twemoji),f(g.wpemoji)))}(window,document,window._wpemojiSettings);
		</script><script src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/wp-emoji-release.js" type="text/javascript" defer="defer"></script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
	<link rel="stylesheet" id="crayon-css" href="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/crayon.css" type="text/css" media="all">
<link rel="stylesheet" id="crayon-theme-classic-css" href="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/classic.css" type="text/css" media="all">
<link rel="stylesheet" id="crayon-font-monaco-css" href="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/monaco.css" type="text/css" media="all">
<link rel="stylesheet" id="wp-block-library-css" href="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/style.css" type="text/css" media="all">
<link rel="stylesheet" id="contact-form-7-css" href="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/styles.css" type="text/css" media="all">
<link rel="stylesheet" id="ssb-front-css-css" href="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/front.css" type="text/css" media="all">
<link rel="stylesheet" id="ewd-ufaq-style-css" href="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/ewd-ufaq-styles.css" type="text/css" media="all">
<link rel="stylesheet" id="ewd-ufaq-rrssb-css" href="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/rrssb-min.css" type="text/css" media="all">
<link rel="stylesheet" id="woo-testimonials-css-css" href="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/testimonials.css" type="text/css" media="all">
<link rel="stylesheet" id="theme-stylesheet-css" href="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/style_002.css" type="text/css" media="all">
<!--[if lt IE 9]>
<link href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/themes/canvas-new/css/non-responsive.css" rel="stylesheet" type="text/css" />
<style type="text/css">.col-full, #wrapper { width: 960px; max-width: 960px; } #inner-wrapper { padding: 0; } body.full-width #header, #nav-container, body.full-width #content, body.full-width #footer-widgets, body.full-width #footer { padding-left: 0; padding-right: 0; } body.fixed-mobile #top, body.fixed-mobile #header-container, body.fixed-mobile #footer-container, body.fixed-mobile #nav-container, body.fixed-mobile #footer-widgets-container { min-width: 960px; padding: 0 1em; } body.full-width #content { width: auto; padding: 0 1em;}</style>
<![endif]-->
<script type="text/javascript" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/jquery.js"></script>
<script type="text/javascript" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/jquery-migrate.js"></script>
<script type="text/javascript">
/* <![CDATA[ */
var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","ajaxurl":"https:\/\/machinelearningmastery.com\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
/* ]]> */
</script>
<script type="text/javascript" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/crayon.js"></script>
<script type="text/javascript" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/front.js"></script>
<script type="text/javascript" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/third-party.js"></script>
<script type="text/javascript" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/modernizr.js"></script>
<script type="text/javascript" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/general.js"></script>
<link rel="https://api.w.org/" href="https://machinelearningmastery.com/wp-json/">
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://machinelearningmastery.com/xmlrpc.php?rsd">
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-includes/wlwmanifest.xml"> 
<link rel="shortlink" href="https://machinelearningmastery.com/?p=2967">
<link rel="alternate" type="application/json+oembed" href="https://machinelearningmastery.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fmachinelearningmastery.com%2Fgrid-search-hyperparameters-deep-learning-models-python-keras%2F">
<link rel="alternate" type="text/xml+oembed" href="https://machinelearningmastery.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fmachinelearningmastery.com%2Fgrid-search-hyperparameters-deep-learning-models-python-keras%2F&amp;format=xml">
<!-- Start Google Analytics -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-44039733-3', 'auto');
  ga('send', 'pageview');

</script>
<!-- End Google Analytics -->

 <style media="screen">

        .simplesocialbuttons.simplesocialbuttons_inline .ssb-fb-like {
      margin: ;
    }
         /*inline margin*/
    
  
  
  
  
  
          .simplesocialbuttons.simplesocialbuttons_inline.simplesocial-simple-icons button{
         margin: ;
     }

          /*margin-digbar*/

  
  
  
  
 
   
   

</style>
    <script type="text/javascript">
        var ajaxurl = 'https://machinelearningmastery.com/wp-admin/admin-ajax.php';
    </script>

<!-- Custom CSS Styling -->
<style type="text/css">
#logo .site-title, #logo .site-description { display:none; }
body {background-repeat:no-repeat;background-position:top left;background-attachment:scroll;border-top:0px solid #000000;}
#header {background-repeat:no-repeat;background-position:left top;margin-top:0px;margin-bottom:0px;padding-top:10px;padding-bottom:10px;border:0px solid ;}
#logo .site-title a {font:bold 40px/1em "Helvetica Neue", Helvetica, sans-serif;color:#222222;}
#logo .site-description {font:normal 13px/1em "Helvetica Neue", Helvetica, sans-serif;color:#999999;}
body, p { font:normal 14px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
h1 { font:bold 28px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h2 { font:bold 24px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h3 { font:bold 20px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h4 { font:bold 16px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h5 { font:bold 14px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h6 { font:bold 12px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }
.page-title, .post .title, .page .title {font:bold 28px/1.1em "Helvetica Neue", Helvetica, sans-serif;color:#222222;}
.post .title a:link, .post .title a:visited, .page .title a:link, .page .title a:visited {color:#222222}
.post-meta { font:normal 12px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#999999; }
.entry, .entry p{ font:normal 15px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
.post-more {font:normal 13px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:;border-top:0px solid #e6e6e6;border-bottom:0px solid #e6e6e6;}
#post-author, #connect {border-top:1px solid #e6e6e6;border-bottom:1px solid #e6e6e6;border-left:1px solid #e6e6e6;border-right:1px solid #e6e6e6;border-radius:5px;-moz-border-radius:5px;-webkit-border-radius:5px;background-color:#fafafa}
.nav-entries a, .woo-pagination { font:normal 13px/1em "Helvetica Neue", Helvetica, sans-serif;color:#888; }
.woo-pagination a, .woo-pagination a:hover {color:#888!important}
.widget h3 {font:bold 14px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#555555;border-bottom:1px solid #e6e6e6;}
.widget_recent_comments li, #twitter li { border-color: #e6e6e6;}
.widget p, .widget .textwidget { font:normal 13px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
.widget {font:normal 13px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555;border-radius:0px;-moz-border-radius:0px;-webkit-border-radius:0px;}
#tabs .inside li a, .widget_woodojo_tabs .tabbable .tab-pane li a { font:bold 12px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
#tabs .inside li span.meta, .widget_woodojo_tabs .tabbable .tab-pane li span.meta { font:300 11px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#999999; }
#tabs ul.wooTabs li a, .widget_woodojo_tabs .tabbable .nav-tabs li a { font:300 11px/2em "Helvetica Neue", Helvetica, sans-serif;color:#999999; }
@media only screen and (min-width:768px) {
ul.nav li a, #navigation ul.rss a, #navigation ul.cart a.cart-contents, #navigation .cart-contents #navigation ul.rss, #navigation ul.nav-search, #navigation ul.nav-search a { font:bold 18px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#4c89bf; } #navigation ul.rss li a:before, #navigation ul.nav-search a.search-contents:before { color:#4c89bf;}
#navigation ul.nav > li a:hover, #navigation ul.nav > li:hover a, #navigation ul.nav li ul li a, #navigation ul.cart > li:hover > a, #navigation ul.cart > li > ul > div, #navigation ul.cart > li > ul > div p, #navigation ul.cart > li > ul span, #navigation ul.cart .cart_list a, #navigation ul.nav li.current_page_item a, #navigation ul.nav li.current_page_parent a, #navigation ul.nav li.current-menu-ancestor a, #navigation ul.nav li.current-cat a, #navigation ul.nav li.current-menu-item a { color:#4c89bf!important; }
#navigation ul.nav > li a:hover, #navigation ul.nav > li:hover, #navigation ul.nav li ul, #navigation ul.cart li:hover a.cart-contents, #navigation ul.nav-search li:hover a.search-contents, #navigation ul.nav-search a.search-contents + ul, #navigation ul.cart a.cart-contents + ul, #navigation ul.nav li.current_page_item a, #navigation ul.nav li.current_page_parent a, #navigation ul.nav li.current-menu-ancestor a, #navigation ul.nav li.current-cat a, #navigation ul.nav li.current-menu-item a{background-color:#ffffff!important}
#navigation ul.nav li ul, #navigation ul.cart > li > ul > div  { border: 0px solid #dbdbdb; }
#navigation ul.nav > li:hover > ul  { left: 0; }
#navigation ul.nav > li  { border-right: 0px solid #dbdbdb; }#navigation ul.nav > li:hover > ul  { left: 0; }
#navigation { box-shadow: none; -moz-box-shadow: none; -webkit-box-shadow: none; }#navigation ul li:first-child, #navigation ul li:first-child a { border-radius:0px 0 0 0px; -moz-border-radius:0px 0 0 0px; -webkit-border-radius:0px 0 0 0px; }
#navigation {background:#ffffff;border-top:0px solid #dbdbdb;border-bottom:0px solid #dbdbdb;border-left:0px solid #dbdbdb;border-right:0px solid #dbdbdb;border-radius:0px; -moz-border-radius:0px; -webkit-border-radius:0px;}
#top ul.nav li a { font:normal 12px/1.6em "Helvetica Neue", Helvetica, sans-serif;color:#ddd; }
}
#footer, #footer p { font:normal 13px/1.4em "Helvetica Neue", Helvetica, sans-serif;color:#999999; }
#footer {border-top:1px solid #dbdbdb;border-bottom:0px solid ;border-left:0px solid ;border-right:0px solid ;border-radius:0px; -moz-border-radius:0px; -webkit-border-radius:0px;}
.magazine #loopedSlider .content h2.title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-magazine .slide-title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.magazine #loopedSlider .content .excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-magazine .slide-content p, .wooslider-theme-magazine .slide-excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.magazine .block .post .title a {font:bold 18px/1.2em Helvetica Neue, Helvetica, sans-serif;color:#222222; }
#loopedSlider.business-slider .content h2 { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
#loopedSlider.business-slider .content h2.title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-business .has-featured-image .slide-title { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.wooslider-theme-business .has-featured-image .slide-title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
#wrapper #loopedSlider.business-slider .content p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-business .has-featured-image .slide-content p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.wooslider-theme-business .has-featured-image .slide-excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.archive_header { font:bold 18px/1em Arial, sans-serif;color:#222222; }
.archive_header {border-bottom:1px solid #e6e6e6;}
.archive_header .catrss { display:none; }
</style>

<!-- Woo Shortcodes CSS -->
<link href="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/shortcodes.css" rel="stylesheet" type="text/css">

<!-- Custom Stylesheet -->
<link href="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/custom.css" rel="stylesheet" type="text/css">

<!-- Theme version -->
<meta name="generator" content="Canvas 5.9.21">
<meta name="generator" content="WooFramework 6.2.9">
<link rel="icon" href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-32x32.png" sizes="32x32">
<link rel="icon" href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-192x192.png" sizes="192x192">
<link rel="apple-touch-icon-precomposed" href="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-180x180.png">
<meta name="msapplication-TileImage" content="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/09/cropped-icon-270x270.png">
<script src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/can-i-show.js"></script><style id="fit-vids-style">.fluid-width-video-wrapper{width:100%;position:relative;padding:0;}.fluid-width-video-wrapper iframe,.fluid-width-video-wrapper object,.fluid-width-video-wrapper embed {position:absolute;top:0;left:0;width:100%;height:100%;}</style><link rel="stylesheet" type="text/css" href="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/twitcount.css" media="all"><style type="text/css">
  /* === Form-Specific Styles === */
  /* stylelint-disable */

  #drip-2211 .drip-content,
  #drip-2211 .drip-header {
    background: rgb(9,123,156) !important;
    background: rgba(9,123,156,0.90) !important;
  }

  #drip-2211 .drip-content h3 {
    color: #333333 !important;
    font-size: 21px !important;
  }

  #drip-2211 .drip-submit-button {
    background-color: #333333 !important;
    font-size: 12px !important;
  }

  #drip-2211 .drip-submit-button:hover {
    background-color: #191919 !important;
  }

  #drip-2211 .drip-submit-button:active {
    background-color: #000000 !important;
  }

  #drip-2211 dl dt,
  #drip-2211 .drip-content .drip-description,
  #drip-2211 .drip-content .classic--checkbox,
  #drip-2211 .drip-errors {
    font-size: 13px !important;
  }

  #drip-2211 .drip-text-field {
    font-size: 14px !important;
  }

  /* === Reset styles === */

  .drip-tab h1,
  .drip-tab h2,
  .drip-tab h3,
  .drip-tab div,
  .drip-tab dl,
  .drip-tab dt,
  .drip-tab dd,
  .drip-tab p,
  .drip-tab a,
  .drip-tab .drip-text-field,
  .drip-tab .drip-text-field:focus,
  .drip-tab .drip-submit-button {
    margin: 0;
    padding: 0;
    border: 0;
    font-size: 100%;
    font: inherit;
    vertical-align: baseline;
    float: none;
    width: auto;
    background-image: none;
    letter-spacing: 0;
    -webkit-box-shadow: none;
       -moz-box-shadow: none;
            box-shadow: none;
    -webkit-text-shadow: none !important;
       -moz-text-shadow: none !important;
            text-shadow: none !important;
  }

  .drip-tab a {
    text-decoration: none;
  }

  .drip-tab :focus {
    outline: 0;
  }

  /* === Clearfix === */

  .drip-clearfix:after {
    visibility: hidden;
    display: block;
    font-size: 0;
    content: " ";
    clear: both;
    height: 0;
  }
  * html .drip-clearfix             { zoom: 1; } /* IE6 */
  *:first-child+html .drip-clearfix { zoom: 1; } /* IE7 */

  /* === Main Container === */

  .drip-tab-container * {
    box-sizing: content-box;
  }

  /* === Content === */

  .drip-tab .drip-content {
    margin: 0;
    padding: 5px;
    width: 330px;
    position: fixed;
    font-size: 100%;
    font: inherit;
    z-index: 10000;
    color: #333;
    vertical-align: baseline;
    text-align: left;
    box-sizing: border-box;
    -webkit-box-shadow: 0px 0px 20px rgba(0,0,0,0.25);
       -moz-box-shadow: 0px 0px 20px rgba(0,0,0,0.25);
            box-shadow: 0px 0px 20px rgba(0,0,0,0.25);
  }

  .drip-tab.bottom .drip-content {
    bottom: -800px;
    -webkit-border-radius: 8px 8px 0 0;
       -moz-border-radius: 8px 8px 0 0;
            border-radius: 8px 8px 0 0;
    -webkit-transition: bottom 200ms ease-in;
       -moz-transition: bottom 200ms ease-in;
         -o-transition: bottom 200ms ease-in;
            transition: bottom 200ms ease-in;
  }

  .drip-tab.bottom.left .drip-content {
    left: 40px;
  }

  .drip-tab.bottom.right .drip-content {
    right: 40px;
  }

  .drip-tab.image-left .drip-content,
  .drip-tab.image-right .drip-content {
    width: 510px;
  }

  .drip-tab.side .drip-content {
    top: 10%;
  }

  .drip-tab.side.right .drip-content {
    right: -550px;
    -webkit-border-radius: 8px 0 0 8px;
       -moz-border-radius: 8px 0 0 8px;
            border-radius: 8px 0 0 8px;
    -webkit-transition: right 200ms ease-in;
       -moz-transition: right 200ms ease-in;
         -o-transition: right 200ms ease-in;
            transition: right 200ms ease-in;
  }

  .drip-tab.side.left .drip-content {
    left: -550px;
    -webkit-border-radius: 0 8px 8px 0;
       -moz-border-radius: 0 8px 8px 0;
            border-radius: 0 8px 8px 0;
    -webkit-transition: left 200ms ease-in;
       -moz-transition: left 200ms ease-in;
         -o-transition: left 200ms ease-in;
            transition: left 200ms ease-in;
  }

  .drip-tab.mobile .drip-content {
    width: 100% !important;
    bottom: -800px;
    left: 0;
    -webkit-border-radius: 0;
       -moz-border-radius: 0;
            border-radius: 0;
    -webkit-transition: bottom 200ms ease-in;
       -moz-transition: bottom 200ms ease-in;
         -o-transition: bottom 200ms ease-in;
            transition: bottom 200ms ease-in;
  }

  .drip-tab.drip-scrollable .drip-content {
    overflow-y: scroll;
  }

  /* === Header === */

  .drip-tab .drip-header {
    margin: 0;
    padding: 0;
    position: fixed;
    font-size: 100%;
    font: inherit;
    z-index: 10000;
    color: #333;
    vertical-align: baseline;
    text-align: left;
    -webkit-border-radius: 8px 8px 0 0;
       -moz-border-radius: 8px 8px 0 0;
            border-radius: 8px 8px 0 0;
    -webkit-box-shadow: 0px 10px 28px rgba(0,0,0,0.36);
       -moz-box-shadow: 0px 10px 28px rgba(0,0,0,0.36);
            box-shadow: 0px 10px 28px rgba(0,0,0,0.36);
  }

  .drip-tab.bottom .drip-header {
    width: 330px;
    bottom: 0;
    -webkit-transition: bottom 200ms ease-in;
       -moz-transition: bottom 200ms ease-in;
         -o-transition: bottom 200ms ease-in;
            transition: bottom 200ms ease-in;
  }

  .drip-tab.bottom .drip-header.drip-hidden {
    bottom: -800px;
  }

  .drip-tab.bottom.left .drip-header {
    left: 40px;
  }

  .drip-tab.bottom.right .drip-header {
    right: 40px;
  }

  .drip-tab.bottom.image-left .drip-header,
  .drip-tab.bottom.image-right .drip-header {
    width: 510px;
  }

  .drip-tab.side .drip-header {
    width: 330px;
    top: 10%;
  }

  .drip-tab.side.right .drip-header {
    right: -100px;
    -webkit-transition: right 400ms ease-in;
       -moz-transition: right 400ms ease-in;
         -o-transition: right 400ms ease-in;
            transition: right 400ms ease-in;
    -webkit-transform: rotate(-90deg) !important;
       -moz-transform: rotate(-90deg) !important;
        -ms-transform: rotate(-90deg) !important;
         -o-transform: rotate(-90deg) !important;
            transform: rotate(-90deg) !important;
    -webkit-transform-origin: right center;
       -moz-transform-origin: right center;
         -o-transform-origin: right center;
            transform-origin: right center;
  }

  .drip-tab.side.right .drip-header.drip-hidden {
    right: -100px;
  }

  .drip-tab.side.left .drip-header {
    left: -100px;
    -webkit-transition: left 400ms ease-in;
       -moz-transition: left 400ms ease-in;
         -o-transition: left 400ms ease-in;
            transition: left 400ms ease-in;
    -webkit-transform: rotate(90deg) !important;
       -moz-transform: rotate(90deg) !important;
        -ms-transform: rotate(90deg) !important;
         -o-transform: rotate(90deg) !important;
            transform: rotate(90deg) !important;
    -webkit-transform-origin: left center;
       -moz-transform-origin: left center;
         -o-transform-origin: left center;
            transform-origin: left center;
  }

  .drip-tab.side.left .drip-header.drip-hidden {
    left: -100px;
  }

  .drip-tab.mobile .drip-header {
    width: 100% !important;
    bottom: 0;
    left: 0;
    -webkit-border-radius: 0;
       -moz-border-radius: 0;
            border-radius: 0;
    -webkit-transition: bottom 200ms ease-in;
       -moz-transition: bottom 200ms ease-in;
         -o-transition: bottom 200ms ease-in;
            transition: bottom 200ms ease-in;
  }

  .drip-tab.mobile .drip-header.drip-hidden {
    bottom: -300px;
  }

  /* === Header Toggle === */

  .drip-tab .drip-toggle {
    display: block;
    text-decoration: none;
    padding: 10px 50px 10px 20px; /* extra padding for the arrow */
  }

  /* === Teaser === */

  .drip-tab .drip-header h2 {
    display: block;
    margin: 0 !important;
    padding: 0 !important;
    border: 0 !important;
    font-size: 14px !important;
    line-height: 1.5 !important;
    font-weight: bold !important;
    text-align: left !important;
    color: #fff !important;
    clear: none !important;
    letter-spacing: 0 !important;
    width: auto !important;
  }

  /* === Arrows === */

  .drip-tab .drip-header span.drip-arrow {
    display: block;
    position: absolute;
    margin: 0;
    padding: 0;
    width: 0;
    height: 0;
    line-height: 0;
    top: 17px;
    right: 32px;
  }

  /* === Panel === */

  .drip-tab .drip-content > div.drip-panel {
    padding: 15px 15px 12px;
    background-color: #fff;
    -webkit-border-radius: 6px;
       -moz-border-radius: 6px;
            border-radius: 6px;
  }

  /* === Powered By === */

  .drip-tab .drip-powered-by {
    padding: 8px;
    margin-bottom: -5px;
    font-family: Helvetica, Arial, sans-serif;
    text-align: left;
    font-weight: bold;
    font-size: 10px;
    line-height: 16px;
    color: #ffffff;
    letter-spacing: 1px;
    text-align: center;
    text-transform: uppercase;
    display: -webkit-box;
    display: -ms-flexbox;
    display: -webkit-flex;
    display: flex;
    justify-content: center;
    align-items: center;
  }

  .drip-tab .drip-powered-by a {
    color: #ffffff !important;
    text-decoration: underline !important;
    letter-spacing: 1px;
    margin-left: 6px;
  }

  /* === Content Headings & Paragraphs === */

  .drip-tab .drip-content h3 {
    display: block;
    margin: 0 20px 0 0 !important;
    padding: 0 0 15px 0 !important;
    line-height: 1.4 !important;
    font-weight: bold !important;
    text-align: left !important;
    color: #4477bd !important;
    clear: none !important;
  }

  .drip-tab .drip-content .drip-description {
    margin: 0;
    padding: 0 0 20px 0;
    line-height: 1.6;
    text-align: left;
  }

  .drip-tab.image-left .drip-content .drip-description {
    margin-left: 170px;
  }

  .drip-tab.image-right .drip-content .drip-description {
    margin-right: 170px;
  }

  @media screen and (max-width: 510px) {
    .drip-tab.image-left .drip-content .drip-description {
      margin-left: 0; /* 120px; */
    }

    .drip-tab.image-right .drip-content .drip-description {
      margin-right: 0; /* 120px; */
    }
  }

  .drip-tab .drip-content .drip-description a {
    text-decoration: underline;
  }

  .drip-tab .drip-content .drip-description em {
    font-style: italic;
  }

  .drip-tab .drip-content .drip-description ul,
  .drip-tab .drip-content .drip-description ol {
    list-style-position: outside;
    margin: 8px 0 8px 30px;
  }

  .drip-tab .drip-content .drip-description ul li
  .drip-tab .drip-content .drip-description ol li {
    padding: 0;
  }

  .drip-tab .drip-content img.drip-image {
    margin-bottom: 20px;
  }

  .drip-tab.image-left .drip-content img.drip-image {
    float: left;
    width: 150px;
  }

  .drip-tab.image-right .drip-content img.drip-image {
    float: right;
    width: 150px;
  }

  @media screen and (max-width: 510px) {
    .drip-tab.image-left .drip-content img.drip-image {
      margin-right: 20px;
      width: 100px;
    }

    .drip-tab.image-right .drip-content img.drip-image {
      margin-left: 20px;
      width: 100px;
    }
  }

  .drip-tab .drip-content a.drip-close {
    font-family: Arial, Helvetica, sans-serif;
    margin: -1px 0 0 0;
    float: right;
    font-size: 28px;
    line-height: 15px;
    font-weight: normal;
    color: #333;
    opacity: 0.4;
  }

  .drip-tab .drip-content a.drip-close:hover {
    text-decoration: none;
    cursor: pointer;
    opacity: 0.6;
  }

  /* === Content Subscribe Form === */

  .drip-tab form {
    margin: 0 !important;
    padding: 0 !important;
  }

  .drip-tab dl {
    display: block;
    margin: 0;
    padding: 0;
  }

  .drip-tab dl dt {
    display: block;
    padding: 0 0 5px 0;
    font-weight: bold;
  }

  .drip-tab dl.no-labels dt {
    display: none;
  }

  .drip-tab dl dd {
    display: block;
    padding: 0 0 10px 0;
  }

  .drip-tab .drip-text-field {
    margin: 0 !important;
    padding: 6px !important;
    height: auto !important;
    width: 100% !important;
    color: #333 !important;
    background-color: #fff !important;
    border: 1px solid #c4c4c4 !important;
    -webkit-box-shadow: inset 0 0 3px rgba(0,0,0,0.18) !important;
       -moz-box-shadow: inset 0 0 3px rgba(0,0,0,0.18) !important;
            box-shadow: inset 0 0 3px rgba(0,0,0,0.18) !important;
    -webkit-border-radius: 4px !important;
       -moz-border-radius: 4px !important;
            border-radius: 4px !important;
    -webkit-box-sizing: border-box !important;
       -moz-box-sizing: border-box !important;
        -ms-box-sizing: border-box !important;
            box-sizing: border-box !important;
    background-image: none !important;
    min-width: 0 !important;
    min-height: 0 !important;
  }

  .drip-tab .drip-text-field::-webkit-input-placeholder { /* WebKit browsers */
    color: #999999 !important;
  }
  .drip-tab .drip-text-field:-moz-placeholder { /* Mozilla Firefox 4 to 18 */
    color: #999999 !important;
  }
  .drip-tab .drip-text-field::-moz-placeholder { /* Mozilla Firefox 19+ */
    color: #999999 !important;
  }
  .drip-tab .drip-text-field:-ms-input-placeholder { /* Internet Explorer 10+ */
    color: #999999 !important;
  }

  .drip-tab .drip-text-field:focus {
    border-color: #a4a4a4 !important;
    outline: 0;
    background-image: none;
    background-color: #fff !important;
  }

  .drip-tab.mobile .drip-text-field {
    font-size: 16px;
  }

  .drip-tab .drip-errors {
    padding: 5px 0 0 0;
    font-weight: normal;
    color: red;
  }

  .drip-tab .drip-submit-button {
    font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif !important;
    padding: 3px 12px !important;
    color: #ffffff !important;
    font-weight: bold !important;
    line-height: 1.6 !important;
    border: 0 !important;
    -webkit-border-radius: 15px !important;
       -moz-border-radius: 15px !important;
            border-radius: 15px !important;
    cursor: pointer !important;
    background-image: none !important;
    min-width: 0 !important;
    min-height: 0 !important;
    height: auto;
  }

  .drip-tab .drip-submit-button:hover {
    background-image: none !important;
  }

  .drip-tab .drip-submit-button:active {
    background-image: none !important;
  }

  /* checkbox */
  .drip-tab .classic--checkbox.hidden {
    margin-bottom: -8px;
    display: none;
  }

  .drip-tab .classic--checkbox input[type="checkbox"] {
    display: inline-block;
    width: auto;
  }

  /* stylelint-enable */

</style></head>
<body class="post-template-default single single-post postid-2967 single-format-standard chrome alt-style-default two-col-left width-960 two-col-left-960">
<div id="wrapper">

	<div id="inner-wrapper">

	<h3 class="nav-toggle icon"><a href="#navigation">Navigation</a></h3>

	<header id="header" class="col-full">

		<div id="logo">
<a href="https://machinelearningmastery.com/" title="Making developers awesome at machine learning"><img src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/icon-100x100.png" alt="Machine Learning Mastery"></a>
<span class="site-title"><a href="https://machinelearningmastery.com/">Machine Learning Mastery</a></span>
<span class="site-description">Making developers awesome at machine learning</span>
</div>
	    <div class="header-widget">
	        <div id="text-32" class="widget widget_text">			<div class="textwidget"><p>Want help with deep learning? <a href="https://machinelearningmastery.lpages.co/deep-learning-with-python-mini-course/">Take the FREE Mini-Course</a></p>
</div>
		</div><div id="search-3" class="widget widget_search"><div class="search_main">
    <form method="get" class="searchform" action="https://machinelearningmastery.com/">
        <input class="field s" name="s" value="Search..." onfocus="if (this.value == 'Search...') {this.value = '';}" onblur="if (this.value == '') {this.value = 'Search...';}" type="text">
		<input name="post_type" value="post" type="hidden">
        <button type="submit" class="fa fa-search submit" name="submit" value="Search"></button>
    </form>
    <div class="fix"></div>
</div></div>	    </div>
	
	</header>
	<nav id="navigation" class="col-full" role="navigation">

	
	<section class="menus">

		<a href="https://machinelearningmastery.com/" class="nav-home"><span>Home</span></a>

	<h3>Main Menu</h3><ul id="main-nav" class="nav fl"><li id="menu-item-6503" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6503"><a href="https://machinelearningmastery.com/start-here/">Start Here</a></li>
<li id="menu-item-6501" class="menu-item menu-item-type-post_type menu-item-object-page current_page_parent menu-item-6501"><a href="https://machinelearningmastery.com/blog/">Blog</a></li>
<li id="menu-item-6506" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-6506 parent"><a href="#">Topics</a>
<ul class="sub-menu">
	<li id="menu-item-6508" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-6508"><a href="https://machinelearningmastery.com/category/deep-learning/">Deep Learning (Keras)</a></li>
	<li id="menu-item-7921" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-7921"><a href="https://machinelearningmastery.com/category/deep-learning-for-computer-vision/">Deep Learning for Computer Vision</a></li>
	<li id="menu-item-6509" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6509"><a href="https://machinelearningmastery.com/category/deep-learning-time-series/">Deep Learning for Time Series</a></li>
	<li id="menu-item-6515" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6515"><a href="https://machinelearningmastery.com/category/natural-language-processing/">Deep Learning for NLP</a></li>
	<li id="menu-item-6511" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6511"><a href="https://machinelearningmastery.com/category/lstm/">LSTMs</a></li>
	<li id="menu-item-7106" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-7106"><a href="https://machinelearningmastery.com/category/better-deep-learning/">Better Deep Learning</a></li>
	<li id="menu-item-6512" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6512"><a href="https://machinelearningmastery.com/category/machine-learning-algorithms/">Understand Algorithms</a></li>
	<li id="menu-item-6507" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6507"><a href="https://machinelearningmastery.com/category/algorithms-from-scratch/">Code Algorithms (Python)</a></li>
	<li id="menu-item-6513" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6513"><a href="https://machinelearningmastery.com/category/machine-learning-process/">Machine Learning Process</a></li>
	<li id="menu-item-6516" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6516"><a href="https://machinelearningmastery.com/category/python-machine-learning/">Python (scikit-learn)</a></li>
	<li id="menu-item-6517" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6517"><a href="https://machinelearningmastery.com/category/r-machine-learning/">R (caret)</a></li>
	<li id="menu-item-6522" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6522"><a href="https://machinelearningmastery.com/category/weka-machine-learning/">Weka (no code)</a></li>
	<li id="menu-item-6518" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6518"><a href="https://machinelearningmastery.com/category/start-machine-learning/">Getting Started</a></li>
	<li id="menu-item-6510" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6510"><a href="https://machinelearningmastery.com/category/linear-algebra/">Linear Algebra</a></li>
	<li id="menu-item-6519" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6519"><a href="https://machinelearningmastery.com/category/statistical-methods/">Statistical Methods</a></li>
	<li id="menu-item-6520" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6520"><a href="https://machinelearningmastery.com/category/time-series/">Time Series (introductory)</a></li>
	<li id="menu-item-6523" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6523"><a href="https://machinelearningmastery.com/category/xgboost/">XGBoost</a></li>
</ul>
</li>
<li id="menu-item-6502" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6502"><a href="https://machinelearningmastery.com/products/">Books</a></li>
<li id="menu-item-6500" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6500"><a href="https://machinelearningmastery.com/faq/">FAQ</a></li>
<li id="menu-item-6504" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6504"><a href="https://machinelearningmastery.com/about/">About</a></li>
<li id="menu-item-6505" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6505"><a href="https://machinelearningmastery.com/contact/">Contact</a></li>
</ul>	<div class="side-nav">
		</div><!-- /#side-nav -->

	</section><!-- /.menus -->

	<a href="#top" class="nav-close"><span>Return to Content</span></a>

</nav>
       
    <!-- #content Starts -->
	    <div id="content" class="col-full">
    
    	<div id="main-sidebar-container">    

            <!-- #main Starts -->
                        <section id="main">                       
<article class="post-2967 post type-post status-publish format-standard has-post-thumbnail hentry category-deep-learning">
	<header>
	<h1 class="title entry-title">How to Grid Search Hyperparameters for Deep Learning Models in Python With Keras</h1>	</header>
<div class="post-meta"><span class="small">By</span> <span class="author vcard"><span class="fn"><a href="https://machinelearningmastery.com/author/jasonb/" title="Posts by Jason Brownlee" rel="author">Jason Brownlee</a></span></span> <span class="small">on</span> <abbr class="date time published updated" title="2016-08-09T05:00:08+1000">August 9, 2016</abbr>  <span class="small">in</span> <span class="categories"><a href="https://machinelearningmastery.com/category/deep-learning/" title="View all items in Deep Learning">Deep Learning</a></span>  </div>
	<section class="entry">
<div class="simplesocialbuttons simplesocial-simple-icons simplesocialbuttons_inline simplesocialbuttons-align-left post-2967 post  simplesocialbuttons-inline-no-animation simplesocialbuttons-inline-in">
<button class="ssb_tweet-icon" data-href="https://twitter.com/share?text=How+to+Grid+Search+Hyperparameters+for+Deep+Learning+Models+in+Python+With+Keras&amp;url=https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/" rel="nofollow" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;">
						<span class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 72 72"><path fill="none" d="M0 0h72v72H0z"></path><path class="icon" fill="#fff" d="M68.812 15.14c-2.348 1.04-4.87 1.744-7.52 2.06 2.704-1.62 4.78-4.186 5.757-7.243-2.53 1.5-5.33 2.592-8.314 3.176C56.35 10.59 52.948 9 49.182 9c-7.23 0-13.092 5.86-13.092 13.093 0 1.026.118 2.02.338 2.98C25.543 24.527 15.9 19.318 9.44 11.396c-1.125 1.936-1.77 4.184-1.77 6.58 0 4.543 2.312 8.552 5.824 10.9-2.146-.07-4.165-.658-5.93-1.64-.002.056-.002.11-.002.163 0 6.345 4.513 11.638 10.504 12.84-1.1.298-2.256.457-3.45.457-.845 0-1.666-.078-2.464-.23 1.667 5.2 6.5 8.985 12.23 9.09-4.482 3.51-10.13 5.605-16.26 5.605-1.055 0-2.096-.06-3.122-.184 5.794 3.717 12.676 5.882 20.067 5.882 24.083 0 37.25-19.95 37.25-37.25 0-.565-.013-1.133-.038-1.693 2.558-1.847 4.778-4.15 6.532-6.774z"></path></svg></span><i class="simplesocialtxt">Tweet </i></button>
		<button class="ssb_fbshare-icon" target="_blank" data-href="https://www.facebook.com/sharer/sharer.php?u=https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;">
						<span class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" class="_1pbq" color="#ffffff"><path fill="#ffffff" fill-rule="evenodd" class="icon" d="M8 14H3.667C2.733 13.9 2 13.167 2 12.233V3.667A1.65 1.65 0 0 1 3.667 2h8.666A1.65 1.65 0 0 1 14 3.667v8.566c0 .934-.733 1.667-1.667 1.767H10v-3.967h1.3l.7-2.066h-2V6.933c0-.466.167-.9.867-.9H12v-1.8c.033 0-.933-.266-1.533-.266-1.267 0-2.434.7-2.467 2.133v1.867H6v2.066h2V14z"></path></svg></span>
						<span class="simplesocialtxt">Share </span> </button>
<button class="ssb_linkedin-icon" data-href="https://www.linkedin.com/cws/share?url=https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;">
						<span class="icon"> <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="15px" height="14.1px" viewBox="-301.4 387.5 15 14.1" enable-background="new -301.4 387.5 15 14.1" xml:space="preserve"> <g id="XMLID_398_"> <path id="XMLID_399_" fill="#FFFFFF" d="M-296.2,401.6c0-3.2,0-6.3,0-9.5h0.1c1,0,2,0,2.9,0c0.1,0,0.1,0,0.1,0.1c0,0.4,0,0.8,0,1.2 c0.1-0.1,0.2-0.3,0.3-0.4c0.5-0.7,1.2-1,2.1-1.1c0.8-0.1,1.5,0,2.2,0.3c0.7,0.4,1.2,0.8,1.5,1.4c0.4,0.8,0.6,1.7,0.6,2.5 c0,1.8,0,3.6,0,5.4v0.1c-1.1,0-2.1,0-3.2,0c0-0.1,0-0.1,0-0.2c0-1.6,0-3.2,0-4.8c0-0.4,0-0.8-0.2-1.2c-0.2-0.7-0.8-1-1.6-1 c-0.8,0.1-1.3,0.5-1.6,1.2c-0.1,0.2-0.1,0.5-0.1,0.8c0,1.7,0,3.4,0,5.1c0,0.2,0,0.2-0.2,0.2c-1,0-1.9,0-2.9,0 C-296.1,401.6-296.2,401.6-296.2,401.6z"></path> <path id="XMLID_400_" fill="#FFFFFF" d="M-298,401.6L-298,401.6c-1.1,0-2.1,0-3,0c-0.1,0-0.1,0-0.1-0.1c0-3.1,0-6.1,0-9.2 c0-0.1,0-0.1,0.1-0.1c1,0,2,0,2.9,0h0.1C-298,395.3-298,398.5-298,401.6z"></path> <path id="XMLID_401_" fill="#FFFFFF" d="M-299.6,390.9c-0.7-0.1-1.2-0.3-1.6-0.8c-0.5-0.8-0.2-2.1,1-2.4c0.6-0.2,1.2-0.1,1.8,0.2 c0.5,0.4,0.7,0.9,0.6,1.5c-0.1,0.7-0.5,1.1-1.1,1.3C-299.1,390.8-299.4,390.8-299.6,390.9L-299.6,390.9z"></path> </g> </svg> </span>
						<span class="simplesocialtxt">Share</span> </button>
</div>
<p>Hyperparameter optimization is a big part of deep learning.</p>
<p>The reason is that neural networks are notoriously difficult to 
configure and there are a lot of parameters&nbsp;that need to be set. On
 top of that, individual models can be very slow to train.</p>
<p>In this post you will discover how you can use the grid search 
capability from the scikit-learn python machine learning library to tune
 the hyperparameters of Keras deep learning models.</p>
<p>After reading this post you will know:</p>
<ul>
<li>How to wrap Keras models for use in scikit-learn and how to use grid search.</li>
<li>How to grid search common neural network parameters such as learning rate, dropout rate, epochs and number of neurons.</li>
<li>How to define your own hyperparameter tuning experiments on your own projects.</li>
</ul>
<p>Let’s get started.</p>
<ul>
<li><strong>Update Nov/2016</strong>: Fixed minor issue in displaying grid search results in code examples.</li>
<li><strong>Update Oct/2016</strong>: Updated examples for Keras 1.1.0, TensorFlow 0.10.0 and scikit-learn v0.18.</li>
<li><strong>Update Mar/2017</strong>: Updated example for Keras 2.0.2, TensorFlow 1.0.1 and Theano 0.9.0.</li>
<li><strong>Update Sept/2017</strong>: Updated example to use Keras 2 “epochs” instead of Keras 1 “nb_epochs”.</li>
<li><strong>Update March/2018</strong>: Added alternate link to download the dataset as the original appears to have been taken down.</li>
</ul>
<div id="attachment_2968" style="width: 650px" class="wp-caption aligncenter"><img aria-describedby="caption-attachment-2968" class="size-full wp-image-2968" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/How-to-Grid-Search-Hyperparameters-for-Deep-Learning-Models.jfif" alt="How to Grid Search Hyperparameters for Deep Learning Models in Python With Keras" srcset="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/08/How-to-Grid-Search-Hyperparameters-for-Deep-Learning-Models-in-Python-With-Keras.jpg 640w, https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2016/08/How-to-Grid-Search-Hyperparameters-for-Deep-Learning-Models-in-Python-With-Keras-300x168.jpg 300w" sizes="(max-width: 640px) 100vw, 640px" width="640" height="359"><p id="caption-attachment-2968" class="wp-caption-text">How to Grid Search Hyperparameters for Deep Learning Models in Python With Keras<br>Photo by <a href="https://www.flickr.com/photos/107439982@N02/10635372184/">3V Photo</a>, some rights reserved.</p></div>
<h2>Overview</h2>
<p>In this post, I want to show you both how you can use the 
scikit-learn grid search capability and give you a suite of examples 
that you can copy-and-paste into your own project as a starting point.</p>
<p>Below is a list of the topics we are going to cover:</p>
<ol>
<li>How to use&nbsp;Keras models in scikit-learn.</li>
<li>How to use grid search in scikit-learn.</li>
<li>How to tune batch size and&nbsp;training epochs.</li>
<li>How to tune optimization algorithms.</li>
<li>How to tune learning&nbsp;rate and momentum.</li>
<li>How to tune network weight&nbsp;initialization.</li>
<li>How to tune&nbsp;activation functions.</li>
<li>How to tune dropout regularization.</li>
<li>How to tune the number of neurons in the hidden layer.</li>
</ol>
<h2>How to Use&nbsp;Keras Models in scikit-learn</h2>
<p>Keras models can be used in scikit-learn by wrapping them with the <strong>KerasClassifier</strong> or <strong>KerasRegressor</strong> class.</p>
<p>To use these wrappers you must define a function that creates and 
returns your Keras sequential model, then pass this function to the <strong>build_fn</strong> argument when constructing the <strong>KerasClassifier</strong> class.</p>
<p>For example:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5cf4a8ee36bc3089864253" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="readonly" style="-moz-tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;" wrap="soft">def create_model():
	...
	return model

model = KerasClassifier(build_fn=create_model)</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5cf4a8ee36bc3089864253-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36bc3089864253-2">2</div><div class="crayon-num" data-line="crayon-5cf4a8ee36bc3089864253-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36bc3089864253-4">4</div><div class="crayon-num" data-line="crayon-5cf4a8ee36bc3089864253-5">5</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5cf4a8ee36bc3089864253-1"><span class="crayon-e">def </span><span class="crayon-e">create_model</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36bc3089864253-2"><span class="crayon-h">	</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span></div><div class="crayon-line" id="crayon-5cf4a8ee36bc3089864253-3"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36bc3089864253-4">&nbsp;</div><div class="crayon-line" id="crayon-5cf4a8ee36bc3089864253-5"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">KerasClassifier</span><span class="crayon-sy">(</span><span class="crayon-v">build_fn</span><span class="crayon-o">=</span><span class="crayon-v">create_model</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0004 seconds] -->
<p>The constructor for the <strong>KerasClassifier</strong> class can take default arguments that are passed on to the calls to <strong>model.fit()</strong>, such as the number of epochs and the <a href="https://machinelearningmastery.com/difference-between-a-batch-and-an-epoch/">batch size</a>.</p>
<p>For example:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5cf4a8ee36bcc406328225" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="readonly" style="-moz-tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;" wrap="soft">def create_model():
	...
	return model

model = KerasClassifier(build_fn=create_model, epochs=10)</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5cf4a8ee36bcc406328225-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36bcc406328225-2">2</div><div class="crayon-num" data-line="crayon-5cf4a8ee36bcc406328225-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36bcc406328225-4">4</div><div class="crayon-num" data-line="crayon-5cf4a8ee36bcc406328225-5">5</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5cf4a8ee36bcc406328225-1"><span class="crayon-e">def </span><span class="crayon-e">create_model</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36bcc406328225-2"><span class="crayon-h">	</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span></div><div class="crayon-line" id="crayon-5cf4a8ee36bcc406328225-3"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36bcc406328225-4">&nbsp;</div><div class="crayon-line" id="crayon-5cf4a8ee36bcc406328225-5"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">KerasClassifier</span><span class="crayon-sy">(</span><span class="crayon-v">build_fn</span><span class="crayon-o">=</span><span class="crayon-v">create_model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">epochs</span><span class="crayon-o">=</span><span class="crayon-cn">10</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0004 seconds] -->
<p>The constructor for the <strong>KerasClassifier</strong> class can also take new arguments that can be passed to your custom <strong>create_model()</strong> function. These new arguments must also be defined in the signature of your <strong>create_model()</strong> function with default parameters.</p>
<p>For example:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5cf4a8ee36bcf566013213" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="readonly" style="-moz-tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;" wrap="soft">def create_model(dropout_rate=0.0):
	...
	return model

model = KerasClassifier(build_fn=create_model, dropout_rate=0.2)</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5cf4a8ee36bcf566013213-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36bcf566013213-2">2</div><div class="crayon-num" data-line="crayon-5cf4a8ee36bcf566013213-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36bcf566013213-4">4</div><div class="crayon-num" data-line="crayon-5cf4a8ee36bcf566013213-5">5</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5cf4a8ee36bcf566013213-1"><span class="crayon-e">def </span><span class="crayon-e">create_model</span><span class="crayon-sy">(</span><span class="crayon-v">dropout_rate</span><span class="crayon-o">=</span><span class="crayon-cn">0.0</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36bcf566013213-2"><span class="crayon-h">	</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span></div><div class="crayon-line" id="crayon-5cf4a8ee36bcf566013213-3"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36bcf566013213-4">&nbsp;</div><div class="crayon-line" id="crayon-5cf4a8ee36bcf566013213-5"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">KerasClassifier</span><span class="crayon-sy">(</span><span class="crayon-v">build_fn</span><span class="crayon-o">=</span><span class="crayon-v">create_model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dropout_rate</span><span class="crayon-o">=</span><span class="crayon-cn">0.2</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0004 seconds] -->
<p>You can learn more about the <a href="http://keras.io/scikit-learn-api/">scikit-learn wrapper in Keras API documentation</a>.</p>
<h2>How to Use&nbsp;Grid Search in scikit-learn</h2>
<p>Grid search is a model hyperparameter optimization technique.</p>
<p>In scikit-learn this technique is provided in the <strong>GridSearchCV</strong> class.</p>
<p>When constructing this class you must provide a dictionary of hyperparameters to evaluate in&nbsp;the <strong>param_grid</strong> argument. This is a map of the model parameter name and an array of values to try.</p>
<p>By default, accuracy is the score that is optimized, but other scores can be specified in the <strong>score</strong> argument of the <strong>GridSearchCV</strong> constructor.</p>
<p>By default, the grid search will only use one thread. By setting the <strong>n_jobs</strong> argument in the <strong>GridSearchCV</strong>
 constructor to -1, the process will use all cores on your machine. 
Depending on your Keras backend, this may interfere&nbsp;with the main 
neural network training process.</p>
<p>The <strong>GridSearchCV</strong> process will then construct and 
evaluate one model for each combination of parameters. Cross validation 
is used to evaluate each individual model and the default of 3-fold 
cross validation is used, although this can be overridden by specifying 
the <strong>cv</strong> argument to the <strong>GridSearchCV</strong> constructor.</p>
<p>Below is an example of defining a simple grid search:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5cf4a8ee36bd2714684140" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="readonly" style="-moz-tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;" wrap="soft">param_grid = dict(epochs=[10,20,30])
grid = GridSearchCV(estimator=model, param_grid=param_grid, n_jobs=-1)
grid_result = grid.fit(X, Y)</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5cf4a8ee36bd2714684140-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36bd2714684140-2">2</div><div class="crayon-num" data-line="crayon-5cf4a8ee36bd2714684140-3">3</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5cf4a8ee36bd2714684140-1"><span class="crayon-v">param_grid</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">dict</span><span class="crayon-sy">(</span><span class="crayon-v">epochs</span><span class="crayon-o">=</span><span class="crayon-sy">[</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-cn">20</span><span class="crayon-sy">,</span><span class="crayon-cn">30</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36bd2714684140-2"><span class="crayon-v">grid</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">GridSearchCV</span><span class="crayon-sy">(</span><span class="crayon-v">estimator</span><span class="crayon-o">=</span><span class="crayon-v">model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">param_grid</span><span class="crayon-o">=</span><span class="crayon-v">param_grid</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_jobs</span><span class="crayon-o">=</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5cf4a8ee36bd2714684140-3"><span class="crayon-v">grid_result</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">grid</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">Y</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0006 seconds] -->
<p>Once completed, you can access the outcome of the grid search in the result object returned from <strong>grid.fit()</strong>. The <strong>best_score_</strong> member provides access to the best score observed during the optimization procedure and the <strong>best_params_</strong> describes the combination of parameters that achieved the best results.</p>
<p>You can learn more about the <a href="http://scikit-learn.org/stable/modules/generated/sklearn.grid_search.GridSearchCV.html#sklearn.grid_search.GridSearchCV">GridSearchCV class in the scikit-learn API documentation</a>.</p>
<h2>Problem Description</h2>
<p>Now that we know how to use Keras models with scikit-learn and how to
 use grid search in scikit-learn, let’s look at a bunch of examples.</p>
<p>All examples will be demonstrated on a small standard machine learning dataset called the <a href="http://archive.ics.uci.edu/ml/datasets/Pima+Indians+Diabetes">Pima Indians onset of diabetes classification dataset</a>. This is a small dataset with all numerical attributes that is easy to work with.</p>
<ol>
<li><a href="http://archive.ics.uci.edu/ml/machine-learning-databases/pima-indians-diabetes/pima-indians-diabetes.data">Download the dataset</a> and place it in your currently working directly with the name <strong>pima-indians-diabetes.csv&nbsp;</strong>(update: <a href="https://raw.githubusercontent.com/jbrownlee/Datasets/master/pima-indians-diabetes.data.csv">download from here</a>).</li>
</ol>
<p>As we proceed through the examples in this post, we will aggregate 
the best parameters. This is not the best way to grid search because 
parameters can interact, but it is good for demonstration purposes.</p>
<h3>Note on Parallelizing&nbsp;Grid Search</h3>
<p>All examples are configured to use parallelism (<strong>n_jobs=-1</strong>).</p>
<p>If you get an error like the one below:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5cf4a8ee36bd5211881741" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; z-index: 4;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="readonly" style="-moz-tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;" wrap="soft">INFO (theano.gof.compilelock): Waiting for existing lock by process '55614' (I am process '55613')
INFO (theano.gof.compilelock): To manually release the lock, delete ...</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5cf4a8ee36bd5211881741-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36bd5211881741-2">2</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5cf4a8ee36bd5211881741-1">INFO (theano.gof.compilelock): Waiting for existing lock by process '55614' (I am process '55613')</div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36bd5211881741-2">INFO (theano.gof.compilelock): To manually release the lock, delete ...</div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
<p>Kill the process and change the code to not perform the grid search in parallel, set <strong>n_jobs=1</strong>.</p>
<p></p><div class="woo-sc-hr"></div><p></p>
<center>
<h3>Need help with Deep Learning in Python?</h3>
<p>Take my free 2-week email course and discover MLPs, CNNs and LSTMs (with code).</p>
<p>Click to sign-up now and also get a free PDF Ebook version of the course.</p>
<p><a style="color: #ffffff; text-decoration: none; font-family: Helvetica, Arial, sans-serif; font-weight: bold; font-size: 16px; line-height: 20px; padding: 10px; display: inline-block; max-width: 300px; border-radius: 5px; text-shadow: rgba(0, 0, 0, 0.247059) 0px -1px 1px; box-shadow: rgba(255, 255, 255, 0.498039) 0px 1px 3px inset, rgba(0, 0, 0, 0.498039) 0px 1px 3px; background: #ffce0a;" href="https://machinelearningmastery.leadpages.co/leadbox/142d6e873f72a2%3A164f8be4f346dc/5657382461898752/" target="_blank" rel="noopener" data-leadbox="https://machinelearningmastery.leadpages.co/leadbox/142d6e873f72a2%3A164f8be4f346dc/5657382461898752/" data-leadbox-id="142d6e873f72a2:164f8be4f346dc">Start Your FREE Mini-Course Now!</a> <script src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/leadbox-1463166699.js" type="text/javascript" data-leadbox="142d6e873f72a2:164f8be4f346dc" data-url="https://machinelearningmastery.leadpages.co/leadbox/142d6e873f72a2%3A164f8be4f346dc/5657382461898752/" data-config="%7B%7D"></script></p>
</center>
<p></p><div class="woo-sc-hr"></div><p></p>
<h2>How to Tune Batch Size and Number of Epochs</h2>
<p>In this first simple example, we look at tuning the batch size and number of epochs used when fitting the network.</p>
<p>The batch size in&nbsp;<a href="https://en.wikipedia.org/wiki/Stochastic_gradient_descent#Iterative_method">iterative gradient descent</a>
 is the number of patterns shown to the network before the weights are 
updated. It is also an optimization in the training of the network, 
defining how many patterns to read at a time and keep in memory.</p>
<p>The number of epochs is the number of times that the entire training 
dataset is shown to the network during training.&nbsp;Some networks are 
sensitive to the batch size, such as LSTM recurrent neural networks and 
Convolutional Neural Networks.</p>
<p>Here we will evaluate a suite of different mini batch sizes from 10 to 100 in steps of 20.</p>
<p>The full code listing is provided below.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5cf4a8ee36bd8229683294" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="readonly" style="-moz-tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;" wrap="soft"># Use scikit-learn to grid search the batch size and epochs
import numpy
from sklearn.model_selection import GridSearchCV
from keras.models import Sequential
from keras.layers import Dense
from keras.wrappers.scikit_learn import KerasClassifier
# Function to create model, required for KerasClassifier
def create_model():
	# create model
	model = Sequential()
	model.add(Dense(12, input_dim=8, activation='relu'))
	model.add(Dense(1, activation='sigmoid'))
	# Compile model
	model.compile(loss='binary_crossentropy', optimizer='adam', metrics=['accuracy'])
	return model
# fix random seed for reproducibility
seed = 7
numpy.random.seed(seed)
# load dataset
dataset = numpy.loadtxt("pima-indians-diabetes.csv", delimiter=",")
# split into input (X) and output (Y) variables
X = dataset[:,0:8]
Y = dataset[:,8]
# create model
model = KerasClassifier(build_fn=create_model, verbose=0)
# define the grid search parameters
batch_size = [10, 20, 40, 60, 80, 100]
epochs = [10, 50, 100]
param_grid = dict(batch_size=batch_size, epochs=epochs)
grid = GridSearchCV(estimator=model, param_grid=param_grid, n_jobs=-1)
grid_result = grid.fit(X, Y)
# summarize results
print("Best: %f using %s" % (grid_result.best_score_, grid_result.best_params_))
means = grid_result.cv_results_['mean_test_score']
stds = grid_result.cv_results_['std_test_score']
params = grid_result.cv_results_['params']
for mean, stdev, param in zip(means, stds, params):
    print("%f (%f) with: %r" % (mean, stdev, param))</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5cf4a8ee36bd8229683294-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36bd8229683294-2">2</div><div class="crayon-num" data-line="crayon-5cf4a8ee36bd8229683294-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36bd8229683294-4">4</div><div class="crayon-num" data-line="crayon-5cf4a8ee36bd8229683294-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36bd8229683294-6">6</div><div class="crayon-num" data-line="crayon-5cf4a8ee36bd8229683294-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36bd8229683294-8">8</div><div class="crayon-num" data-line="crayon-5cf4a8ee36bd8229683294-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36bd8229683294-10">10</div><div class="crayon-num" data-line="crayon-5cf4a8ee36bd8229683294-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36bd8229683294-12">12</div><div class="crayon-num" data-line="crayon-5cf4a8ee36bd8229683294-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36bd8229683294-14">14</div><div class="crayon-num" data-line="crayon-5cf4a8ee36bd8229683294-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36bd8229683294-16">16</div><div class="crayon-num" data-line="crayon-5cf4a8ee36bd8229683294-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36bd8229683294-18">18</div><div class="crayon-num" data-line="crayon-5cf4a8ee36bd8229683294-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36bd8229683294-20">20</div><div class="crayon-num" data-line="crayon-5cf4a8ee36bd8229683294-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36bd8229683294-22">22</div><div class="crayon-num" data-line="crayon-5cf4a8ee36bd8229683294-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36bd8229683294-24">24</div><div class="crayon-num" data-line="crayon-5cf4a8ee36bd8229683294-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36bd8229683294-26">26</div><div class="crayon-num" data-line="crayon-5cf4a8ee36bd8229683294-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36bd8229683294-28">28</div><div class="crayon-num" data-line="crayon-5cf4a8ee36bd8229683294-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36bd8229683294-30">30</div><div class="crayon-num" data-line="crayon-5cf4a8ee36bd8229683294-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36bd8229683294-32">32</div><div class="crayon-num" data-line="crayon-5cf4a8ee36bd8229683294-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36bd8229683294-34">34</div><div class="crayon-num" data-line="crayon-5cf4a8ee36bd8229683294-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36bd8229683294-36">36</div><div class="crayon-num" data-line="crayon-5cf4a8ee36bd8229683294-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36bd8229683294-38">38</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5cf4a8ee36bd8229683294-1"><span class="crayon-p"># Use scikit-learn to grid search the batch size and epochs</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36bd8229683294-2"><span class="crayon-e">import </span><span class="crayon-e">numpy</span></div><div class="crayon-line" id="crayon-5cf4a8ee36bd8229683294-3"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">model_selection </span><span class="crayon-e">import </span><span class="crayon-e">GridSearchCV</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36bd8229683294-4"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">models </span><span class="crayon-e">import </span><span class="crayon-e">Sequential</span></div><div class="crayon-line" id="crayon-5cf4a8ee36bd8229683294-5"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Dense</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36bd8229683294-6"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-v">wrappers</span><span class="crayon-sy">.</span><span class="crayon-e">scikit_learn </span><span class="crayon-e">import </span><span class="crayon-v">KerasClassifier</span></div><div class="crayon-line" id="crayon-5cf4a8ee36bd8229683294-7"><span class="crayon-p"># Function to create model, required for KerasClassifier</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36bd8229683294-8"><span class="crayon-e">def </span><span class="crayon-e">create_model</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5cf4a8ee36bd8229683294-9"><span class="crayon-h">	</span><span class="crayon-p"># create model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36bd8229683294-10"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Sequential</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5cf4a8ee36bd8229683294-11"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">12</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">input_dim</span><span class="crayon-o">=</span><span class="crayon-cn">8</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36bd8229683294-12"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'sigmoid'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5cf4a8ee36bd8229683294-13"><span class="crayon-h">	</span><span class="crayon-p"># Compile model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36bd8229683294-14"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">compile</span><span class="crayon-sy">(</span><span class="crayon-v">loss</span><span class="crayon-o">=</span><span class="crayon-s">'binary_crossentropy'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">optimizer</span><span class="crayon-o">=</span><span class="crayon-s">'adam'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">metrics</span><span class="crayon-o">=</span><span class="crayon-sy">[</span><span class="crayon-s">'accuracy'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5cf4a8ee36bd8229683294-15"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36bd8229683294-16"><span class="crayon-p"># fix random seed for reproducibility</span></div><div class="crayon-line" id="crayon-5cf4a8ee36bd8229683294-17"><span class="crayon-v">seed</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">7</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36bd8229683294-18"><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-v">random</span><span class="crayon-sy">.</span><span class="crayon-e">seed</span><span class="crayon-sy">(</span><span class="crayon-v">seed</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5cf4a8ee36bd8229683294-19"><span class="crayon-p"># load dataset</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36bd8229683294-20"><span class="crayon-v">dataset</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-e">loadtxt</span><span class="crayon-sy">(</span><span class="crayon-s">"pima-indians-diabetes.csv"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">delimiter</span><span class="crayon-o">=</span><span class="crayon-s">","</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5cf4a8ee36bd8229683294-21"><span class="crayon-p"># split into input (X) and output (Y) variables</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36bd8229683294-22"><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-o">:</span><span class="crayon-cn">8</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5cf4a8ee36bd8229683294-23"><span class="crayon-v">Y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-cn">8</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36bd8229683294-24"><span class="crayon-p"># create model</span></div><div class="crayon-line" id="crayon-5cf4a8ee36bd8229683294-25"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">KerasClassifier</span><span class="crayon-sy">(</span><span class="crayon-v">build_fn</span><span class="crayon-o">=</span><span class="crayon-v">create_model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36bd8229683294-26"><span class="crayon-p"># define the grid search parameters</span></div><div class="crayon-line" id="crayon-5cf4a8ee36bd8229683294-27"><span class="crayon-v">batch_size</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">20</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">40</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">60</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">80</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">100</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36bd8229683294-28"><span class="crayon-v">epochs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">50</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">100</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5cf4a8ee36bd8229683294-29"><span class="crayon-v">param_grid</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">dict</span><span class="crayon-sy">(</span><span class="crayon-v">batch_size</span><span class="crayon-o">=</span><span class="crayon-v">batch_size</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">epochs</span><span class="crayon-o">=</span><span class="crayon-v">epochs</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36bd8229683294-30"><span class="crayon-v">grid</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">GridSearchCV</span><span class="crayon-sy">(</span><span class="crayon-v">estimator</span><span class="crayon-o">=</span><span class="crayon-v">model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">param_grid</span><span class="crayon-o">=</span><span class="crayon-v">param_grid</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_jobs</span><span class="crayon-o">=</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5cf4a8ee36bd8229683294-31"><span class="crayon-v">grid_result</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">grid</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">Y</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36bd8229683294-32"><span class="crayon-p"># summarize results</span></div><div class="crayon-line" id="crayon-5cf4a8ee36bd8229683294-33"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">"Best: %f using %s"</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">grid_result</span><span class="crayon-sy">.</span><span class="crayon-v">best_score_</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">grid_result</span><span class="crayon-sy">.</span><span class="crayon-v">best_params_</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36bd8229683294-34"><span class="crayon-v">means</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">grid_result</span><span class="crayon-sy">.</span><span class="crayon-v">cv_results_</span><span class="crayon-sy">[</span><span class="crayon-s">'mean_test_score'</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5cf4a8ee36bd8229683294-35"><span class="crayon-v">stds</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">grid_result</span><span class="crayon-sy">.</span><span class="crayon-v">cv_results_</span><span class="crayon-sy">[</span><span class="crayon-s">'std_test_score'</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36bd8229683294-36"><span class="crayon-v">params</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">grid_result</span><span class="crayon-sy">.</span><span class="crayon-v">cv_results_</span><span class="crayon-sy">[</span><span class="crayon-s">'params'</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5cf4a8ee36bd8229683294-37"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-v">mean</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">stdev</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">param </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">zip</span><span class="crayon-sy">(</span><span class="crayon-v">means</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">stds</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">params</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36bd8229683294-38"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">"%f (%f) with: %r"</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">mean</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">stdev</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">param</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0035 seconds] -->
<p>Running this example produces the following output.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5cf4a8ee36bdb500244692" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="readonly" style="-moz-tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;" wrap="soft">Best: 0.686198 using {'epochs': 100, 'batch_size': 20}
0.348958 (0.024774) with: {'epochs': 10, 'batch_size': 10}
0.348958 (0.024774) with: {'epochs': 50, 'batch_size': 10}
0.466146 (0.149269) with: {'epochs': 100, 'batch_size': 10}
0.647135 (0.021236) with: {'epochs': 10, 'batch_size': 20}
0.660156 (0.014616) with: {'epochs': 50, 'batch_size': 20}
0.686198 (0.024774) with: {'epochs': 100, 'batch_size': 20}
0.489583 (0.075566) with: {'epochs': 10, 'batch_size': 40}
0.652344 (0.019918) with: {'epochs': 50, 'batch_size': 40}
0.654948 (0.027866) with: {'epochs': 100, 'batch_size': 40}
0.518229 (0.032264) with: {'epochs': 10, 'batch_size': 60}
0.605469 (0.052213) with: {'epochs': 50, 'batch_size': 60}
0.665365 (0.004872) with: {'epochs': 100, 'batch_size': 60}
0.537760 (0.143537) with: {'epochs': 10, 'batch_size': 80}
0.591146 (0.094954) with: {'epochs': 50, 'batch_size': 80}
0.658854 (0.054904) with: {'epochs': 100, 'batch_size': 80}
0.402344 (0.107735) with: {'epochs': 10, 'batch_size': 100}
0.652344 (0.033299) with: {'epochs': 50, 'batch_size': 100}
0.542969 (0.157934) with: {'epochs': 100, 'batch_size': 100}</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5cf4a8ee36bdb500244692-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36bdb500244692-2">2</div><div class="crayon-num" data-line="crayon-5cf4a8ee36bdb500244692-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36bdb500244692-4">4</div><div class="crayon-num" data-line="crayon-5cf4a8ee36bdb500244692-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36bdb500244692-6">6</div><div class="crayon-num" data-line="crayon-5cf4a8ee36bdb500244692-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36bdb500244692-8">8</div><div class="crayon-num" data-line="crayon-5cf4a8ee36bdb500244692-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36bdb500244692-10">10</div><div class="crayon-num" data-line="crayon-5cf4a8ee36bdb500244692-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36bdb500244692-12">12</div><div class="crayon-num" data-line="crayon-5cf4a8ee36bdb500244692-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36bdb500244692-14">14</div><div class="crayon-num" data-line="crayon-5cf4a8ee36bdb500244692-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36bdb500244692-16">16</div><div class="crayon-num" data-line="crayon-5cf4a8ee36bdb500244692-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36bdb500244692-18">18</div><div class="crayon-num" data-line="crayon-5cf4a8ee36bdb500244692-19">19</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5cf4a8ee36bdb500244692-1">Best: 0.686198 using {'epochs': 100, 'batch_size': 20}</div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36bdb500244692-2">0.348958 (0.024774) with: {'epochs': 10, 'batch_size': 10}</div><div class="crayon-line" id="crayon-5cf4a8ee36bdb500244692-3">0.348958 (0.024774) with: {'epochs': 50, 'batch_size': 10}</div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36bdb500244692-4">0.466146 (0.149269) with: {'epochs': 100, 'batch_size': 10}</div><div class="crayon-line" id="crayon-5cf4a8ee36bdb500244692-5">0.647135 (0.021236) with: {'epochs': 10, 'batch_size': 20}</div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36bdb500244692-6">0.660156 (0.014616) with: {'epochs': 50, 'batch_size': 20}</div><div class="crayon-line" id="crayon-5cf4a8ee36bdb500244692-7">0.686198 (0.024774) with: {'epochs': 100, 'batch_size': 20}</div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36bdb500244692-8">0.489583 (0.075566) with: {'epochs': 10, 'batch_size': 40}</div><div class="crayon-line" id="crayon-5cf4a8ee36bdb500244692-9">0.652344 (0.019918) with: {'epochs': 50, 'batch_size': 40}</div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36bdb500244692-10">0.654948 (0.027866) with: {'epochs': 100, 'batch_size': 40}</div><div class="crayon-line" id="crayon-5cf4a8ee36bdb500244692-11">0.518229 (0.032264) with: {'epochs': 10, 'batch_size': 60}</div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36bdb500244692-12">0.605469 (0.052213) with: {'epochs': 50, 'batch_size': 60}</div><div class="crayon-line" id="crayon-5cf4a8ee36bdb500244692-13">0.665365 (0.004872) with: {'epochs': 100, 'batch_size': 60}</div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36bdb500244692-14">0.537760 (0.143537) with: {'epochs': 10, 'batch_size': 80}</div><div class="crayon-line" id="crayon-5cf4a8ee36bdb500244692-15">0.591146 (0.094954) with: {'epochs': 50, 'batch_size': 80}</div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36bdb500244692-16">0.658854 (0.054904) with: {'epochs': 100, 'batch_size': 80}</div><div class="crayon-line" id="crayon-5cf4a8ee36bdb500244692-17">0.402344 (0.107735) with: {'epochs': 10, 'batch_size': 100}</div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36bdb500244692-18">0.652344 (0.033299) with: {'epochs': 50, 'batch_size': 100}</div><div class="crayon-line" id="crayon-5cf4a8ee36bdb500244692-19">0.542969 (0.157934) with: {'epochs': 100, 'batch_size': 100}</div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>We can see that the batch size of 20 and 100 epochs achieved the best result of about 68% accuracy.</p>
<h2>How to Tune the Training Optimization Algorithm</h2>
<p>Keras offers a suite of different state-of-the-art optimization algorithms.</p>
<p>In this example, we tune the optimization algorithm used to train the network, each with default parameters.</p>
<p>This is an odd example, because often you will choose one approach a 
priori and instead focus on tuning its parameters on your problem (e.g. 
see the next example).</p>
<p>Here we will evaluate the <a href="http://keras.io/optimizers/">suite of optimization algorithms supported by the Keras API</a>.</p>
<p>The full code listing is provided below.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5cf4a8ee36bde345358034" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important; margin-top: -18px; display: none;"></div>
			<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="readonly" style="-moz-tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;" wrap="soft"># Use scikit-learn to grid search the batch size and epochs
import numpy
from sklearn.model_selection import GridSearchCV
from keras.models import Sequential
from keras.layers import Dense
from keras.wrappers.scikit_learn import KerasClassifier
# Function to create model, required for KerasClassifier
def create_model(optimizer='adam'):
	# create model
	model = Sequential()
	model.add(Dense(12, input_dim=8, activation='relu'))
	model.add(Dense(1, activation='sigmoid'))
	# Compile model
	model.compile(loss='binary_crossentropy', optimizer=optimizer, metrics=['accuracy'])
	return model
# fix random seed for reproducibility
seed = 7
numpy.random.seed(seed)
# load dataset
dataset = numpy.loadtxt("pima-indians-diabetes.csv", delimiter=",")
# split into input (X) and output (Y) variables
X = dataset[:,0:8]
Y = dataset[:,8]
# create model
model = KerasClassifier(build_fn=create_model, epochs=100, batch_size=10, verbose=0)
# define the grid search parameters
optimizer = ['SGD', 'RMSprop', 'Adagrad', 'Adadelta', 'Adam', 'Adamax', 'Nadam']
param_grid = dict(optimizer=optimizer)
grid = GridSearchCV(estimator=model, param_grid=param_grid, n_jobs=-1)
grid_result = grid.fit(X, Y)
# summarize results
print("Best: %f using %s" % (grid_result.best_score_, grid_result.best_params_))
means = grid_result.cv_results_['mean_test_score']
stds = grid_result.cv_results_['std_test_score']
params = grid_result.cv_results_['params']
for mean, stdev, param in zip(means, stds, params):
    print("%f (%f) with: %r" % (mean, stdev, param))</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5cf4a8ee36bde345358034-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36bde345358034-2">2</div><div class="crayon-num" data-line="crayon-5cf4a8ee36bde345358034-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36bde345358034-4">4</div><div class="crayon-num" data-line="crayon-5cf4a8ee36bde345358034-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36bde345358034-6">6</div><div class="crayon-num" data-line="crayon-5cf4a8ee36bde345358034-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36bde345358034-8">8</div><div class="crayon-num" data-line="crayon-5cf4a8ee36bde345358034-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36bde345358034-10">10</div><div class="crayon-num" data-line="crayon-5cf4a8ee36bde345358034-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36bde345358034-12">12</div><div class="crayon-num" data-line="crayon-5cf4a8ee36bde345358034-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36bde345358034-14">14</div><div class="crayon-num" data-line="crayon-5cf4a8ee36bde345358034-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36bde345358034-16">16</div><div class="crayon-num" data-line="crayon-5cf4a8ee36bde345358034-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36bde345358034-18">18</div><div class="crayon-num" data-line="crayon-5cf4a8ee36bde345358034-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36bde345358034-20">20</div><div class="crayon-num" data-line="crayon-5cf4a8ee36bde345358034-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36bde345358034-22">22</div><div class="crayon-num" data-line="crayon-5cf4a8ee36bde345358034-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36bde345358034-24">24</div><div class="crayon-num" data-line="crayon-5cf4a8ee36bde345358034-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36bde345358034-26">26</div><div class="crayon-num" data-line="crayon-5cf4a8ee36bde345358034-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36bde345358034-28">28</div><div class="crayon-num" data-line="crayon-5cf4a8ee36bde345358034-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36bde345358034-30">30</div><div class="crayon-num" data-line="crayon-5cf4a8ee36bde345358034-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36bde345358034-32">32</div><div class="crayon-num" data-line="crayon-5cf4a8ee36bde345358034-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36bde345358034-34">34</div><div class="crayon-num" data-line="crayon-5cf4a8ee36bde345358034-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36bde345358034-36">36</div><div class="crayon-num" data-line="crayon-5cf4a8ee36bde345358034-37">37</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5cf4a8ee36bde345358034-1"><span class="crayon-p"># Use scikit-learn to grid search the batch size and epochs</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36bde345358034-2"><span class="crayon-e">import </span><span class="crayon-e">numpy</span></div><div class="crayon-line" id="crayon-5cf4a8ee36bde345358034-3"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">model_selection </span><span class="crayon-e">import </span><span class="crayon-e">GridSearchCV</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36bde345358034-4"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">models </span><span class="crayon-e">import </span><span class="crayon-e">Sequential</span></div><div class="crayon-line" id="crayon-5cf4a8ee36bde345358034-5"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Dense</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36bde345358034-6"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-v">wrappers</span><span class="crayon-sy">.</span><span class="crayon-e">scikit_learn </span><span class="crayon-e">import </span><span class="crayon-v">KerasClassifier</span></div><div class="crayon-line" id="crayon-5cf4a8ee36bde345358034-7"><span class="crayon-p"># Function to create model, required for KerasClassifier</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36bde345358034-8"><span class="crayon-e">def </span><span class="crayon-e">create_model</span><span class="crayon-sy">(</span><span class="crayon-v">optimizer</span><span class="crayon-o">=</span><span class="crayon-s">'adam'</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5cf4a8ee36bde345358034-9"><span class="crayon-h">	</span><span class="crayon-p"># create model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36bde345358034-10"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Sequential</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5cf4a8ee36bde345358034-11"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">12</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">input_dim</span><span class="crayon-o">=</span><span class="crayon-cn">8</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36bde345358034-12"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'sigmoid'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5cf4a8ee36bde345358034-13"><span class="crayon-h">	</span><span class="crayon-p"># Compile model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36bde345358034-14"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">compile</span><span class="crayon-sy">(</span><span class="crayon-v">loss</span><span class="crayon-o">=</span><span class="crayon-s">'binary_crossentropy'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">optimizer</span><span class="crayon-o">=</span><span class="crayon-v">optimizer</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">metrics</span><span class="crayon-o">=</span><span class="crayon-sy">[</span><span class="crayon-s">'accuracy'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5cf4a8ee36bde345358034-15"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36bde345358034-16"><span class="crayon-p"># fix random seed for reproducibility</span></div><div class="crayon-line" id="crayon-5cf4a8ee36bde345358034-17"><span class="crayon-v">seed</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">7</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36bde345358034-18"><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-v">random</span><span class="crayon-sy">.</span><span class="crayon-e">seed</span><span class="crayon-sy">(</span><span class="crayon-v">seed</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5cf4a8ee36bde345358034-19"><span class="crayon-p"># load dataset</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36bde345358034-20"><span class="crayon-v">dataset</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-e">loadtxt</span><span class="crayon-sy">(</span><span class="crayon-s">"pima-indians-diabetes.csv"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">delimiter</span><span class="crayon-o">=</span><span class="crayon-s">","</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5cf4a8ee36bde345358034-21"><span class="crayon-p"># split into input (X) and output (Y) variables</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36bde345358034-22"><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-o">:</span><span class="crayon-cn">8</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5cf4a8ee36bde345358034-23"><span class="crayon-v">Y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-cn">8</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36bde345358034-24"><span class="crayon-p"># create model</span></div><div class="crayon-line" id="crayon-5cf4a8ee36bde345358034-25"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">KerasClassifier</span><span class="crayon-sy">(</span><span class="crayon-v">build_fn</span><span class="crayon-o">=</span><span class="crayon-v">create_model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">epochs</span><span class="crayon-o">=</span><span class="crayon-cn">100</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">batch_size</span><span class="crayon-o">=</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36bde345358034-26"><span class="crayon-p"># define the grid search parameters</span></div><div class="crayon-line" id="crayon-5cf4a8ee36bde345358034-27"><span class="crayon-v">optimizer</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-s">'SGD'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'RMSprop'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'Adagrad'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'Adadelta'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'Adam'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'Adamax'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'Nadam'</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36bde345358034-28"><span class="crayon-v">param_grid</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">dict</span><span class="crayon-sy">(</span><span class="crayon-v">optimizer</span><span class="crayon-o">=</span><span class="crayon-v">optimizer</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5cf4a8ee36bde345358034-29"><span class="crayon-v">grid</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">GridSearchCV</span><span class="crayon-sy">(</span><span class="crayon-v">estimator</span><span class="crayon-o">=</span><span class="crayon-v">model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">param_grid</span><span class="crayon-o">=</span><span class="crayon-v">param_grid</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_jobs</span><span class="crayon-o">=</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36bde345358034-30"><span class="crayon-v">grid_result</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">grid</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">Y</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5cf4a8ee36bde345358034-31"><span class="crayon-p"># summarize results</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36bde345358034-32"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">"Best: %f using %s"</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">grid_result</span><span class="crayon-sy">.</span><span class="crayon-v">best_score_</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">grid_result</span><span class="crayon-sy">.</span><span class="crayon-v">best_params_</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5cf4a8ee36bde345358034-33"><span class="crayon-v">means</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">grid_result</span><span class="crayon-sy">.</span><span class="crayon-v">cv_results_</span><span class="crayon-sy">[</span><span class="crayon-s">'mean_test_score'</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36bde345358034-34"><span class="crayon-v">stds</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">grid_result</span><span class="crayon-sy">.</span><span class="crayon-v">cv_results_</span><span class="crayon-sy">[</span><span class="crayon-s">'std_test_score'</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5cf4a8ee36bde345358034-35"><span class="crayon-v">params</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">grid_result</span><span class="crayon-sy">.</span><span class="crayon-v">cv_results_</span><span class="crayon-sy">[</span><span class="crayon-s">'params'</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36bde345358034-36"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-v">mean</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">stdev</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">param </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">zip</span><span class="crayon-sy">(</span><span class="crayon-v">means</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">stds</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">params</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5cf4a8ee36bde345358034-37"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">"%f (%f) with: %r"</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">mean</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">stdev</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">param</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0035 seconds] -->
<p>Running this example produces the following output.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5cf4a8ee36be1956743007" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="readonly" style="-moz-tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;" wrap="soft">Best: 0.704427 using {'optimizer': 'Adam'}
0.348958 (0.024774) with: {'optimizer': 'SGD'}
0.348958 (0.024774) with: {'optimizer': 'RMSprop'}
0.471354 (0.156586) with: {'optimizer': 'Adagrad'}
0.669271 (0.029635) with: {'optimizer': 'Adadelta'}
0.704427 (0.031466) with: {'optimizer': 'Adam'}
0.682292 (0.016367) with: {'optimizer': 'Adamax'}
0.703125 (0.003189) with: {'optimizer': 'Nadam'}</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5cf4a8ee36be1956743007-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36be1956743007-2">2</div><div class="crayon-num" data-line="crayon-5cf4a8ee36be1956743007-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36be1956743007-4">4</div><div class="crayon-num" data-line="crayon-5cf4a8ee36be1956743007-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36be1956743007-6">6</div><div class="crayon-num" data-line="crayon-5cf4a8ee36be1956743007-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36be1956743007-8">8</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5cf4a8ee36be1956743007-1">Best: 0.704427 using {'optimizer': 'Adam'}</div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36be1956743007-2">0.348958 (0.024774) with: {'optimizer': 'SGD'}</div><div class="crayon-line" id="crayon-5cf4a8ee36be1956743007-3">0.348958 (0.024774) with: {'optimizer': 'RMSprop'}</div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36be1956743007-4">0.471354 (0.156586) with: {'optimizer': 'Adagrad'}</div><div class="crayon-line" id="crayon-5cf4a8ee36be1956743007-5">0.669271 (0.029635) with: {'optimizer': 'Adadelta'}</div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36be1956743007-6">0.704427 (0.031466) with: {'optimizer': 'Adam'}</div><div class="crayon-line" id="crayon-5cf4a8ee36be1956743007-7">0.682292 (0.016367) with: {'optimizer': 'Adamax'}</div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36be1956743007-8">0.703125 (0.003189) with: {'optimizer': 'Nadam'}</div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>The results suggest that the ADAM optimization algorithm is the best with a score of about 70% accuracy.</p>
<h2>How to Tune Learning Rate and Momentum</h2>
<p>It is common to pre-select an optimization algorithm to train your network and tune its parameters.</p>
<p>By far the most common optimization algorithm is plain old&nbsp;<a href="http://keras.io/optimizers/#sgd">Stochastic Gradient Descent</a>
 (SGD) because it is so well understood. In this example, we will look 
at optimizing the SGD learning rate and momentum parameters.</p>
<p>Learning rate controls how much to update the weight at the end of 
each batch and the momentum controls how much to let the previous update
 influence the current weight update.</p>
<p>We will try a suite of small standard learning rates and a momentum 
values from 0.2 to 0.8 in steps of 0.2, as well as 0.9 (because it can 
be a popular value in practice).</p>
<p>Generally, it is a good idea to also include the number of epochs in 
an optimization like this as there is a dependency between the amount of
 learning per batch (learning rate), the number of updates per epoch 
(batch size) and the number of epochs.</p>
<p>The full code listing is provided below.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5cf4a8ee36be4936857948" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important; margin-top: -18px; display: none;"></div>
			<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="readonly" style="-moz-tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;" wrap="soft"># Use scikit-learn to grid search the learning rate and momentum
import numpy
from sklearn.model_selection import GridSearchCV
from keras.models import Sequential
from keras.layers import Dense
from keras.wrappers.scikit_learn import KerasClassifier
from keras.optimizers import SGD
# Function to create model, required for KerasClassifier
def create_model(learn_rate=0.01, momentum=0):
	# create model
	model = Sequential()
	model.add(Dense(12, input_dim=8, activation='relu'))
	model.add(Dense(1, activation='sigmoid'))
	# Compile model
	optimizer = SGD(lr=learn_rate, momentum=momentum)
	model.compile(loss='binary_crossentropy', optimizer=optimizer, metrics=['accuracy'])
	return model
# fix random seed for reproducibility
seed = 7
numpy.random.seed(seed)
# load dataset
dataset = numpy.loadtxt("pima-indians-diabetes.csv", delimiter=",")
# split into input (X) and output (Y) variables
X = dataset[:,0:8]
Y = dataset[:,8]
# create model
model = KerasClassifier(build_fn=create_model, epochs=100, batch_size=10, verbose=0)
# define the grid search parameters
learn_rate = [0.001, 0.01, 0.1, 0.2, 0.3]
momentum = [0.0, 0.2, 0.4, 0.6, 0.8, 0.9]
param_grid = dict(learn_rate=learn_rate, momentum=momentum)
grid = GridSearchCV(estimator=model, param_grid=param_grid, n_jobs=-1)
grid_result = grid.fit(X, Y)
# summarize results
print("Best: %f using %s" % (grid_result.best_score_, grid_result.best_params_))
means = grid_result.cv_results_['mean_test_score']
stds = grid_result.cv_results_['std_test_score']
params = grid_result.cv_results_['params']
for mean, stdev, param in zip(means, stds, params):
    print("%f (%f) with: %r" % (mean, stdev, param))</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5cf4a8ee36be4936857948-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36be4936857948-2">2</div><div class="crayon-num" data-line="crayon-5cf4a8ee36be4936857948-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36be4936857948-4">4</div><div class="crayon-num" data-line="crayon-5cf4a8ee36be4936857948-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36be4936857948-6">6</div><div class="crayon-num" data-line="crayon-5cf4a8ee36be4936857948-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36be4936857948-8">8</div><div class="crayon-num" data-line="crayon-5cf4a8ee36be4936857948-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36be4936857948-10">10</div><div class="crayon-num" data-line="crayon-5cf4a8ee36be4936857948-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36be4936857948-12">12</div><div class="crayon-num" data-line="crayon-5cf4a8ee36be4936857948-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36be4936857948-14">14</div><div class="crayon-num" data-line="crayon-5cf4a8ee36be4936857948-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36be4936857948-16">16</div><div class="crayon-num" data-line="crayon-5cf4a8ee36be4936857948-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36be4936857948-18">18</div><div class="crayon-num" data-line="crayon-5cf4a8ee36be4936857948-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36be4936857948-20">20</div><div class="crayon-num" data-line="crayon-5cf4a8ee36be4936857948-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36be4936857948-22">22</div><div class="crayon-num" data-line="crayon-5cf4a8ee36be4936857948-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36be4936857948-24">24</div><div class="crayon-num" data-line="crayon-5cf4a8ee36be4936857948-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36be4936857948-26">26</div><div class="crayon-num" data-line="crayon-5cf4a8ee36be4936857948-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36be4936857948-28">28</div><div class="crayon-num" data-line="crayon-5cf4a8ee36be4936857948-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36be4936857948-30">30</div><div class="crayon-num" data-line="crayon-5cf4a8ee36be4936857948-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36be4936857948-32">32</div><div class="crayon-num" data-line="crayon-5cf4a8ee36be4936857948-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36be4936857948-34">34</div><div class="crayon-num" data-line="crayon-5cf4a8ee36be4936857948-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36be4936857948-36">36</div><div class="crayon-num" data-line="crayon-5cf4a8ee36be4936857948-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36be4936857948-38">38</div><div class="crayon-num" data-line="crayon-5cf4a8ee36be4936857948-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36be4936857948-40">40</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5cf4a8ee36be4936857948-1"><span class="crayon-p"># Use scikit-learn to grid search the learning rate and momentum</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36be4936857948-2"><span class="crayon-e">import </span><span class="crayon-e">numpy</span></div><div class="crayon-line" id="crayon-5cf4a8ee36be4936857948-3"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">model_selection </span><span class="crayon-e">import </span><span class="crayon-e">GridSearchCV</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36be4936857948-4"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">models </span><span class="crayon-e">import </span><span class="crayon-e">Sequential</span></div><div class="crayon-line" id="crayon-5cf4a8ee36be4936857948-5"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Dense</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36be4936857948-6"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-v">wrappers</span><span class="crayon-sy">.</span><span class="crayon-e">scikit_learn </span><span class="crayon-e">import </span><span class="crayon-e">KerasClassifier</span></div><div class="crayon-line" id="crayon-5cf4a8ee36be4936857948-7"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">optimizers </span><span class="crayon-e">import </span><span class="crayon-v">SGD</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36be4936857948-8"><span class="crayon-p"># Function to create model, required for KerasClassifier</span></div><div class="crayon-line" id="crayon-5cf4a8ee36be4936857948-9"><span class="crayon-e">def </span><span class="crayon-e">create_model</span><span class="crayon-sy">(</span><span class="crayon-v">learn_rate</span><span class="crayon-o">=</span><span class="crayon-cn">0.01</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">momentum</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36be4936857948-10"><span class="crayon-h">	</span><span class="crayon-p"># create model</span></div><div class="crayon-line" id="crayon-5cf4a8ee36be4936857948-11"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Sequential</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36be4936857948-12"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">12</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">input_dim</span><span class="crayon-o">=</span><span class="crayon-cn">8</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5cf4a8ee36be4936857948-13"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'sigmoid'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36be4936857948-14"><span class="crayon-h">	</span><span class="crayon-p"># Compile model</span></div><div class="crayon-line" id="crayon-5cf4a8ee36be4936857948-15"><span class="crayon-h">	</span><span class="crayon-v">optimizer</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">SGD</span><span class="crayon-sy">(</span><span class="crayon-v">lr</span><span class="crayon-o">=</span><span class="crayon-v">learn_rate</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">momentum</span><span class="crayon-o">=</span><span class="crayon-v">momentum</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36be4936857948-16"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">compile</span><span class="crayon-sy">(</span><span class="crayon-v">loss</span><span class="crayon-o">=</span><span class="crayon-s">'binary_crossentropy'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">optimizer</span><span class="crayon-o">=</span><span class="crayon-v">optimizer</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">metrics</span><span class="crayon-o">=</span><span class="crayon-sy">[</span><span class="crayon-s">'accuracy'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5cf4a8ee36be4936857948-17"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36be4936857948-18"><span class="crayon-p"># fix random seed for reproducibility</span></div><div class="crayon-line" id="crayon-5cf4a8ee36be4936857948-19"><span class="crayon-v">seed</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">7</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36be4936857948-20"><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-v">random</span><span class="crayon-sy">.</span><span class="crayon-e">seed</span><span class="crayon-sy">(</span><span class="crayon-v">seed</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5cf4a8ee36be4936857948-21"><span class="crayon-p"># load dataset</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36be4936857948-22"><span class="crayon-v">dataset</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-e">loadtxt</span><span class="crayon-sy">(</span><span class="crayon-s">"pima-indians-diabetes.csv"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">delimiter</span><span class="crayon-o">=</span><span class="crayon-s">","</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5cf4a8ee36be4936857948-23"><span class="crayon-p"># split into input (X) and output (Y) variables</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36be4936857948-24"><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-o">:</span><span class="crayon-cn">8</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5cf4a8ee36be4936857948-25"><span class="crayon-v">Y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-cn">8</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36be4936857948-26"><span class="crayon-p"># create model</span></div><div class="crayon-line" id="crayon-5cf4a8ee36be4936857948-27"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">KerasClassifier</span><span class="crayon-sy">(</span><span class="crayon-v">build_fn</span><span class="crayon-o">=</span><span class="crayon-v">create_model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">epochs</span><span class="crayon-o">=</span><span class="crayon-cn">100</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">batch_size</span><span class="crayon-o">=</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36be4936857948-28"><span class="crayon-p"># define the grid search parameters</span></div><div class="crayon-line" id="crayon-5cf4a8ee36be4936857948-29"><span class="crayon-v">learn_rate</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">0.001</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.01</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.3</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36be4936857948-30"><span class="crayon-v">momentum</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">0.0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.4</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.6</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.8</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.9</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5cf4a8ee36be4936857948-31"><span class="crayon-v">param_grid</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">dict</span><span class="crayon-sy">(</span><span class="crayon-v">learn_rate</span><span class="crayon-o">=</span><span class="crayon-v">learn_rate</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">momentum</span><span class="crayon-o">=</span><span class="crayon-v">momentum</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36be4936857948-32"><span class="crayon-v">grid</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">GridSearchCV</span><span class="crayon-sy">(</span><span class="crayon-v">estimator</span><span class="crayon-o">=</span><span class="crayon-v">model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">param_grid</span><span class="crayon-o">=</span><span class="crayon-v">param_grid</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_jobs</span><span class="crayon-o">=</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5cf4a8ee36be4936857948-33"><span class="crayon-v">grid_result</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">grid</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">Y</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36be4936857948-34"><span class="crayon-p"># summarize results</span></div><div class="crayon-line" id="crayon-5cf4a8ee36be4936857948-35"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">"Best: %f using %s"</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">grid_result</span><span class="crayon-sy">.</span><span class="crayon-v">best_score_</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">grid_result</span><span class="crayon-sy">.</span><span class="crayon-v">best_params_</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36be4936857948-36"><span class="crayon-v">means</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">grid_result</span><span class="crayon-sy">.</span><span class="crayon-v">cv_results_</span><span class="crayon-sy">[</span><span class="crayon-s">'mean_test_score'</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5cf4a8ee36be4936857948-37"><span class="crayon-v">stds</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">grid_result</span><span class="crayon-sy">.</span><span class="crayon-v">cv_results_</span><span class="crayon-sy">[</span><span class="crayon-s">'std_test_score'</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36be4936857948-38"><span class="crayon-v">params</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">grid_result</span><span class="crayon-sy">.</span><span class="crayon-v">cv_results_</span><span class="crayon-sy">[</span><span class="crayon-s">'params'</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5cf4a8ee36be4936857948-39"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-v">mean</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">stdev</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">param </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">zip</span><span class="crayon-sy">(</span><span class="crayon-v">means</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">stds</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">params</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36be4936857948-40"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">"%f (%f) with: %r"</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">mean</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">stdev</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">param</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0042 seconds] -->
<p>Running this example produces the following output.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5cf4a8ee36be7029444839" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="readonly" style="-moz-tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;" wrap="soft">Best: 0.680990 using {'learn_rate': 0.01, 'momentum': 0.0}
0.348958 (0.024774) with: {'learn_rate': 0.001, 'momentum': 0.0}
0.348958 (0.024774) with: {'learn_rate': 0.001, 'momentum': 0.2}
0.467448 (0.151098) with: {'learn_rate': 0.001, 'momentum': 0.4}
0.662760 (0.012075) with: {'learn_rate': 0.001, 'momentum': 0.6}
0.669271 (0.030647) with: {'learn_rate': 0.001, 'momentum': 0.8}
0.666667 (0.035564) with: {'learn_rate': 0.001, 'momentum': 0.9}
0.680990 (0.024360) with: {'learn_rate': 0.01, 'momentum': 0.0}
0.677083 (0.026557) with: {'learn_rate': 0.01, 'momentum': 0.2}
0.427083 (0.134575) with: {'learn_rate': 0.01, 'momentum': 0.4}
0.427083 (0.134575) with: {'learn_rate': 0.01, 'momentum': 0.6}
0.544271 (0.146518) with: {'learn_rate': 0.01, 'momentum': 0.8}
0.651042 (0.024774) with: {'learn_rate': 0.01, 'momentum': 0.9}
0.651042 (0.024774) with: {'learn_rate': 0.1, 'momentum': 0.0}
0.651042 (0.024774) with: {'learn_rate': 0.1, 'momentum': 0.2}
0.572917 (0.134575) with: {'learn_rate': 0.1, 'momentum': 0.4}
0.572917 (0.134575) with: {'learn_rate': 0.1, 'momentum': 0.6}
0.651042 (0.024774) with: {'learn_rate': 0.1, 'momentum': 0.8}
0.651042 (0.024774) with: {'learn_rate': 0.1, 'momentum': 0.9}
0.533854 (0.149269) with: {'learn_rate': 0.2, 'momentum': 0.0}
0.427083 (0.134575) with: {'learn_rate': 0.2, 'momentum': 0.2}
0.427083 (0.134575) with: {'learn_rate': 0.2, 'momentum': 0.4}
0.651042 (0.024774) with: {'learn_rate': 0.2, 'momentum': 0.6}
0.651042 (0.024774) with: {'learn_rate': 0.2, 'momentum': 0.8}
0.651042 (0.024774) with: {'learn_rate': 0.2, 'momentum': 0.9}
0.455729 (0.146518) with: {'learn_rate': 0.3, 'momentum': 0.0}
0.455729 (0.146518) with: {'learn_rate': 0.3, 'momentum': 0.2}
0.455729 (0.146518) with: {'learn_rate': 0.3, 'momentum': 0.4}
0.348958 (0.024774) with: {'learn_rate': 0.3, 'momentum': 0.6}
0.348958 (0.024774) with: {'learn_rate': 0.3, 'momentum': 0.8}
0.348958 (0.024774) with: {'learn_rate': 0.3, 'momentum': 0.9}</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5cf4a8ee36be7029444839-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36be7029444839-2">2</div><div class="crayon-num" data-line="crayon-5cf4a8ee36be7029444839-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36be7029444839-4">4</div><div class="crayon-num" data-line="crayon-5cf4a8ee36be7029444839-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36be7029444839-6">6</div><div class="crayon-num" data-line="crayon-5cf4a8ee36be7029444839-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36be7029444839-8">8</div><div class="crayon-num" data-line="crayon-5cf4a8ee36be7029444839-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36be7029444839-10">10</div><div class="crayon-num" data-line="crayon-5cf4a8ee36be7029444839-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36be7029444839-12">12</div><div class="crayon-num" data-line="crayon-5cf4a8ee36be7029444839-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36be7029444839-14">14</div><div class="crayon-num" data-line="crayon-5cf4a8ee36be7029444839-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36be7029444839-16">16</div><div class="crayon-num" data-line="crayon-5cf4a8ee36be7029444839-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36be7029444839-18">18</div><div class="crayon-num" data-line="crayon-5cf4a8ee36be7029444839-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36be7029444839-20">20</div><div class="crayon-num" data-line="crayon-5cf4a8ee36be7029444839-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36be7029444839-22">22</div><div class="crayon-num" data-line="crayon-5cf4a8ee36be7029444839-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36be7029444839-24">24</div><div class="crayon-num" data-line="crayon-5cf4a8ee36be7029444839-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36be7029444839-26">26</div><div class="crayon-num" data-line="crayon-5cf4a8ee36be7029444839-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36be7029444839-28">28</div><div class="crayon-num" data-line="crayon-5cf4a8ee36be7029444839-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36be7029444839-30">30</div><div class="crayon-num" data-line="crayon-5cf4a8ee36be7029444839-31">31</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5cf4a8ee36be7029444839-1">Best: 0.680990 using {'learn_rate': 0.01, 'momentum': 0.0}</div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36be7029444839-2">0.348958 (0.024774) with: {'learn_rate': 0.001, 'momentum': 0.0}</div><div class="crayon-line" id="crayon-5cf4a8ee36be7029444839-3">0.348958 (0.024774) with: {'learn_rate': 0.001, 'momentum': 0.2}</div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36be7029444839-4">0.467448 (0.151098) with: {'learn_rate': 0.001, 'momentum': 0.4}</div><div class="crayon-line" id="crayon-5cf4a8ee36be7029444839-5">0.662760 (0.012075) with: {'learn_rate': 0.001, 'momentum': 0.6}</div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36be7029444839-6">0.669271 (0.030647) with: {'learn_rate': 0.001, 'momentum': 0.8}</div><div class="crayon-line" id="crayon-5cf4a8ee36be7029444839-7">0.666667 (0.035564) with: {'learn_rate': 0.001, 'momentum': 0.9}</div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36be7029444839-8">0.680990 (0.024360) with: {'learn_rate': 0.01, 'momentum': 0.0}</div><div class="crayon-line" id="crayon-5cf4a8ee36be7029444839-9">0.677083 (0.026557) with: {'learn_rate': 0.01, 'momentum': 0.2}</div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36be7029444839-10">0.427083 (0.134575) with: {'learn_rate': 0.01, 'momentum': 0.4}</div><div class="crayon-line" id="crayon-5cf4a8ee36be7029444839-11">0.427083 (0.134575) with: {'learn_rate': 0.01, 'momentum': 0.6}</div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36be7029444839-12">0.544271 (0.146518) with: {'learn_rate': 0.01, 'momentum': 0.8}</div><div class="crayon-line" id="crayon-5cf4a8ee36be7029444839-13">0.651042 (0.024774) with: {'learn_rate': 0.01, 'momentum': 0.9}</div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36be7029444839-14">0.651042 (0.024774) with: {'learn_rate': 0.1, 'momentum': 0.0}</div><div class="crayon-line" id="crayon-5cf4a8ee36be7029444839-15">0.651042 (0.024774) with: {'learn_rate': 0.1, 'momentum': 0.2}</div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36be7029444839-16">0.572917 (0.134575) with: {'learn_rate': 0.1, 'momentum': 0.4}</div><div class="crayon-line" id="crayon-5cf4a8ee36be7029444839-17">0.572917 (0.134575) with: {'learn_rate': 0.1, 'momentum': 0.6}</div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36be7029444839-18">0.651042 (0.024774) with: {'learn_rate': 0.1, 'momentum': 0.8}</div><div class="crayon-line" id="crayon-5cf4a8ee36be7029444839-19">0.651042 (0.024774) with: {'learn_rate': 0.1, 'momentum': 0.9}</div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36be7029444839-20">0.533854 (0.149269) with: {'learn_rate': 0.2, 'momentum': 0.0}</div><div class="crayon-line" id="crayon-5cf4a8ee36be7029444839-21">0.427083 (0.134575) with: {'learn_rate': 0.2, 'momentum': 0.2}</div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36be7029444839-22">0.427083 (0.134575) with: {'learn_rate': 0.2, 'momentum': 0.4}</div><div class="crayon-line" id="crayon-5cf4a8ee36be7029444839-23">0.651042 (0.024774) with: {'learn_rate': 0.2, 'momentum': 0.6}</div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36be7029444839-24">0.651042 (0.024774) with: {'learn_rate': 0.2, 'momentum': 0.8}</div><div class="crayon-line" id="crayon-5cf4a8ee36be7029444839-25">0.651042 (0.024774) with: {'learn_rate': 0.2, 'momentum': 0.9}</div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36be7029444839-26">0.455729 (0.146518) with: {'learn_rate': 0.3, 'momentum': 0.0}</div><div class="crayon-line" id="crayon-5cf4a8ee36be7029444839-27">0.455729 (0.146518) with: {'learn_rate': 0.3, 'momentum': 0.2}</div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36be7029444839-28">0.455729 (0.146518) with: {'learn_rate': 0.3, 'momentum': 0.4}</div><div class="crayon-line" id="crayon-5cf4a8ee36be7029444839-29">0.348958 (0.024774) with: {'learn_rate': 0.3, 'momentum': 0.6}</div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36be7029444839-30">0.348958 (0.024774) with: {'learn_rate': 0.3, 'momentum': 0.8}</div><div class="crayon-line" id="crayon-5cf4a8ee36be7029444839-31">0.348958 (0.024774) with: {'learn_rate': 0.3, 'momentum': 0.9}</div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>We can see that relatively SGD is not very good on this problem, 
nevertheless best results were achieved using a learning rate of 0.01 
and a momentum of 0.0 with an accuracy of about 68%.</p>
<h2>How to Tune Network Weight Initialization</h2>
<p>Neural network weight initialization used to be simple: use small random values.</p>
<p>Now there is&nbsp;a suite of different techniques to choose from. <a href="http://keras.io/initializations/">Keras provides a laundry list</a>.</p>
<p>In this example, we will look at tuning the selection of network 
weight initialization by evaluating all of the available techniques.</p>
<p>We will use the same weight initialization method on each layer. 
Ideally, it may be better to use different weight initialization schemes
 according to the activation function used on each layer. In the example
 below we use rectifier for the hidden layer. We use&nbsp;sigmoid for 
the output layer because the predictions are binary.</p>
<p>The full code listing is provided below.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5cf4a8ee36beb102582868" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important; margin-top: -18px; display: none;"></div>
			<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="readonly" style="-moz-tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;" wrap="soft"># Use scikit-learn to grid search the weight initialization
import numpy
from sklearn.model_selection import GridSearchCV
from keras.models import Sequential
from keras.layers import Dense
from keras.wrappers.scikit_learn import KerasClassifier
# Function to create model, required for KerasClassifier
def create_model(init_mode='uniform'):
	# create model
	model = Sequential()
	model.add(Dense(12, input_dim=8, kernel_initializer=init_mode, activation='relu'))
	model.add(Dense(1, kernel_initializer=init_mode, activation='sigmoid'))
	# Compile model
	model.compile(loss='binary_crossentropy', optimizer='adam', metrics=['accuracy'])
	return model
# fix random seed for reproducibility
seed = 7
numpy.random.seed(seed)
# load dataset
dataset = numpy.loadtxt("pima-indians-diabetes.csv", delimiter=",")
# split into input (X) and output (Y) variables
X = dataset[:,0:8]
Y = dataset[:,8]
# create model
model = KerasClassifier(build_fn=create_model, epochs=100, batch_size=10, verbose=0)
# define the grid search parameters
init_mode = ['uniform', 'lecun_uniform', 'normal', 'zero', 'glorot_normal', 'glorot_uniform', 'he_normal', 'he_uniform']
param_grid = dict(init_mode=init_mode)
grid = GridSearchCV(estimator=model, param_grid=param_grid, n_jobs=-1)
grid_result = grid.fit(X, Y)
# summarize results
print("Best: %f using %s" % (grid_result.best_score_, grid_result.best_params_))
means = grid_result.cv_results_['mean_test_score']
stds = grid_result.cv_results_['std_test_score']
params = grid_result.cv_results_['params']
for mean, stdev, param in zip(means, stds, params):
    print("%f (%f) with: %r" % (mean, stdev, param))</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5cf4a8ee36beb102582868-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36beb102582868-2">2</div><div class="crayon-num" data-line="crayon-5cf4a8ee36beb102582868-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36beb102582868-4">4</div><div class="crayon-num" data-line="crayon-5cf4a8ee36beb102582868-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36beb102582868-6">6</div><div class="crayon-num" data-line="crayon-5cf4a8ee36beb102582868-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36beb102582868-8">8</div><div class="crayon-num" data-line="crayon-5cf4a8ee36beb102582868-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36beb102582868-10">10</div><div class="crayon-num" data-line="crayon-5cf4a8ee36beb102582868-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36beb102582868-12">12</div><div class="crayon-num" data-line="crayon-5cf4a8ee36beb102582868-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36beb102582868-14">14</div><div class="crayon-num" data-line="crayon-5cf4a8ee36beb102582868-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36beb102582868-16">16</div><div class="crayon-num" data-line="crayon-5cf4a8ee36beb102582868-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36beb102582868-18">18</div><div class="crayon-num" data-line="crayon-5cf4a8ee36beb102582868-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36beb102582868-20">20</div><div class="crayon-num" data-line="crayon-5cf4a8ee36beb102582868-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36beb102582868-22">22</div><div class="crayon-num" data-line="crayon-5cf4a8ee36beb102582868-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36beb102582868-24">24</div><div class="crayon-num" data-line="crayon-5cf4a8ee36beb102582868-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36beb102582868-26">26</div><div class="crayon-num" data-line="crayon-5cf4a8ee36beb102582868-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36beb102582868-28">28</div><div class="crayon-num" data-line="crayon-5cf4a8ee36beb102582868-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36beb102582868-30">30</div><div class="crayon-num" data-line="crayon-5cf4a8ee36beb102582868-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36beb102582868-32">32</div><div class="crayon-num" data-line="crayon-5cf4a8ee36beb102582868-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36beb102582868-34">34</div><div class="crayon-num" data-line="crayon-5cf4a8ee36beb102582868-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36beb102582868-36">36</div><div class="crayon-num" data-line="crayon-5cf4a8ee36beb102582868-37">37</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5cf4a8ee36beb102582868-1"><span class="crayon-p"># Use scikit-learn to grid search the weight initialization</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36beb102582868-2"><span class="crayon-e">import </span><span class="crayon-e">numpy</span></div><div class="crayon-line" id="crayon-5cf4a8ee36beb102582868-3"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">model_selection </span><span class="crayon-e">import </span><span class="crayon-e">GridSearchCV</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36beb102582868-4"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">models </span><span class="crayon-e">import </span><span class="crayon-e">Sequential</span></div><div class="crayon-line" id="crayon-5cf4a8ee36beb102582868-5"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Dense</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36beb102582868-6"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-v">wrappers</span><span class="crayon-sy">.</span><span class="crayon-e">scikit_learn </span><span class="crayon-e">import </span><span class="crayon-v">KerasClassifier</span></div><div class="crayon-line" id="crayon-5cf4a8ee36beb102582868-7"><span class="crayon-p"># Function to create model, required for KerasClassifier</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36beb102582868-8"><span class="crayon-e">def </span><span class="crayon-e">create_model</span><span class="crayon-sy">(</span><span class="crayon-v">init_mode</span><span class="crayon-o">=</span><span class="crayon-s">'uniform'</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5cf4a8ee36beb102582868-9"><span class="crayon-h">	</span><span class="crayon-p"># create model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36beb102582868-10"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Sequential</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5cf4a8ee36beb102582868-11"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">12</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">input_dim</span><span class="crayon-o">=</span><span class="crayon-cn">8</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kernel_initializer</span><span class="crayon-o">=</span><span class="crayon-v">init_mode</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36beb102582868-12"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kernel_initializer</span><span class="crayon-o">=</span><span class="crayon-v">init_mode</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'sigmoid'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5cf4a8ee36beb102582868-13"><span class="crayon-h">	</span><span class="crayon-p"># Compile model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36beb102582868-14"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">compile</span><span class="crayon-sy">(</span><span class="crayon-v">loss</span><span class="crayon-o">=</span><span class="crayon-s">'binary_crossentropy'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">optimizer</span><span class="crayon-o">=</span><span class="crayon-s">'adam'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">metrics</span><span class="crayon-o">=</span><span class="crayon-sy">[</span><span class="crayon-s">'accuracy'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5cf4a8ee36beb102582868-15"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36beb102582868-16"><span class="crayon-p"># fix random seed for reproducibility</span></div><div class="crayon-line" id="crayon-5cf4a8ee36beb102582868-17"><span class="crayon-v">seed</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">7</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36beb102582868-18"><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-v">random</span><span class="crayon-sy">.</span><span class="crayon-e">seed</span><span class="crayon-sy">(</span><span class="crayon-v">seed</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5cf4a8ee36beb102582868-19"><span class="crayon-p"># load dataset</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36beb102582868-20"><span class="crayon-v">dataset</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-e">loadtxt</span><span class="crayon-sy">(</span><span class="crayon-s">"pima-indians-diabetes.csv"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">delimiter</span><span class="crayon-o">=</span><span class="crayon-s">","</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5cf4a8ee36beb102582868-21"><span class="crayon-p"># split into input (X) and output (Y) variables</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36beb102582868-22"><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-o">:</span><span class="crayon-cn">8</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5cf4a8ee36beb102582868-23"><span class="crayon-v">Y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-cn">8</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36beb102582868-24"><span class="crayon-p"># create model</span></div><div class="crayon-line" id="crayon-5cf4a8ee36beb102582868-25"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">KerasClassifier</span><span class="crayon-sy">(</span><span class="crayon-v">build_fn</span><span class="crayon-o">=</span><span class="crayon-v">create_model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">epochs</span><span class="crayon-o">=</span><span class="crayon-cn">100</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">batch_size</span><span class="crayon-o">=</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36beb102582868-26"><span class="crayon-p"># define the grid search parameters</span></div><div class="crayon-line" id="crayon-5cf4a8ee36beb102582868-27"><span class="crayon-v">init_mode</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-s">'uniform'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'lecun_uniform'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'normal'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'zero'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'glorot_normal'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'glorot_uniform'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'he_normal'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'he_uniform'</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36beb102582868-28"><span class="crayon-v">param_grid</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">dict</span><span class="crayon-sy">(</span><span class="crayon-v">init_mode</span><span class="crayon-o">=</span><span class="crayon-v">init_mode</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5cf4a8ee36beb102582868-29"><span class="crayon-v">grid</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">GridSearchCV</span><span class="crayon-sy">(</span><span class="crayon-v">estimator</span><span class="crayon-o">=</span><span class="crayon-v">model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">param_grid</span><span class="crayon-o">=</span><span class="crayon-v">param_grid</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_jobs</span><span class="crayon-o">=</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36beb102582868-30"><span class="crayon-v">grid_result</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">grid</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">Y</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5cf4a8ee36beb102582868-31"><span class="crayon-p"># summarize results</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36beb102582868-32"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">"Best: %f using %s"</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">grid_result</span><span class="crayon-sy">.</span><span class="crayon-v">best_score_</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">grid_result</span><span class="crayon-sy">.</span><span class="crayon-v">best_params_</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5cf4a8ee36beb102582868-33"><span class="crayon-v">means</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">grid_result</span><span class="crayon-sy">.</span><span class="crayon-v">cv_results_</span><span class="crayon-sy">[</span><span class="crayon-s">'mean_test_score'</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36beb102582868-34"><span class="crayon-v">stds</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">grid_result</span><span class="crayon-sy">.</span><span class="crayon-v">cv_results_</span><span class="crayon-sy">[</span><span class="crayon-s">'std_test_score'</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5cf4a8ee36beb102582868-35"><span class="crayon-v">params</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">grid_result</span><span class="crayon-sy">.</span><span class="crayon-v">cv_results_</span><span class="crayon-sy">[</span><span class="crayon-s">'params'</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36beb102582868-36"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-v">mean</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">stdev</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">param </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">zip</span><span class="crayon-sy">(</span><span class="crayon-v">means</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">stds</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">params</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5cf4a8ee36beb102582868-37"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">"%f (%f) with: %r"</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">mean</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">stdev</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">param</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0036 seconds] -->
<p>Running this example produces the following output.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5cf4a8ee36bee890386320" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="readonly" style="-moz-tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;" wrap="soft">Best: 0.720052 using {'init_mode': 'uniform'}
0.720052 (0.024360) with: {'init_mode': 'uniform'}
0.348958 (0.024774) with: {'init_mode': 'lecun_uniform'}
0.712240 (0.012075) with: {'init_mode': 'normal'}
0.651042 (0.024774) with: {'init_mode': 'zero'}
0.700521 (0.010253) with: {'init_mode': 'glorot_normal'}
0.674479 (0.011201) with: {'init_mode': 'glorot_uniform'}
0.661458 (0.028940) with: {'init_mode': 'he_normal'}
0.678385 (0.004872) with: {'init_mode': 'he_uniform'}</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5cf4a8ee36bee890386320-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36bee890386320-2">2</div><div class="crayon-num" data-line="crayon-5cf4a8ee36bee890386320-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36bee890386320-4">4</div><div class="crayon-num" data-line="crayon-5cf4a8ee36bee890386320-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36bee890386320-6">6</div><div class="crayon-num" data-line="crayon-5cf4a8ee36bee890386320-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36bee890386320-8">8</div><div class="crayon-num" data-line="crayon-5cf4a8ee36bee890386320-9">9</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5cf4a8ee36bee890386320-1">Best: 0.720052 using {'init_mode': 'uniform'}</div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36bee890386320-2">0.720052 (0.024360) with: {'init_mode': 'uniform'}</div><div class="crayon-line" id="crayon-5cf4a8ee36bee890386320-3">0.348958 (0.024774) with: {'init_mode': 'lecun_uniform'}</div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36bee890386320-4">0.712240 (0.012075) with: {'init_mode': 'normal'}</div><div class="crayon-line" id="crayon-5cf4a8ee36bee890386320-5">0.651042 (0.024774) with: {'init_mode': 'zero'}</div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36bee890386320-6">0.700521 (0.010253) with: {'init_mode': 'glorot_normal'}</div><div class="crayon-line" id="crayon-5cf4a8ee36bee890386320-7">0.674479 (0.011201) with: {'init_mode': 'glorot_uniform'}</div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36bee890386320-8">0.661458 (0.028940) with: {'init_mode': 'he_normal'}</div><div class="crayon-line" id="crayon-5cf4a8ee36bee890386320-9">0.678385 (0.004872) with: {'init_mode': 'he_uniform'}</div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>We can see that the best results were achieved with a uniform weight initialization scheme achieving a performance of about 72%.</p>
<h2>How to Tune the Neuron Activation&nbsp;Function</h2>
<p>The activation function controls the non-linearity of individual neurons and when to fire.</p>
<p>Generally, the rectifier activation function is the most popular, but
 it used to be the sigmoid and the tanh functions and these functions 
may still be more suitable for different problems.</p>
<p>In this example, we will evaluate the suite of <a href="http://keras.io/activations/">different activation functions available in Keras</a>.
 We will only use these functions in the hidden layer, as we require a 
sigmoid activation function in the output for the binary classification 
problem.</p>
<p>Generally, it is a good idea to prepare data to the range of the 
different transfer functions, which we will not do in this case.</p>
<p>The full code listing is provided below.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5cf4a8ee36bf7209823885" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important; margin-top: -18px; display: none;"></div>
			<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="readonly" style="-moz-tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;" wrap="soft"># Use scikit-learn to grid search the activation function
import numpy
from sklearn.model_selection import GridSearchCV
from keras.models import Sequential
from keras.layers import Dense
from keras.wrappers.scikit_learn import KerasClassifier
# Function to create model, required for KerasClassifier
def create_model(activation='relu'):
	# create model
	model = Sequential()
	model.add(Dense(12, input_dim=8, kernel_initializer='uniform', activation=activation))
	model.add(Dense(1, kernel_initializer='uniform', activation='sigmoid'))
	# Compile model
	model.compile(loss='binary_crossentropy', optimizer='adam', metrics=['accuracy'])
	return model
# fix random seed for reproducibility
seed = 7
numpy.random.seed(seed)
# load dataset
dataset = numpy.loadtxt("pima-indians-diabetes.csv", delimiter=",")
# split into input (X) and output (Y) variables
X = dataset[:,0:8]
Y = dataset[:,8]
# create model
model = KerasClassifier(build_fn=create_model, epochs=100, batch_size=10, verbose=0)
# define the grid search parameters
activation = ['softmax', 'softplus', 'softsign', 'relu', 'tanh', 'sigmoid', 'hard_sigmoid', 'linear']
param_grid = dict(activation=activation)
grid = GridSearchCV(estimator=model, param_grid=param_grid, n_jobs=-1)
grid_result = grid.fit(X, Y)
# summarize results
print("Best: %f using %s" % (grid_result.best_score_, grid_result.best_params_))
means = grid_result.cv_results_['mean_test_score']
stds = grid_result.cv_results_['std_test_score']
params = grid_result.cv_results_['params']
for mean, stdev, param in zip(means, stds, params):
    print("%f (%f) with: %r" % (mean, stdev, param))</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5cf4a8ee36bf7209823885-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36bf7209823885-2">2</div><div class="crayon-num" data-line="crayon-5cf4a8ee36bf7209823885-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36bf7209823885-4">4</div><div class="crayon-num" data-line="crayon-5cf4a8ee36bf7209823885-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36bf7209823885-6">6</div><div class="crayon-num" data-line="crayon-5cf4a8ee36bf7209823885-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36bf7209823885-8">8</div><div class="crayon-num" data-line="crayon-5cf4a8ee36bf7209823885-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36bf7209823885-10">10</div><div class="crayon-num" data-line="crayon-5cf4a8ee36bf7209823885-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36bf7209823885-12">12</div><div class="crayon-num" data-line="crayon-5cf4a8ee36bf7209823885-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36bf7209823885-14">14</div><div class="crayon-num" data-line="crayon-5cf4a8ee36bf7209823885-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36bf7209823885-16">16</div><div class="crayon-num" data-line="crayon-5cf4a8ee36bf7209823885-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36bf7209823885-18">18</div><div class="crayon-num" data-line="crayon-5cf4a8ee36bf7209823885-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36bf7209823885-20">20</div><div class="crayon-num" data-line="crayon-5cf4a8ee36bf7209823885-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36bf7209823885-22">22</div><div class="crayon-num" data-line="crayon-5cf4a8ee36bf7209823885-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36bf7209823885-24">24</div><div class="crayon-num" data-line="crayon-5cf4a8ee36bf7209823885-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36bf7209823885-26">26</div><div class="crayon-num" data-line="crayon-5cf4a8ee36bf7209823885-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36bf7209823885-28">28</div><div class="crayon-num" data-line="crayon-5cf4a8ee36bf7209823885-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36bf7209823885-30">30</div><div class="crayon-num" data-line="crayon-5cf4a8ee36bf7209823885-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36bf7209823885-32">32</div><div class="crayon-num" data-line="crayon-5cf4a8ee36bf7209823885-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36bf7209823885-34">34</div><div class="crayon-num" data-line="crayon-5cf4a8ee36bf7209823885-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36bf7209823885-36">36</div><div class="crayon-num" data-line="crayon-5cf4a8ee36bf7209823885-37">37</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5cf4a8ee36bf7209823885-1"><span class="crayon-p"># Use scikit-learn to grid search the activation function</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36bf7209823885-2"><span class="crayon-e">import </span><span class="crayon-e">numpy</span></div><div class="crayon-line" id="crayon-5cf4a8ee36bf7209823885-3"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">model_selection </span><span class="crayon-e">import </span><span class="crayon-e">GridSearchCV</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36bf7209823885-4"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">models </span><span class="crayon-e">import </span><span class="crayon-e">Sequential</span></div><div class="crayon-line" id="crayon-5cf4a8ee36bf7209823885-5"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Dense</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36bf7209823885-6"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-v">wrappers</span><span class="crayon-sy">.</span><span class="crayon-e">scikit_learn </span><span class="crayon-e">import </span><span class="crayon-v">KerasClassifier</span></div><div class="crayon-line" id="crayon-5cf4a8ee36bf7209823885-7"><span class="crayon-p"># Function to create model, required for KerasClassifier</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36bf7209823885-8"><span class="crayon-e">def </span><span class="crayon-e">create_model</span><span class="crayon-sy">(</span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5cf4a8ee36bf7209823885-9"><span class="crayon-h">	</span><span class="crayon-p"># create model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36bf7209823885-10"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Sequential</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5cf4a8ee36bf7209823885-11"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">12</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">input_dim</span><span class="crayon-o">=</span><span class="crayon-cn">8</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kernel_initializer</span><span class="crayon-o">=</span><span class="crayon-s">'uniform'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-v">activation</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36bf7209823885-12"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kernel_initializer</span><span class="crayon-o">=</span><span class="crayon-s">'uniform'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'sigmoid'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5cf4a8ee36bf7209823885-13"><span class="crayon-h">	</span><span class="crayon-p"># Compile model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36bf7209823885-14"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">compile</span><span class="crayon-sy">(</span><span class="crayon-v">loss</span><span class="crayon-o">=</span><span class="crayon-s">'binary_crossentropy'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">optimizer</span><span class="crayon-o">=</span><span class="crayon-s">'adam'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">metrics</span><span class="crayon-o">=</span><span class="crayon-sy">[</span><span class="crayon-s">'accuracy'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5cf4a8ee36bf7209823885-15"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36bf7209823885-16"><span class="crayon-p"># fix random seed for reproducibility</span></div><div class="crayon-line" id="crayon-5cf4a8ee36bf7209823885-17"><span class="crayon-v">seed</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">7</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36bf7209823885-18"><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-v">random</span><span class="crayon-sy">.</span><span class="crayon-e">seed</span><span class="crayon-sy">(</span><span class="crayon-v">seed</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5cf4a8ee36bf7209823885-19"><span class="crayon-p"># load dataset</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36bf7209823885-20"><span class="crayon-v">dataset</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-e">loadtxt</span><span class="crayon-sy">(</span><span class="crayon-s">"pima-indians-diabetes.csv"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">delimiter</span><span class="crayon-o">=</span><span class="crayon-s">","</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5cf4a8ee36bf7209823885-21"><span class="crayon-p"># split into input (X) and output (Y) variables</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36bf7209823885-22"><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-o">:</span><span class="crayon-cn">8</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5cf4a8ee36bf7209823885-23"><span class="crayon-v">Y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-cn">8</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36bf7209823885-24"><span class="crayon-p"># create model</span></div><div class="crayon-line" id="crayon-5cf4a8ee36bf7209823885-25"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">KerasClassifier</span><span class="crayon-sy">(</span><span class="crayon-v">build_fn</span><span class="crayon-o">=</span><span class="crayon-v">create_model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">epochs</span><span class="crayon-o">=</span><span class="crayon-cn">100</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">batch_size</span><span class="crayon-o">=</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36bf7209823885-26"><span class="crayon-p"># define the grid search parameters</span></div><div class="crayon-line" id="crayon-5cf4a8ee36bf7209823885-27"><span class="crayon-v">activation</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-s">'softmax'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'softplus'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'softsign'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'relu'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'tanh'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'sigmoid'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'hard_sigmoid'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'linear'</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36bf7209823885-28"><span class="crayon-v">param_grid</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">dict</span><span class="crayon-sy">(</span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-v">activation</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5cf4a8ee36bf7209823885-29"><span class="crayon-v">grid</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">GridSearchCV</span><span class="crayon-sy">(</span><span class="crayon-v">estimator</span><span class="crayon-o">=</span><span class="crayon-v">model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">param_grid</span><span class="crayon-o">=</span><span class="crayon-v">param_grid</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_jobs</span><span class="crayon-o">=</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36bf7209823885-30"><span class="crayon-v">grid_result</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">grid</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">Y</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5cf4a8ee36bf7209823885-31"><span class="crayon-p"># summarize results</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36bf7209823885-32"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">"Best: %f using %s"</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">grid_result</span><span class="crayon-sy">.</span><span class="crayon-v">best_score_</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">grid_result</span><span class="crayon-sy">.</span><span class="crayon-v">best_params_</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5cf4a8ee36bf7209823885-33"><span class="crayon-v">means</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">grid_result</span><span class="crayon-sy">.</span><span class="crayon-v">cv_results_</span><span class="crayon-sy">[</span><span class="crayon-s">'mean_test_score'</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36bf7209823885-34"><span class="crayon-v">stds</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">grid_result</span><span class="crayon-sy">.</span><span class="crayon-v">cv_results_</span><span class="crayon-sy">[</span><span class="crayon-s">'std_test_score'</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5cf4a8ee36bf7209823885-35"><span class="crayon-v">params</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">grid_result</span><span class="crayon-sy">.</span><span class="crayon-v">cv_results_</span><span class="crayon-sy">[</span><span class="crayon-s">'params'</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36bf7209823885-36"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-v">mean</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">stdev</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">param </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">zip</span><span class="crayon-sy">(</span><span class="crayon-v">means</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">stds</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">params</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5cf4a8ee36bf7209823885-37"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">"%f (%f) with: %r"</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">mean</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">stdev</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">param</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0036 seconds] -->
<p>Running this example produces the following output.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5cf4a8ee36bfb280917751" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important; margin-top: -18px; display: none;"></div>
			<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="readonly" style="-moz-tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;" wrap="soft">Best: 0.722656 using {'activation': 'linear'}
0.649740 (0.009744) with: {'activation': 'softmax'}
0.720052 (0.032106) with: {'activation': 'softplus'}
0.688802 (0.019225) with: {'activation': 'softsign'}
0.720052 (0.018136) with: {'activation': 'relu'}
0.691406 (0.019401) with: {'activation': 'tanh'}
0.680990 (0.009207) with: {'activation': 'sigmoid'}
0.691406 (0.014616) with: {'activation': 'hard_sigmoid'}
0.722656 (0.003189) with: {'activation': 'linear'}</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5cf4a8ee36bfb280917751-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36bfb280917751-2">2</div><div class="crayon-num" data-line="crayon-5cf4a8ee36bfb280917751-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36bfb280917751-4">4</div><div class="crayon-num" data-line="crayon-5cf4a8ee36bfb280917751-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36bfb280917751-6">6</div><div class="crayon-num" data-line="crayon-5cf4a8ee36bfb280917751-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36bfb280917751-8">8</div><div class="crayon-num" data-line="crayon-5cf4a8ee36bfb280917751-9">9</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5cf4a8ee36bfb280917751-1">Best: 0.722656 using {'activation': 'linear'}</div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36bfb280917751-2">0.649740 (0.009744) with: {'activation': 'softmax'}</div><div class="crayon-line" id="crayon-5cf4a8ee36bfb280917751-3">0.720052 (0.032106) with: {'activation': 'softplus'}</div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36bfb280917751-4">0.688802 (0.019225) with: {'activation': 'softsign'}</div><div class="crayon-line" id="crayon-5cf4a8ee36bfb280917751-5">0.720052 (0.018136) with: {'activation': 'relu'}</div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36bfb280917751-6">0.691406 (0.019401) with: {'activation': 'tanh'}</div><div class="crayon-line" id="crayon-5cf4a8ee36bfb280917751-7">0.680990 (0.009207) with: {'activation': 'sigmoid'}</div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36bfb280917751-8">0.691406 (0.014616) with: {'activation': 'hard_sigmoid'}</div><div class="crayon-line" id="crayon-5cf4a8ee36bfb280917751-9">0.722656 (0.003189) with: {'activation': 'linear'}</div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>Surprisingly (to me at least), the ‘linear’ activation function achieved the best results with an accuracy of about 72%.</p>
<h2>How to Tune Dropout Regularization</h2>
<p>In this example, we will look at tuning the <a href="https://machinelearningmastery.com/dropout-for-regularizing-deep-neural-networks/">dropout rate for regularization</a> in an effort to limit overfitting and improve the model’s ability to generalize.</p>
<p>To get good results, dropout is best combined with a weight constraint such as the max norm constraint.</p>
<p>For more on using dropout in deep learning models with Keras see the post:</p>
<ul>
<li><a href="http://machinelearningmastery.com/dropout-regularization-deep-learning-models-keras/">Dropout Regularization in Deep Learning Models With Keras</a></li>
</ul>
<p>This involves fitting both the dropout percentage and the weight 
constraint. We will try dropout percentages between 0.0 and 0.9 (1.0 
does not make sense) and maxnorm weight constraint values between 0 and 
5.</p>
<p>The full code listing is provided below.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5cf4a8ee36bfe143618976" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important; margin-top: -18px; display: none;"></div>
			<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="readonly" style="-moz-tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;" wrap="soft"># Use scikit-learn to grid search the dropout rate
import numpy
from sklearn.model_selection import GridSearchCV
from keras.models import Sequential
from keras.layers import Dense
from keras.layers import Dropout
from keras.wrappers.scikit_learn import KerasClassifier
from keras.constraints import maxnorm
# Function to create model, required for KerasClassifier
def create_model(dropout_rate=0.0, weight_constraint=0):
	# create model
	model = Sequential()
	model.add(Dense(12, input_dim=8, kernel_initializer='uniform', activation='linear', kernel_constraint=maxnorm(weight_constraint)))
	model.add(Dropout(dropout_rate))
	model.add(Dense(1, kernel_initializer='uniform', activation='sigmoid'))
	# Compile model
	model.compile(loss='binary_crossentropy', optimizer='adam', metrics=['accuracy'])
	return model
# fix random seed for reproducibility
seed = 7
numpy.random.seed(seed)
# load dataset
dataset = numpy.loadtxt("pima-indians-diabetes.csv", delimiter=",")
# split into input (X) and output (Y) variables
X = dataset[:,0:8]
Y = dataset[:,8]
# create model
model = KerasClassifier(build_fn=create_model, epochs=100, batch_size=10, verbose=0)
# define the grid search parameters
weight_constraint = [1, 2, 3, 4, 5]
dropout_rate = [0.0, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9]
param_grid = dict(dropout_rate=dropout_rate, weight_constraint=weight_constraint)
grid = GridSearchCV(estimator=model, param_grid=param_grid, n_jobs=-1)
grid_result = grid.fit(X, Y)
# summarize results
print("Best: %f using %s" % (grid_result.best_score_, grid_result.best_params_))
means = grid_result.cv_results_['mean_test_score']
stds = grid_result.cv_results_['std_test_score']
params = grid_result.cv_results_['params']
for mean, stdev, param in zip(means, stds, params):
    print("%f (%f) with: %r" % (mean, stdev, param))</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5cf4a8ee36bfe143618976-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36bfe143618976-2">2</div><div class="crayon-num" data-line="crayon-5cf4a8ee36bfe143618976-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36bfe143618976-4">4</div><div class="crayon-num" data-line="crayon-5cf4a8ee36bfe143618976-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36bfe143618976-6">6</div><div class="crayon-num" data-line="crayon-5cf4a8ee36bfe143618976-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36bfe143618976-8">8</div><div class="crayon-num" data-line="crayon-5cf4a8ee36bfe143618976-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36bfe143618976-10">10</div><div class="crayon-num" data-line="crayon-5cf4a8ee36bfe143618976-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36bfe143618976-12">12</div><div class="crayon-num" data-line="crayon-5cf4a8ee36bfe143618976-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36bfe143618976-14">14</div><div class="crayon-num" data-line="crayon-5cf4a8ee36bfe143618976-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36bfe143618976-16">16</div><div class="crayon-num" data-line="crayon-5cf4a8ee36bfe143618976-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36bfe143618976-18">18</div><div class="crayon-num" data-line="crayon-5cf4a8ee36bfe143618976-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36bfe143618976-20">20</div><div class="crayon-num" data-line="crayon-5cf4a8ee36bfe143618976-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36bfe143618976-22">22</div><div class="crayon-num" data-line="crayon-5cf4a8ee36bfe143618976-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36bfe143618976-24">24</div><div class="crayon-num" data-line="crayon-5cf4a8ee36bfe143618976-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36bfe143618976-26">26</div><div class="crayon-num" data-line="crayon-5cf4a8ee36bfe143618976-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36bfe143618976-28">28</div><div class="crayon-num" data-line="crayon-5cf4a8ee36bfe143618976-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36bfe143618976-30">30</div><div class="crayon-num" data-line="crayon-5cf4a8ee36bfe143618976-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36bfe143618976-32">32</div><div class="crayon-num" data-line="crayon-5cf4a8ee36bfe143618976-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36bfe143618976-34">34</div><div class="crayon-num" data-line="crayon-5cf4a8ee36bfe143618976-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36bfe143618976-36">36</div><div class="crayon-num" data-line="crayon-5cf4a8ee36bfe143618976-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36bfe143618976-38">38</div><div class="crayon-num" data-line="crayon-5cf4a8ee36bfe143618976-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36bfe143618976-40">40</div><div class="crayon-num" data-line="crayon-5cf4a8ee36bfe143618976-41">41</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5cf4a8ee36bfe143618976-1"><span class="crayon-p"># Use scikit-learn to grid search the dropout rate</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36bfe143618976-2"><span class="crayon-e">import </span><span class="crayon-e">numpy</span></div><div class="crayon-line" id="crayon-5cf4a8ee36bfe143618976-3"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">model_selection </span><span class="crayon-e">import </span><span class="crayon-e">GridSearchCV</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36bfe143618976-4"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">models </span><span class="crayon-e">import </span><span class="crayon-e">Sequential</span></div><div class="crayon-line" id="crayon-5cf4a8ee36bfe143618976-5"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Dense</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36bfe143618976-6"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Dropout</span></div><div class="crayon-line" id="crayon-5cf4a8ee36bfe143618976-7"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-v">wrappers</span><span class="crayon-sy">.</span><span class="crayon-e">scikit_learn </span><span class="crayon-e">import </span><span class="crayon-e">KerasClassifier</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36bfe143618976-8"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">constraints </span><span class="crayon-e">import </span><span class="crayon-v">maxnorm</span></div><div class="crayon-line" id="crayon-5cf4a8ee36bfe143618976-9"><span class="crayon-p"># Function to create model, required for KerasClassifier</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36bfe143618976-10"><span class="crayon-e">def </span><span class="crayon-e">create_model</span><span class="crayon-sy">(</span><span class="crayon-v">dropout_rate</span><span class="crayon-o">=</span><span class="crayon-cn">0.0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">weight_constraint</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5cf4a8ee36bfe143618976-11"><span class="crayon-h">	</span><span class="crayon-p"># create model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36bfe143618976-12"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Sequential</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5cf4a8ee36bfe143618976-13"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">12</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">input_dim</span><span class="crayon-o">=</span><span class="crayon-cn">8</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kernel_initializer</span><span class="crayon-o">=</span><span class="crayon-s">'uniform'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'linear'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kernel_constraint</span><span class="crayon-o">=</span><span class="crayon-e">maxnorm</span><span class="crayon-sy">(</span><span class="crayon-v">weight_constraint</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36bfe143618976-14"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dropout</span><span class="crayon-sy">(</span><span class="crayon-v">dropout_rate</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5cf4a8ee36bfe143618976-15"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kernel_initializer</span><span class="crayon-o">=</span><span class="crayon-s">'uniform'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'sigmoid'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36bfe143618976-16"><span class="crayon-h">	</span><span class="crayon-p"># Compile model</span></div><div class="crayon-line" id="crayon-5cf4a8ee36bfe143618976-17"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">compile</span><span class="crayon-sy">(</span><span class="crayon-v">loss</span><span class="crayon-o">=</span><span class="crayon-s">'binary_crossentropy'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">optimizer</span><span class="crayon-o">=</span><span class="crayon-s">'adam'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">metrics</span><span class="crayon-o">=</span><span class="crayon-sy">[</span><span class="crayon-s">'accuracy'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36bfe143618976-18"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">model</span></div><div class="crayon-line" id="crayon-5cf4a8ee36bfe143618976-19"><span class="crayon-p"># fix random seed for reproducibility</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36bfe143618976-20"><span class="crayon-v">seed</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">7</span></div><div class="crayon-line" id="crayon-5cf4a8ee36bfe143618976-21"><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-v">random</span><span class="crayon-sy">.</span><span class="crayon-e">seed</span><span class="crayon-sy">(</span><span class="crayon-v">seed</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36bfe143618976-22"><span class="crayon-p"># load dataset</span></div><div class="crayon-line" id="crayon-5cf4a8ee36bfe143618976-23"><span class="crayon-v">dataset</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-e">loadtxt</span><span class="crayon-sy">(</span><span class="crayon-s">"pima-indians-diabetes.csv"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">delimiter</span><span class="crayon-o">=</span><span class="crayon-s">","</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36bfe143618976-24"><span class="crayon-p"># split into input (X) and output (Y) variables</span></div><div class="crayon-line" id="crayon-5cf4a8ee36bfe143618976-25"><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-o">:</span><span class="crayon-cn">8</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36bfe143618976-26"><span class="crayon-v">Y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-cn">8</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5cf4a8ee36bfe143618976-27"><span class="crayon-p"># create model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36bfe143618976-28"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">KerasClassifier</span><span class="crayon-sy">(</span><span class="crayon-v">build_fn</span><span class="crayon-o">=</span><span class="crayon-v">create_model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">epochs</span><span class="crayon-o">=</span><span class="crayon-cn">100</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">batch_size</span><span class="crayon-o">=</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5cf4a8ee36bfe143618976-29"><span class="crayon-p"># define the grid search parameters</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36bfe143618976-30"><span class="crayon-v">weight_constraint</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">4</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">5</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5cf4a8ee36bfe143618976-31"><span class="crayon-v">dropout_rate</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">0.0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.4</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.5</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.6</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.7</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.8</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.9</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36bfe143618976-32"><span class="crayon-v">param_grid</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">dict</span><span class="crayon-sy">(</span><span class="crayon-v">dropout_rate</span><span class="crayon-o">=</span><span class="crayon-v">dropout_rate</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">weight_constraint</span><span class="crayon-o">=</span><span class="crayon-v">weight_constraint</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5cf4a8ee36bfe143618976-33"><span class="crayon-v">grid</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">GridSearchCV</span><span class="crayon-sy">(</span><span class="crayon-v">estimator</span><span class="crayon-o">=</span><span class="crayon-v">model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">param_grid</span><span class="crayon-o">=</span><span class="crayon-v">param_grid</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_jobs</span><span class="crayon-o">=</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36bfe143618976-34"><span class="crayon-v">grid_result</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">grid</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">Y</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5cf4a8ee36bfe143618976-35"><span class="crayon-p"># summarize results</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36bfe143618976-36"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">"Best: %f using %s"</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">grid_result</span><span class="crayon-sy">.</span><span class="crayon-v">best_score_</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">grid_result</span><span class="crayon-sy">.</span><span class="crayon-v">best_params_</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5cf4a8ee36bfe143618976-37"><span class="crayon-v">means</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">grid_result</span><span class="crayon-sy">.</span><span class="crayon-v">cv_results_</span><span class="crayon-sy">[</span><span class="crayon-s">'mean_test_score'</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36bfe143618976-38"><span class="crayon-v">stds</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">grid_result</span><span class="crayon-sy">.</span><span class="crayon-v">cv_results_</span><span class="crayon-sy">[</span><span class="crayon-s">'std_test_score'</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5cf4a8ee36bfe143618976-39"><span class="crayon-v">params</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">grid_result</span><span class="crayon-sy">.</span><span class="crayon-v">cv_results_</span><span class="crayon-sy">[</span><span class="crayon-s">'params'</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36bfe143618976-40"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-v">mean</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">stdev</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">param </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">zip</span><span class="crayon-sy">(</span><span class="crayon-v">means</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">stds</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">params</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5cf4a8ee36bfe143618976-41"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">"%f (%f) with: %r"</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">mean</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">stdev</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">param</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0046 seconds] -->
<p>Running this example produces the following output.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5cf4a8ee36c01085455787" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="readonly" style="-moz-tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;" wrap="soft">Best: 0.723958 using {'dropout_rate': 0.2, 'weight_constraint': 4}
0.696615 (0.031948) with: {'dropout_rate': 0.0, 'weight_constraint': 1}
0.696615 (0.031948) with: {'dropout_rate': 0.0, 'weight_constraint': 2}
0.691406 (0.026107) with: {'dropout_rate': 0.0, 'weight_constraint': 3}
0.708333 (0.009744) with: {'dropout_rate': 0.0, 'weight_constraint': 4}
0.708333 (0.009744) with: {'dropout_rate': 0.0, 'weight_constraint': 5}
0.710937 (0.008438) with: {'dropout_rate': 0.1, 'weight_constraint': 1}
0.709635 (0.007366) with: {'dropout_rate': 0.1, 'weight_constraint': 2}
0.709635 (0.007366) with: {'dropout_rate': 0.1, 'weight_constraint': 3}
0.695312 (0.012758) with: {'dropout_rate': 0.1, 'weight_constraint': 4}
0.695312 (0.012758) with: {'dropout_rate': 0.1, 'weight_constraint': 5}
0.701823 (0.017566) with: {'dropout_rate': 0.2, 'weight_constraint': 1}
0.710938 (0.009568) with: {'dropout_rate': 0.2, 'weight_constraint': 2}
0.710938 (0.009568) with: {'dropout_rate': 0.2, 'weight_constraint': 3}
0.723958 (0.027126) with: {'dropout_rate': 0.2, 'weight_constraint': 4}
0.718750 (0.030425) with: {'dropout_rate': 0.2, 'weight_constraint': 5}
0.721354 (0.032734) with: {'dropout_rate': 0.3, 'weight_constraint': 1}
0.707031 (0.036782) with: {'dropout_rate': 0.3, 'weight_constraint': 2}
0.707031 (0.036782) with: {'dropout_rate': 0.3, 'weight_constraint': 3}
0.694010 (0.019225) with: {'dropout_rate': 0.3, 'weight_constraint': 4}
0.709635 (0.006639) with: {'dropout_rate': 0.3, 'weight_constraint': 5}
0.704427 (0.008027) with: {'dropout_rate': 0.4, 'weight_constraint': 1}
0.717448 (0.031304) with: {'dropout_rate': 0.4, 'weight_constraint': 2}
0.718750 (0.030425) with: {'dropout_rate': 0.4, 'weight_constraint': 3}
0.718750 (0.030425) with: {'dropout_rate': 0.4, 'weight_constraint': 4}
0.722656 (0.029232) with: {'dropout_rate': 0.4, 'weight_constraint': 5}
0.720052 (0.028940) with: {'dropout_rate': 0.5, 'weight_constraint': 1}
0.703125 (0.009568) with: {'dropout_rate': 0.5, 'weight_constraint': 2}
0.716146 (0.029635) with: {'dropout_rate': 0.5, 'weight_constraint': 3}
0.709635 (0.008027) with: {'dropout_rate': 0.5, 'weight_constraint': 4}
0.703125 (0.011500) with: {'dropout_rate': 0.5, 'weight_constraint': 5}
0.707031 (0.017758) with: {'dropout_rate': 0.6, 'weight_constraint': 1}
0.701823 (0.018688) with: {'dropout_rate': 0.6, 'weight_constraint': 2}
0.701823 (0.018688) with: {'dropout_rate': 0.6, 'weight_constraint': 3}
0.690104 (0.027498) with: {'dropout_rate': 0.6, 'weight_constraint': 4}
0.695313 (0.022326) with: {'dropout_rate': 0.6, 'weight_constraint': 5}
0.697917 (0.014382) with: {'dropout_rate': 0.7, 'weight_constraint': 1}
0.697917 (0.014382) with: {'dropout_rate': 0.7, 'weight_constraint': 2}
0.687500 (0.008438) with: {'dropout_rate': 0.7, 'weight_constraint': 3}
0.704427 (0.011201) with: {'dropout_rate': 0.7, 'weight_constraint': 4}
0.696615 (0.016367) with: {'dropout_rate': 0.7, 'weight_constraint': 5}
0.680990 (0.025780) with: {'dropout_rate': 0.8, 'weight_constraint': 1}
0.699219 (0.019401) with: {'dropout_rate': 0.8, 'weight_constraint': 2}
0.701823 (0.015733) with: {'dropout_rate': 0.8, 'weight_constraint': 3}
0.684896 (0.023510) with: {'dropout_rate': 0.8, 'weight_constraint': 4}
0.696615 (0.017566) with: {'dropout_rate': 0.8, 'weight_constraint': 5}
0.653646 (0.034104) with: {'dropout_rate': 0.9, 'weight_constraint': 1}
0.677083 (0.012075) with: {'dropout_rate': 0.9, 'weight_constraint': 2}
0.679688 (0.013902) with: {'dropout_rate': 0.9, 'weight_constraint': 3}
0.669271 (0.017566) with: {'dropout_rate': 0.9, 'weight_constraint': 4}
0.669271 (0.012075) with: {'dropout_rate': 0.9, 'weight_constraint': 5}</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5cf4a8ee36c01085455787-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36c01085455787-2">2</div><div class="crayon-num" data-line="crayon-5cf4a8ee36c01085455787-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36c01085455787-4">4</div><div class="crayon-num" data-line="crayon-5cf4a8ee36c01085455787-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36c01085455787-6">6</div><div class="crayon-num" data-line="crayon-5cf4a8ee36c01085455787-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36c01085455787-8">8</div><div class="crayon-num" data-line="crayon-5cf4a8ee36c01085455787-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36c01085455787-10">10</div><div class="crayon-num" data-line="crayon-5cf4a8ee36c01085455787-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36c01085455787-12">12</div><div class="crayon-num" data-line="crayon-5cf4a8ee36c01085455787-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36c01085455787-14">14</div><div class="crayon-num" data-line="crayon-5cf4a8ee36c01085455787-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36c01085455787-16">16</div><div class="crayon-num" data-line="crayon-5cf4a8ee36c01085455787-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36c01085455787-18">18</div><div class="crayon-num" data-line="crayon-5cf4a8ee36c01085455787-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36c01085455787-20">20</div><div class="crayon-num" data-line="crayon-5cf4a8ee36c01085455787-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36c01085455787-22">22</div><div class="crayon-num" data-line="crayon-5cf4a8ee36c01085455787-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36c01085455787-24">24</div><div class="crayon-num" data-line="crayon-5cf4a8ee36c01085455787-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36c01085455787-26">26</div><div class="crayon-num" data-line="crayon-5cf4a8ee36c01085455787-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36c01085455787-28">28</div><div class="crayon-num" data-line="crayon-5cf4a8ee36c01085455787-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36c01085455787-30">30</div><div class="crayon-num" data-line="crayon-5cf4a8ee36c01085455787-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36c01085455787-32">32</div><div class="crayon-num" data-line="crayon-5cf4a8ee36c01085455787-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36c01085455787-34">34</div><div class="crayon-num" data-line="crayon-5cf4a8ee36c01085455787-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36c01085455787-36">36</div><div class="crayon-num" data-line="crayon-5cf4a8ee36c01085455787-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36c01085455787-38">38</div><div class="crayon-num" data-line="crayon-5cf4a8ee36c01085455787-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36c01085455787-40">40</div><div class="crayon-num" data-line="crayon-5cf4a8ee36c01085455787-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36c01085455787-42">42</div><div class="crayon-num" data-line="crayon-5cf4a8ee36c01085455787-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36c01085455787-44">44</div><div class="crayon-num" data-line="crayon-5cf4a8ee36c01085455787-45">45</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36c01085455787-46">46</div><div class="crayon-num" data-line="crayon-5cf4a8ee36c01085455787-47">47</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36c01085455787-48">48</div><div class="crayon-num" data-line="crayon-5cf4a8ee36c01085455787-49">49</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36c01085455787-50">50</div><div class="crayon-num" data-line="crayon-5cf4a8ee36c01085455787-51">51</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5cf4a8ee36c01085455787-1">Best: 0.723958 using {'dropout_rate': 0.2, 'weight_constraint': 4}</div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36c01085455787-2">0.696615 (0.031948) with: {'dropout_rate': 0.0, 'weight_constraint': 1}</div><div class="crayon-line" id="crayon-5cf4a8ee36c01085455787-3">0.696615 (0.031948) with: {'dropout_rate': 0.0, 'weight_constraint': 2}</div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36c01085455787-4">0.691406 (0.026107) with: {'dropout_rate': 0.0, 'weight_constraint': 3}</div><div class="crayon-line" id="crayon-5cf4a8ee36c01085455787-5">0.708333 (0.009744) with: {'dropout_rate': 0.0, 'weight_constraint': 4}</div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36c01085455787-6">0.708333 (0.009744) with: {'dropout_rate': 0.0, 'weight_constraint': 5}</div><div class="crayon-line" id="crayon-5cf4a8ee36c01085455787-7">0.710937 (0.008438) with: {'dropout_rate': 0.1, 'weight_constraint': 1}</div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36c01085455787-8">0.709635 (0.007366) with: {'dropout_rate': 0.1, 'weight_constraint': 2}</div><div class="crayon-line" id="crayon-5cf4a8ee36c01085455787-9">0.709635 (0.007366) with: {'dropout_rate': 0.1, 'weight_constraint': 3}</div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36c01085455787-10">0.695312 (0.012758) with: {'dropout_rate': 0.1, 'weight_constraint': 4}</div><div class="crayon-line" id="crayon-5cf4a8ee36c01085455787-11">0.695312 (0.012758) with: {'dropout_rate': 0.1, 'weight_constraint': 5}</div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36c01085455787-12">0.701823 (0.017566) with: {'dropout_rate': 0.2, 'weight_constraint': 1}</div><div class="crayon-line" id="crayon-5cf4a8ee36c01085455787-13">0.710938 (0.009568) with: {'dropout_rate': 0.2, 'weight_constraint': 2}</div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36c01085455787-14">0.710938 (0.009568) with: {'dropout_rate': 0.2, 'weight_constraint': 3}</div><div class="crayon-line" id="crayon-5cf4a8ee36c01085455787-15">0.723958 (0.027126) with: {'dropout_rate': 0.2, 'weight_constraint': 4}</div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36c01085455787-16">0.718750 (0.030425) with: {'dropout_rate': 0.2, 'weight_constraint': 5}</div><div class="crayon-line" id="crayon-5cf4a8ee36c01085455787-17">0.721354 (0.032734) with: {'dropout_rate': 0.3, 'weight_constraint': 1}</div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36c01085455787-18">0.707031 (0.036782) with: {'dropout_rate': 0.3, 'weight_constraint': 2}</div><div class="crayon-line" id="crayon-5cf4a8ee36c01085455787-19">0.707031 (0.036782) with: {'dropout_rate': 0.3, 'weight_constraint': 3}</div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36c01085455787-20">0.694010 (0.019225) with: {'dropout_rate': 0.3, 'weight_constraint': 4}</div><div class="crayon-line" id="crayon-5cf4a8ee36c01085455787-21">0.709635 (0.006639) with: {'dropout_rate': 0.3, 'weight_constraint': 5}</div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36c01085455787-22">0.704427 (0.008027) with: {'dropout_rate': 0.4, 'weight_constraint': 1}</div><div class="crayon-line" id="crayon-5cf4a8ee36c01085455787-23">0.717448 (0.031304) with: {'dropout_rate': 0.4, 'weight_constraint': 2}</div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36c01085455787-24">0.718750 (0.030425) with: {'dropout_rate': 0.4, 'weight_constraint': 3}</div><div class="crayon-line" id="crayon-5cf4a8ee36c01085455787-25">0.718750 (0.030425) with: {'dropout_rate': 0.4, 'weight_constraint': 4}</div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36c01085455787-26">0.722656 (0.029232) with: {'dropout_rate': 0.4, 'weight_constraint': 5}</div><div class="crayon-line" id="crayon-5cf4a8ee36c01085455787-27">0.720052 (0.028940) with: {'dropout_rate': 0.5, 'weight_constraint': 1}</div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36c01085455787-28">0.703125 (0.009568) with: {'dropout_rate': 0.5, 'weight_constraint': 2}</div><div class="crayon-line" id="crayon-5cf4a8ee36c01085455787-29">0.716146 (0.029635) with: {'dropout_rate': 0.5, 'weight_constraint': 3}</div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36c01085455787-30">0.709635 (0.008027) with: {'dropout_rate': 0.5, 'weight_constraint': 4}</div><div class="crayon-line" id="crayon-5cf4a8ee36c01085455787-31">0.703125 (0.011500) with: {'dropout_rate': 0.5, 'weight_constraint': 5}</div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36c01085455787-32">0.707031 (0.017758) with: {'dropout_rate': 0.6, 'weight_constraint': 1}</div><div class="crayon-line" id="crayon-5cf4a8ee36c01085455787-33">0.701823 (0.018688) with: {'dropout_rate': 0.6, 'weight_constraint': 2}</div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36c01085455787-34">0.701823 (0.018688) with: {'dropout_rate': 0.6, 'weight_constraint': 3}</div><div class="crayon-line" id="crayon-5cf4a8ee36c01085455787-35">0.690104 (0.027498) with: {'dropout_rate': 0.6, 'weight_constraint': 4}</div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36c01085455787-36">0.695313 (0.022326) with: {'dropout_rate': 0.6, 'weight_constraint': 5}</div><div class="crayon-line" id="crayon-5cf4a8ee36c01085455787-37">0.697917 (0.014382) with: {'dropout_rate': 0.7, 'weight_constraint': 1}</div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36c01085455787-38">0.697917 (0.014382) with: {'dropout_rate': 0.7, 'weight_constraint': 2}</div><div class="crayon-line" id="crayon-5cf4a8ee36c01085455787-39">0.687500 (0.008438) with: {'dropout_rate': 0.7, 'weight_constraint': 3}</div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36c01085455787-40">0.704427 (0.011201) with: {'dropout_rate': 0.7, 'weight_constraint': 4}</div><div class="crayon-line" id="crayon-5cf4a8ee36c01085455787-41">0.696615 (0.016367) with: {'dropout_rate': 0.7, 'weight_constraint': 5}</div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36c01085455787-42">0.680990 (0.025780) with: {'dropout_rate': 0.8, 'weight_constraint': 1}</div><div class="crayon-line" id="crayon-5cf4a8ee36c01085455787-43">0.699219 (0.019401) with: {'dropout_rate': 0.8, 'weight_constraint': 2}</div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36c01085455787-44">0.701823 (0.015733) with: {'dropout_rate': 0.8, 'weight_constraint': 3}</div><div class="crayon-line" id="crayon-5cf4a8ee36c01085455787-45">0.684896 (0.023510) with: {'dropout_rate': 0.8, 'weight_constraint': 4}</div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36c01085455787-46">0.696615 (0.017566) with: {'dropout_rate': 0.8, 'weight_constraint': 5}</div><div class="crayon-line" id="crayon-5cf4a8ee36c01085455787-47">0.653646 (0.034104) with: {'dropout_rate': 0.9, 'weight_constraint': 1}</div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36c01085455787-48">0.677083 (0.012075) with: {'dropout_rate': 0.9, 'weight_constraint': 2}</div><div class="crayon-line" id="crayon-5cf4a8ee36c01085455787-49">0.679688 (0.013902) with: {'dropout_rate': 0.9, 'weight_constraint': 3}</div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36c01085455787-50">0.669271 (0.017566) with: {'dropout_rate': 0.9, 'weight_constraint': 4}</div><div class="crayon-line" id="crayon-5cf4a8ee36c01085455787-51">0.669271 (0.012075) with: {'dropout_rate': 0.9, 'weight_constraint': 5}</div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>We can see that the dropout rate of 20% and the maxnorm weight constraint of 4 resulted in the best accuracy of about 72%.</p>
<h2>How to Tune the Number of Neurons in the Hidden Layer</h2>
<p>The number of neurons in a layer is an important parameter to tune. 
Generally the number of neurons in a layer controls the representational
 capacity of the network, at least at that point in the topology.</p>
<p>Also, generally, a large enough single layer network can approximate any other neural network, <a href="https://en.wikipedia.org/wiki/Universal_approximation_theorem">at least in theory</a>.</p>
<p>In this example, we will look at tuning the number of neurons in a 
single hidden layer. We will try values from 1 to 30 in steps of 5.</p>
<p>A larger network requires more training and at least the batch size 
and number of epochs should ideally be optimized with the number of 
neurons.</p>
<p>The full code listing is provided below.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5cf4a8ee36c06712190576" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="readonly" style="-moz-tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;" wrap="soft"># Use scikit-learn to grid search the number of neurons
import numpy
from sklearn.model_selection import GridSearchCV
from keras.models import Sequential
from keras.layers import Dense
from keras.layers import Dropout
from keras.wrappers.scikit_learn import KerasClassifier
from keras.constraints import maxnorm
# Function to create model, required for KerasClassifier
def create_model(neurons=1):
	# create model
	model = Sequential()
	model.add(Dense(neurons, input_dim=8, kernel_initializer='uniform', activation='linear', kernel_constraint=maxnorm(4)))
	model.add(Dropout(0.2))
	model.add(Dense(1, kernel_initializer='uniform', activation='sigmoid'))
	# Compile model
	model.compile(loss='binary_crossentropy', optimizer='adam', metrics=['accuracy'])
	return model
# fix random seed for reproducibility
seed = 7
numpy.random.seed(seed)
# load dataset
dataset = numpy.loadtxt("pima-indians-diabetes.csv", delimiter=",")
# split into input (X) and output (Y) variables
X = dataset[:,0:8]
Y = dataset[:,8]
# create model
model = KerasClassifier(build_fn=create_model, epochs=100, batch_size=10, verbose=0)
# define the grid search parameters
neurons = [1, 5, 10, 15, 20, 25, 30]
param_grid = dict(neurons=neurons)
grid = GridSearchCV(estimator=model, param_grid=param_grid, n_jobs=-1)
grid_result = grid.fit(X, Y)
# summarize results
print("Best: %f using %s" % (grid_result.best_score_, grid_result.best_params_))
means = grid_result.cv_results_['mean_test_score']
stds = grid_result.cv_results_['std_test_score']
params = grid_result.cv_results_['params']
for mean, stdev, param in zip(means, stds, params):
    print("%f (%f) with: %r" % (mean, stdev, param))</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5cf4a8ee36c06712190576-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36c06712190576-2">2</div><div class="crayon-num" data-line="crayon-5cf4a8ee36c06712190576-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36c06712190576-4">4</div><div class="crayon-num" data-line="crayon-5cf4a8ee36c06712190576-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36c06712190576-6">6</div><div class="crayon-num" data-line="crayon-5cf4a8ee36c06712190576-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36c06712190576-8">8</div><div class="crayon-num" data-line="crayon-5cf4a8ee36c06712190576-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36c06712190576-10">10</div><div class="crayon-num" data-line="crayon-5cf4a8ee36c06712190576-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36c06712190576-12">12</div><div class="crayon-num" data-line="crayon-5cf4a8ee36c06712190576-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36c06712190576-14">14</div><div class="crayon-num" data-line="crayon-5cf4a8ee36c06712190576-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36c06712190576-16">16</div><div class="crayon-num" data-line="crayon-5cf4a8ee36c06712190576-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36c06712190576-18">18</div><div class="crayon-num" data-line="crayon-5cf4a8ee36c06712190576-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36c06712190576-20">20</div><div class="crayon-num" data-line="crayon-5cf4a8ee36c06712190576-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36c06712190576-22">22</div><div class="crayon-num" data-line="crayon-5cf4a8ee36c06712190576-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36c06712190576-24">24</div><div class="crayon-num" data-line="crayon-5cf4a8ee36c06712190576-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36c06712190576-26">26</div><div class="crayon-num" data-line="crayon-5cf4a8ee36c06712190576-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36c06712190576-28">28</div><div class="crayon-num" data-line="crayon-5cf4a8ee36c06712190576-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36c06712190576-30">30</div><div class="crayon-num" data-line="crayon-5cf4a8ee36c06712190576-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36c06712190576-32">32</div><div class="crayon-num" data-line="crayon-5cf4a8ee36c06712190576-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36c06712190576-34">34</div><div class="crayon-num" data-line="crayon-5cf4a8ee36c06712190576-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36c06712190576-36">36</div><div class="crayon-num" data-line="crayon-5cf4a8ee36c06712190576-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36c06712190576-38">38</div><div class="crayon-num" data-line="crayon-5cf4a8ee36c06712190576-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36c06712190576-40">40</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5cf4a8ee36c06712190576-1"><span class="crayon-p"># Use scikit-learn to grid search the number of neurons</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36c06712190576-2"><span class="crayon-e">import </span><span class="crayon-e">numpy</span></div><div class="crayon-line" id="crayon-5cf4a8ee36c06712190576-3"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">model_selection </span><span class="crayon-e">import </span><span class="crayon-e">GridSearchCV</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36c06712190576-4"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">models </span><span class="crayon-e">import </span><span class="crayon-e">Sequential</span></div><div class="crayon-line" id="crayon-5cf4a8ee36c06712190576-5"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Dense</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36c06712190576-6"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Dropout</span></div><div class="crayon-line" id="crayon-5cf4a8ee36c06712190576-7"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-v">wrappers</span><span class="crayon-sy">.</span><span class="crayon-e">scikit_learn </span><span class="crayon-e">import </span><span class="crayon-e">KerasClassifier</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36c06712190576-8"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">constraints </span><span class="crayon-e">import </span><span class="crayon-v">maxnorm</span></div><div class="crayon-line" id="crayon-5cf4a8ee36c06712190576-9"><span class="crayon-p"># Function to create model, required for KerasClassifier</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36c06712190576-10"><span class="crayon-e">def </span><span class="crayon-e">create_model</span><span class="crayon-sy">(</span><span class="crayon-v">neurons</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5cf4a8ee36c06712190576-11"><span class="crayon-h">	</span><span class="crayon-p"># create model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36c06712190576-12"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Sequential</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5cf4a8ee36c06712190576-13"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-v">neurons</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">input_dim</span><span class="crayon-o">=</span><span class="crayon-cn">8</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kernel_initializer</span><span class="crayon-o">=</span><span class="crayon-s">'uniform'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'linear'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kernel_constraint</span><span class="crayon-o">=</span><span class="crayon-e">maxnorm</span><span class="crayon-sy">(</span><span class="crayon-cn">4</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36c06712190576-14"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dropout</span><span class="crayon-sy">(</span><span class="crayon-cn">0.2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5cf4a8ee36c06712190576-15"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kernel_initializer</span><span class="crayon-o">=</span><span class="crayon-s">'uniform'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'sigmoid'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36c06712190576-16"><span class="crayon-h">	</span><span class="crayon-p"># Compile model</span></div><div class="crayon-line" id="crayon-5cf4a8ee36c06712190576-17"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">compile</span><span class="crayon-sy">(</span><span class="crayon-v">loss</span><span class="crayon-o">=</span><span class="crayon-s">'binary_crossentropy'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">optimizer</span><span class="crayon-o">=</span><span class="crayon-s">'adam'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">metrics</span><span class="crayon-o">=</span><span class="crayon-sy">[</span><span class="crayon-s">'accuracy'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36c06712190576-18"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">model</span></div><div class="crayon-line" id="crayon-5cf4a8ee36c06712190576-19"><span class="crayon-p"># fix random seed for reproducibility</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36c06712190576-20"><span class="crayon-v">seed</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">7</span></div><div class="crayon-line" id="crayon-5cf4a8ee36c06712190576-21"><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-v">random</span><span class="crayon-sy">.</span><span class="crayon-e">seed</span><span class="crayon-sy">(</span><span class="crayon-v">seed</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36c06712190576-22"><span class="crayon-p"># load dataset</span></div><div class="crayon-line" id="crayon-5cf4a8ee36c06712190576-23"><span class="crayon-v">dataset</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">numpy</span><span class="crayon-sy">.</span><span class="crayon-e">loadtxt</span><span class="crayon-sy">(</span><span class="crayon-s">"pima-indians-diabetes.csv"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">delimiter</span><span class="crayon-o">=</span><span class="crayon-s">","</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36c06712190576-24"><span class="crayon-p"># split into input (X) and output (Y) variables</span></div><div class="crayon-line" id="crayon-5cf4a8ee36c06712190576-25"><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-o">:</span><span class="crayon-cn">8</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36c06712190576-26"><span class="crayon-v">Y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-cn">8</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5cf4a8ee36c06712190576-27"><span class="crayon-p"># create model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36c06712190576-28"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">KerasClassifier</span><span class="crayon-sy">(</span><span class="crayon-v">build_fn</span><span class="crayon-o">=</span><span class="crayon-v">create_model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">epochs</span><span class="crayon-o">=</span><span class="crayon-cn">100</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">batch_size</span><span class="crayon-o">=</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5cf4a8ee36c06712190576-29"><span class="crayon-p"># define the grid search parameters</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36c06712190576-30"><span class="crayon-v">neurons</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">5</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">15</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">20</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">25</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">30</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5cf4a8ee36c06712190576-31"><span class="crayon-v">param_grid</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">dict</span><span class="crayon-sy">(</span><span class="crayon-v">neurons</span><span class="crayon-o">=</span><span class="crayon-v">neurons</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36c06712190576-32"><span class="crayon-v">grid</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">GridSearchCV</span><span class="crayon-sy">(</span><span class="crayon-v">estimator</span><span class="crayon-o">=</span><span class="crayon-v">model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">param_grid</span><span class="crayon-o">=</span><span class="crayon-v">param_grid</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_jobs</span><span class="crayon-o">=</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5cf4a8ee36c06712190576-33"><span class="crayon-v">grid_result</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">grid</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">Y</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36c06712190576-34"><span class="crayon-p"># summarize results</span></div><div class="crayon-line" id="crayon-5cf4a8ee36c06712190576-35"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">"Best: %f using %s"</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">grid_result</span><span class="crayon-sy">.</span><span class="crayon-v">best_score_</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">grid_result</span><span class="crayon-sy">.</span><span class="crayon-v">best_params_</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36c06712190576-36"><span class="crayon-v">means</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">grid_result</span><span class="crayon-sy">.</span><span class="crayon-v">cv_results_</span><span class="crayon-sy">[</span><span class="crayon-s">'mean_test_score'</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5cf4a8ee36c06712190576-37"><span class="crayon-v">stds</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">grid_result</span><span class="crayon-sy">.</span><span class="crayon-v">cv_results_</span><span class="crayon-sy">[</span><span class="crayon-s">'std_test_score'</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36c06712190576-38"><span class="crayon-v">params</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">grid_result</span><span class="crayon-sy">.</span><span class="crayon-v">cv_results_</span><span class="crayon-sy">[</span><span class="crayon-s">'params'</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5cf4a8ee36c06712190576-39"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-v">mean</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">stdev</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">param </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">zip</span><span class="crayon-sy">(</span><span class="crayon-v">means</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">stds</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">params</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36c06712190576-40"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">"%f (%f) with: %r"</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">mean</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">stdev</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">param</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0038 seconds] -->
<p>Running this example produces the following output.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5cf4a8ee36c0b947318483" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="readonly" style="-moz-tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;" wrap="soft">Best: 0.714844 using {'neurons': 5}
0.700521 (0.011201) with: {'neurons': 1}
0.714844 (0.011049) with: {'neurons': 5}
0.712240 (0.017566) with: {'neurons': 10}
0.705729 (0.003683) with: {'neurons': 15}
0.696615 (0.020752) with: {'neurons': 20}
0.713542 (0.025976) with: {'neurons': 25}
0.705729 (0.008027) with: {'neurons': 30}</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5cf4a8ee36c0b947318483-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36c0b947318483-2">2</div><div class="crayon-num" data-line="crayon-5cf4a8ee36c0b947318483-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36c0b947318483-4">4</div><div class="crayon-num" data-line="crayon-5cf4a8ee36c0b947318483-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36c0b947318483-6">6</div><div class="crayon-num" data-line="crayon-5cf4a8ee36c0b947318483-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee36c0b947318483-8">8</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5cf4a8ee36c0b947318483-1">Best: 0.714844 using {'neurons': 5}</div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36c0b947318483-2">0.700521 (0.011201) with: {'neurons': 1}</div><div class="crayon-line" id="crayon-5cf4a8ee36c0b947318483-3">0.714844 (0.011049) with: {'neurons': 5}</div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36c0b947318483-4">0.712240 (0.017566) with: {'neurons': 10}</div><div class="crayon-line" id="crayon-5cf4a8ee36c0b947318483-5">0.705729 (0.003683) with: {'neurons': 15}</div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36c0b947318483-6">0.696615 (0.020752) with: {'neurons': 20}</div><div class="crayon-line" id="crayon-5cf4a8ee36c0b947318483-7">0.713542 (0.025976) with: {'neurons': 25}</div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee36c0b947318483-8">0.705729 (0.008027) with: {'neurons': 30}</div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>We can see that the best results were achieved with a network with 5 
neurons in the hidden layer with&nbsp;an accuracy of about 71%.</p>
<h2>Tips for Hyperparameter&nbsp;Optimization</h2>
<p>This section lists some handy tips to consider when tuning hyperparameters of your&nbsp;neural network.</p>
<ul>
<li><strong>k-fold Cross Validation</strong>. You can see that the 
results from the examples in this post show some variance. A default 
cross-validation of 3 was used, but perhaps k=5 or k=10 would be more 
stable. Carefully choose your cross validation configuration to ensure 
your results are stable.</li>
<li><strong>Review the Whole Grid</strong>. Do not just focus on the best result, review the whole grid of results and look for trends to support configuration decisions.</li>
<li><strong>Parallelize</strong>. Use all your cores if you can, neural 
networks are slow to train and we often want to try a lot of different 
parameters. Consider spinning up a lot of <a href="http://machinelearningmastery.com/develop-evaluate-large-deep-learning-models-keras-amazon-web-services/">AWS instances</a>.</li>
<li><strong>Use a Sample of Your Dataset</strong>. Because networks are 
slow to train, try training them on a smaller sample of your training 
dataset, just to get an idea of general directions of parameters rather 
than optimal configurations.</li>
<li><strong>Start with Coarse Grids</strong>. Start with coarse-grained grids and zoom into finer grained grids once you can narrow the scope.</li>
<li><strong>Do not Transfer Results</strong>. Results are generally 
problem specific. Try to avoid favorite configurations on each new 
problem that you see. It is unlikely that optimal results you discover 
on one problem will transfer to your next project. Instead look for 
broader trends like number of layers or relationships between 
parameters.</li>
<li><strong>Reproducibility&nbsp;is a Problem</strong>. Although 
we&nbsp;set the&nbsp;seed for the random number generator in NumPy, the 
results are not 100% reproducible. There is&nbsp;more to reproducibility
 when grid searching wrapped&nbsp;Keras models than is presented in this
 post.</li>
</ul>
<h2>Summary</h2>
<p>In this post, you discovered how you can tune the hyperparameters of 
your deep learning networks in Python using Keras and scikit-learn.</p>
<p>Specifically, you learned:</p>
<ul>
<li>How to wrap Keras models for use in scikit-learn and how to use grid search.</li>
<li>How to grid search a suite of different standard neural network parameters for Keras models.</li>
<li>How to design your own hyperparameter optimization experiments.</li>
</ul>
<p>Do you have any&nbsp;experience tuning&nbsp;hyperparameters of large neural networks?&nbsp;Please share your stories below.</p>
<p>Do you have any questions about hyperparameter optimization of neural
 networks or about this post? Ask your questions in the comments and I 
will do my best to answer.</p>
<!-- Shortcoder conditions not met -->
<div class="awac-wrapper"><div class="awac widget text-35">			<div class="textwidget"><div class="woo-sc-hr"></div>
<h2 style="text-align: center;">Frustrated With Your Progress In Deep Learning?</h2>
<p><a href="https://machinelearningmastery.com/deep-learning-with-python/"><img style="border: 0;" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/DeepLearningWithPython-220.png" alt="Deep Learning with Python" align="left"></a></p>
<h4 style="text-align: center;">&nbsp;What If You Could Develop A Network in Minutes</h4>
<p style="text-align: center;">…with just a few lines of Python</p>
<p style="text-align: center;">Discover how in my new Ebook: <a href="https://machinelearningmastery.com/deep-learning-with-python/">Deep Learning With Python</a></p>
<p style="text-align: center;">It covers <strong>self-study tutorials</strong> and <strong>end-to-end projects</strong> on topics like:<br>
<em>Multilayer Perceptrons</em>,&nbsp;<em>Convolutional Nets</em> and&nbsp;<em>Recurrent Neural Nets</em>, and more…</p>
<h4 style="text-align: center;">Finally Bring Deep Learning To<br>
Your Own Projects</h4>
<p style="text-align: center;">Skip the Academics. Just&nbsp;Results.</p>
<p style="text-align: center;"><a href="https://machinelearningmastery.com/deep-learning-with-python/">Click to&nbsp;learn more</a>.</p>
<div class="woo-sc-hr"></div>
</div>
		</div></div><div class="simplesocialbuttons simplesocial-simple-icons simplesocialbuttons_inline simplesocialbuttons-align-left post-2967 post  simplesocialbuttons-inline-no-animation simplesocialbuttons-inline-in">
<button class="ssb_tweet-icon" data-href="https://twitter.com/share?text=How+to+Grid+Search+Hyperparameters+for+Deep+Learning+Models+in+Python+With+Keras&amp;url=https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/" rel="nofollow" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;">
						<span class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 72 72"><path fill="none" d="M0 0h72v72H0z"></path><path class="icon" fill="#fff" d="M68.812 15.14c-2.348 1.04-4.87 1.744-7.52 2.06 2.704-1.62 4.78-4.186 5.757-7.243-2.53 1.5-5.33 2.592-8.314 3.176C56.35 10.59 52.948 9 49.182 9c-7.23 0-13.092 5.86-13.092 13.093 0 1.026.118 2.02.338 2.98C25.543 24.527 15.9 19.318 9.44 11.396c-1.125 1.936-1.77 4.184-1.77 6.58 0 4.543 2.312 8.552 5.824 10.9-2.146-.07-4.165-.658-5.93-1.64-.002.056-.002.11-.002.163 0 6.345 4.513 11.638 10.504 12.84-1.1.298-2.256.457-3.45.457-.845 0-1.666-.078-2.464-.23 1.667 5.2 6.5 8.985 12.23 9.09-4.482 3.51-10.13 5.605-16.26 5.605-1.055 0-2.096-.06-3.122-.184 5.794 3.717 12.676 5.882 20.067 5.882 24.083 0 37.25-19.95 37.25-37.25 0-.565-.013-1.133-.038-1.693 2.558-1.847 4.778-4.15 6.532-6.774z"></path></svg></span><i class="simplesocialtxt">Tweet </i></button>
		<button class="ssb_fbshare-icon" target="_blank" data-href="https://www.facebook.com/sharer/sharer.php?u=https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;">
						<span class="icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" class="_1pbq" color="#ffffff"><path fill="#ffffff" fill-rule="evenodd" class="icon" d="M8 14H3.667C2.733 13.9 2 13.167 2 12.233V3.667A1.65 1.65 0 0 1 3.667 2h8.666A1.65 1.65 0 0 1 14 3.667v8.566c0 .934-.733 1.667-1.667 1.767H10v-3.967h1.3l.7-2.066h-2V6.933c0-.466.167-.9.867-.9H12v-1.8c.033 0-.933-.266-1.533-.266-1.267 0-2.434.7-2.467 2.133v1.867H6v2.066h2V14z"></path></svg></span>
						<span class="simplesocialtxt">Share </span> </button>
<button class="ssb_linkedin-icon" data-href="https://www.linkedin.com/cws/share?url=https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/" onclick="javascript:window.open(this.dataset.href, '', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');return false;">
						<span class="icon"> <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="15px" height="14.1px" viewBox="-301.4 387.5 15 14.1" enable-background="new -301.4 387.5 15 14.1" xml:space="preserve"> <g id="XMLID_398_"> <path id="XMLID_399_" fill="#FFFFFF" d="M-296.2,401.6c0-3.2,0-6.3,0-9.5h0.1c1,0,2,0,2.9,0c0.1,0,0.1,0,0.1,0.1c0,0.4,0,0.8,0,1.2 c0.1-0.1,0.2-0.3,0.3-0.4c0.5-0.7,1.2-1,2.1-1.1c0.8-0.1,1.5,0,2.2,0.3c0.7,0.4,1.2,0.8,1.5,1.4c0.4,0.8,0.6,1.7,0.6,2.5 c0,1.8,0,3.6,0,5.4v0.1c-1.1,0-2.1,0-3.2,0c0-0.1,0-0.1,0-0.2c0-1.6,0-3.2,0-4.8c0-0.4,0-0.8-0.2-1.2c-0.2-0.7-0.8-1-1.6-1 c-0.8,0.1-1.3,0.5-1.6,1.2c-0.1,0.2-0.1,0.5-0.1,0.8c0,1.7,0,3.4,0,5.1c0,0.2,0,0.2-0.2,0.2c-1,0-1.9,0-2.9,0 C-296.1,401.6-296.2,401.6-296.2,401.6z"></path> <path id="XMLID_400_" fill="#FFFFFF" d="M-298,401.6L-298,401.6c-1.1,0-2.1,0-3,0c-0.1,0-0.1,0-0.1-0.1c0-3.1,0-6.1,0-9.2 c0-0.1,0-0.1,0.1-0.1c1,0,2,0,2.9,0h0.1C-298,395.3-298,398.5-298,401.6z"></path> <path id="XMLID_401_" fill="#FFFFFF" d="M-299.6,390.9c-0.7-0.1-1.2-0.3-1.6-0.8c-0.5-0.8-0.2-2.1,1-2.4c0.6-0.2,1.2-0.1,1.8,0.2 c0.5,0.4,0.7,0.9,0.6,1.5c-0.1,0.7-0.5,1.1-1.1,1.3C-299.1,390.8-299.4,390.8-299.6,390.9L-299.6,390.9z"></path> </g> </svg> </span>
						<span class="simplesocialtxt">Share</span> </button>
</div>
	</section><!-- /.entry -->
	<div class="fix"></div>
<aside id="post-author">
	<div class="profile-image"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=160&amp;d=mm&amp;r=g 2x" class="avatar avatar-80 photo" width="80" height="80"></div>
	<div class="profile-content">
		<h4>About Jason Brownlee</h4>
		Jason Brownlee, PhD is a machine learning specialist who teaches 
developers how to get results with modern machine learning methods via 
hands-on tutorials.				<div class="profile-link">
			<a href="https://machinelearningmastery.com/author/jasonb/">
				View all posts by Jason Brownlee <span class="meta-nav">→</span>			</a>
		</div><!--#profile-link-->
			</div>
	<div class="fix"></div>
</aside>
<div class="post-utility"></div>
</article><!-- /.post -->
	        <div class="post-entries">
	            <div class="nav-prev fl"><a href="https://machinelearningmastery.com/binary-classification-tutorial-weka/" rel="prev"><i class="fa fa-angle-left"></i> How To Work Through a Binary Classification Project in Weka Step-By-Step</a></div>
	            <div class="nav-next fr"><a href="https://machinelearningmastery.com/regression-machine-learning-tutorial-weka/" rel="next">How to Work Through a Regression Machine Learning Project in Weka Step-By-Step <i class="fa fa-angle-right"></i></a></div>
	            <div class="fix"></div>
	        </div>

		<div id="comments">		 	<h3 id="comments-title">483 Responses to <em>How to Grid Search Hyperparameters for Deep Learning Models in Python With Keras</em></h3>
		 	<ol class="commentlist">
				
		<li id="comment-359307" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-359307" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/c8f8f11b6b3109469e56b472672c1c58.jfif" srcset="https://secure.gravatar.com/avatar/c8f8f11b6b3109469e56b472672c1c58?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Yanbo</span>
	                <span class="date">August 9, 2016 at 9:10 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-359307" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>As always excellent post,. I’ve been doing some hyper-parameter 
optimization by hand, but I’ll definitely give Grid Search a try.</p>
<p>Is it possible to set up a different threshold for sigmoid output in 
Keras? Rather then using 0.5 I was thinking of trying 0.7 or 0.8</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-359307" data-commentid="359307" data-postid="2967" data-belowelement="comment-359307" data-respondelement="respond" aria-label="Reply to Yanbo">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-360031" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-360031" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">August 15, 2016 at 11:10 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-360031" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks Yanbo.</p>
<p>I don’t think so, but you could implement your own activation function and do anything you wish.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-360031" data-commentid="360031" data-postid="2967" data-belowelement="comment-360031" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-363652" class="comment even depth-3 parent">

	      	<div id="li-comment-363652" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/e51fe8b7253165eeadfa41b4702c380f.jfif" srcset="https://secure.gravatar.com/avatar/e51fe8b7253165eeadfa41b4702c380f?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Shudhan</span>
	                <span class="date">September 5, 2016 at 6:20 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-363652" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>My question is related to this thread. How to get the 
probablities as the output? I dont want the class output. I read for a 
regression problem that no activation function is needed in the output 
layer. Similiar implementation will get me the probabilities ?? or the 
output will exceed 0 and 1??</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-363652" data-commentid="363652" data-postid="2967" data-belowelement="comment-363652" data-respondelement="respond" aria-label="Reply to Shudhan">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-363738" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4">

	      	<div id="li-comment-363738" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">September 6, 2016 at 9:41 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-363738" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Shudhan, you can use a sigmoid activation and treat the outputs like probabilities (they will be in the range of 0-1).</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-363738" data-commentid="363738" data-postid="2967" data-belowelement="comment-363738" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-418812" class="comment even depth-3 parent">

	      	<div id="li-comment-418812" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/f35441942bd77cee1a9ec158b84e5c09.jfif" srcset="https://secure.gravatar.com/avatar/f35441942bd77cee1a9ec158b84e5c09?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Swapna</span>
	                <span class="date">November 2, 2017 at 11:51 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-418812" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>excellent post</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-418812" data-commentid="418812" data-postid="2967" data-belowelement="comment-418812" data-respondelement="respond" aria-label="Reply to Swapna">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-418838" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4">

	      	<div id="li-comment-418838" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">November 3, 2017 at 5:18 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-418838" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks Swapna.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-418838" data-commentid="418838" data-postid="2967" data-belowelement="comment-418838" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-360388" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-360388" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1738cae1b4041cf595e7be38099f7da9.jfif" srcset="https://secure.gravatar.com/avatar/1738cae1b4041cf595e7be38099f7da9?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">eclipsedu</span>
	                <span class="date">August 18, 2016 at 5:55 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-360388" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sound awesome!Will this grid search method use the full cpu(which can be 8/16 cores) ?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-360388" data-commentid="360388" data-postid="2967" data-belowelement="comment-360388" data-respondelement="respond" aria-label="Reply to eclipsedu">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-360447" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-360447" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">August 19, 2016 at 5:23 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-360447" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>It can if you set n_jobs=-1</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-360447" data-commentid="360447" data-postid="2967" data-belowelement="comment-360447" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-360390" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-360390" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/183d654c855899d35af31497be84b237.jfif" srcset="https://secure.gravatar.com/avatar/183d654c855899d35af31497be84b237?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Reza</span>
	                <span class="date">August 18, 2016 at 6:00 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-360390" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi,<br>
Great post,<br>
Can I use this tips on CNNs in keras as well?<br>
Thanks!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-360390" data-commentid="360390" data-postid="2967" data-belowelement="comment-360390" data-respondelement="respond" aria-label="Reply to Reza">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-360448" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-360448" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">August 19, 2016 at 5:24 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-360448" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>They can be a start, but remember it is a good idea to use a 
repeating structure in a large CNN and you will need to tune the number 
of filters and pool size.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-360448" data-commentid="360448" data-postid="2967" data-belowelement="comment-360448" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-483109" class="comment even depth-3 parent">

	      	<div id="li-comment-483109" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/3a74ea6007fe77df5f4ce609997adef3.jfif" srcset="https://secure.gravatar.com/avatar/3a74ea6007fe77df5f4ce609997adef3?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">maxv</span>
	                <span class="date">April 29, 2019 at 3:30 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-483109" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason thanks for everything.<br>
Could you explain what do you mean by repeatting structure in your reply please ? </p>
<p>Quick question on the GridSearchCV for CNN, param_grid=param_grid 
using the sklearn wrapper gives this error : ”ValueError: filters is not
 a legal parameter ”<br>
How can we use the wrapper for the filters params of Conv1D ?<br>
Thanks</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-483109" data-commentid="483109" data-postid="2967" data-belowelement="comment-483109" data-respondelement="respond" aria-label="Reply to maxv">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-483157" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4">

	      	<div id="li-comment-483157" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">April 29, 2019 at 8:25 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-483157" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, see this post:<br>
<a href="https://machinelearningmastery.com/review-of-architectural-innovations-for-convolutional-neural-networks-for-image-classification/" rel="nofollow">https://machinelearningmastery.com/review-of-architectural-innovations-for-convolutional-neural-networks-for-image-classification/</a></p>
<p>Perhaps try manually grid searching the parametres if you are working
 with time series, so that you can use walk forward validation:<br>
<a href="https://machinelearningmastery.com/how-to-develop-deep-learning-models-for-univariate-time-series-forecasting/" rel="nofollow">https://machinelearningmastery.com/how-to-develop-deep-learning-models-for-univariate-time-series-forecasting/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-483157" data-commentid="483157" data-postid="2967" data-belowelement="comment-483157" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-360975" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-360975" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/b7ef46eaf630fccf793206ef30ceea0c.jfif" srcset="https://secure.gravatar.com/avatar/b7ef46eaf630fccf793206ef30ceea0c?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Prashant</span>
	                <span class="date">August 22, 2016 at 4:55 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-360975" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason, First of all great post! I applied this by dividing the
 data into train and test and used train dataset for grid fit. Plan was 
to capture best parameters in train and apply them on test to see 
accuracy. But it seems grid.fit and model.fit applied with same 
parameters on same dataset (in this case train) give different accuracy 
results. Any idea why this happens. I can share the code if it helps.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-360975" data-commentid="360975" data-postid="2967" data-belowelement="comment-360975" data-respondelement="respond" aria-label="Reply to Prashant">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-361106" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-361106" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">August 23, 2016 at 6:00 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-361106" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You will see small variation in the performance of a neural net 
with the same parameters from run to run. This is because of the 
stochastic nature of the technique and how very hard it is to fix the 
random number seed successfully in python/numpy/theano.</p>
<p>You will also see small variation due to the data used to train the method.</p>
<p>Generally, you could use all of your data to grid search to try to 
reduce the second type of variation (slower). You could store results 
and use statistical significance tests to compare populations of results
 to see if differences are significant to sort out the first type or 
variation.</p>
<p>I hope that helps.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-361106" data-commentid="361106" data-postid="2967" data-belowelement="comment-361106" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-361022" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-361022" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/bb8c9bbf28d4f76b8aaec9b84df53056.jfif" srcset="https://secure.gravatar.com/avatar/bb8c9bbf28d4f76b8aaec9b84df53056?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">vinay</span>
	                <span class="date">August 22, 2016 at 9:05 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-361022" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>hi, I think this will best tutorial i ever found on web….Thanks 
for sharing….is it possible to use these tips on LSTM, Bilstm cnnlstm</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-361022" data-commentid="361022" data-postid="2967" data-belowelement="comment-361022" data-respondelement="respond" aria-label="Reply to vinay">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-361105" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-361105" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">August 23, 2016 at 5:57 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-361105" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks Vinay, I’m glad it’s useful.</p>
<p>Absolutely, you could use these tactics on other algorithm types.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-361105" data-commentid="361105" data-postid="2967" data-belowelement="comment-361105" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-363254" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-363254" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/e51fe8b7253165eeadfa41b4702c380f.jfif" srcset="https://secure.gravatar.com/avatar/e51fe8b7253165eeadfa41b4702c380f?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">shudhan</span>
	                <span class="date">September 2, 2016 at 3:26 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-363254" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Best place to learn the tuning.. my question – is it good to 
follow the order you mentioned to tune the parameters? I know the most 
significant parameters should be tuned first</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-363254" data-commentid="363254" data-postid="2967" data-belowelement="comment-363254" data-respondelement="respond" aria-label="Reply to shudhan">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-363351" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-363351" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">September 3, 2016 at 6:56 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-363351" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks. The order is a good start. It is best to focus on areas 
where you think you will get the biggest improvement first – which is 
often the structure of the network (layers and neurons).</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-363351" data-commentid="363351" data-postid="2967" data-belowelement="comment-363351" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-447591" class="comment even depth-3 parent">

	      	<div id="li-comment-447591" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/2cc346d477c375bb63c8babd8e4b3d71.jfif" srcset="https://secure.gravatar.com/avatar/2cc346d477c375bb63c8babd8e4b3d71?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Reed Guo</span>
	                <span class="date">September 2, 2018 at 5:59 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-447591" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi, Jason</p>
<p>Thanks for your post. It is excellent.</p>
<p>I have a question.</p>
<p>You tune batch size and epoch first. But if you set a inappropriate 
number of neurons or activation function, then batch size and epoch 
tuning won’t make sense.</p>
<p>So I think we should tune all of these hyper-parameters at the same time.</p>
<p>How do you think about it?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-447591" data-commentid="447591" data-postid="2967" data-belowelement="comment-447591" data-respondelement="respond" aria-label="Reply to Reed Guo">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-447620" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4 parent">

	      	<div id="li-comment-447620" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">September 3, 2018 at 6:13 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-447620" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>They are all connected. If we could, we would tune all the parameters, but almost always it requires too many resources.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-447620" data-commentid="447620" data-postid="2967" data-belowelement="comment-447620" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-481510" class="comment even depth-5">

	      	<div id="li-comment-481510" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/3a74ea6007fe77df5f4ce609997adef3.jfif" srcset="https://secure.gravatar.com/avatar/3a74ea6007fe77df5f4ce609997adef3?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://nan/" rel="external nofollow" class="url">max v</a></span>
	                <span class="date">April 21, 2019 at 12:52 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-481510" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,<br>
Do you recommend any particular order, which hyper parameter shoudl we tune first ?<br>
There is an order in this article, you start with batch size and training epochs , then optimization etc.<br>
Did you find any ressource or research paper, explaining the best consecutive tuning order ?<br>
thanks</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-481571" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-5">

	      	<div id="li-comment-481571" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">April 21, 2019 at 8:25 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-481571" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Learning rate!</p>
<p>Yes, I have many. Perhaps start here:<br>
<a href="https://machinelearningmastery.com/learning-rate-for-deep-learning-neural-networks/" rel="nofollow">https://machinelearningmastery.com/learning-rate-for-deep-learning-neural-networks/</a></p>
<p>More here:<br>
<a href="https://machinelearningmastery.com/start-here/#better" rel="nofollow">https://machinelearningmastery.com/start-here/#better</a></p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-365593" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-365593" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/e4b805e75f8592749ad5013ca0ab7fae.jfif" srcset="https://secure.gravatar.com/avatar/e4b805e75f8592749ad5013ca0ab7fae?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Satheesh</span>
	                <span class="date">September 27, 2016 at 12:24 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-365593" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>when I am using the categorical_entropy loss function and running
 the grid search with n_jobs more than 1 its throwing error “cannot 
pickle object class”, but the same thing is working fine with 
binary_entropyloss. Can you tell me if I am making any mistake in my 
code:<br>
    def create_model(optimizer=’adam’):<br>
        # create model<br>
        model.add(Dense(30, input_dim=59, init=’normal’, activation=’relu’))<br>
        model.add(Dense(15, init=’normal’, activation=’sigmoid’))<br>
        model.add(Dense(3, init=’normal’, activation=’sigmoid’))<br>
        # Compile model<br>
        model.compile(loss=’categorical_crossentropy’, optimizer=optimizer, metrics=[‘accuracy’])<br>
        return model</p>
<p>    # Create Keras Classifier<br>
    print “——————— Running Grid Search on Keras Classifier for epochs and batch ——————”<br>
    clf = model = KerasClassifier(build_fn = create_model, verbose=0)<br>
    param_grid = {“batch_size”:range(10, 30, 10), “nb_epoch”:range(50, 150, 50)}<br>
    optimizer = [‘SGD’, ‘RMSprop’, ‘Adagrad’, ‘Adadelta’, ‘Adam’, ‘Adamax’, ‘Nadam’]<br>
    grid = GridSearchCV(estimator=model, param_grid=param_grid, n_jobs=4)<br>
    grid_result = grid.fit(x_train, y_train)<br>
    print(“Best: %f using %s” % (grid_result.best_score_, grid_result.best_params_))</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-365593" data-commentid="365593" data-postid="2967" data-belowelement="comment-365593" data-respondelement="respond" aria-label="Reply to Satheesh">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-365648" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-365648" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">September 27, 2016 at 7:44 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-365648" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Strange Satheesh, I have not seen that before.</p>
<p>Let me know if you figure it out.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-365648" data-commentid="365648" data-postid="2967" data-belowelement="comment-365648" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-414202" class="comment even depth-3 parent">

	      	<div id="li-comment-414202" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/9b72fab1b1490791807fc089bcedffdf.jfif" srcset="https://secure.gravatar.com/avatar/9b72fab1b1490791807fc089bcedffdf?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Kai</span>
	                <span class="date">September 18, 2017 at 10:01 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-414202" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I came cross and solved the problem several days ago. Please use 
“epochs” instead of “nb_epoch” in param_grid dict. Personally, I guess 
“cannot pickle object class” means the neuron network cannot be built 
because of some errors. Open to discussion.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-414202" data-commentid="414202" data-postid="2967" data-belowelement="comment-414202" data-respondelement="respond" aria-label="Reply to Kai">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-414241" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4">

	      	<div id="li-comment-414241" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">September 19, 2017 at 7:40 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-414241" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Glad to hear it. </p>
<p>I updated the example to use “epochs” to work with Keras 2.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-414241" data-commentid="414241" data-postid="2967" data-belowelement="comment-414241" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-370118" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-370118" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/8e8407386235e7156818bf8f93ae07ac.png" srcset="https://secure.gravatar.com/avatar/8e8407386235e7156818bf8f93ae07ac?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">L Fenu</span>
	                <span class="date">November 9, 2016 at 7:47 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-370118" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>excellent post, thanks. It’s been very helpful to get me started on hyperparameterisation.</p>
<p>One thing I haven’t been able to do yet is to grid search over 
parameters which are not proper to the NN but to the trainign set. For 
example, I can fine-tune the input_dim parameter by creating a function 
generator which takes care of creating the function that will create the
 model, like this:</p>
<p>        # fp_subset is a subset of columns of my whole training set.</p>
<p>        create_basic_ANN_model = kt.ANN_model_gen( # defined elsewhere<br>
            input_dim=len(fp_subset), output_dim=1, layers_num=2, layers_sizes=[len(fp_subset)/5, len(fp_subset)/10, ],<br>
            loss=’mean_squared_error’, optimizer=’adadelta’, metrics=[‘mean_squared_error’, ‘mean_absolute_error’]<br>
        )</p>
<p>        model = KerasRegressor(build_fn=create_basic_ANN_model, verbose=1)<br>
        # define the grid search parameters<br>
        batch_size = [10, 100]<br>
        epochs = [5, 10]</p>
<p>        param_grid = dict(batch_size=batch_size, nb_epoch=epochs)<br>
        grid = GridSearchCV(estimator=model, param_grid=param_grid, n_jobs=1, cv=7)</p>
<p>        grid_results = grid.fit(trX, trY)</p>
<p>this works but only as a for loop over the different fp_subset, which I must define manually.<br>
I could easily pick the best out of every run but it wuld be great if I 
could fold them all inside a big grid definition and fit, so as to 
automatically pick the largest.</p>
<p>However, until now haven’t been able to figure out a way to get that in my head.<br>
If the wrapper function is useful to anyone, I can post a generalised version here.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-370118" data-commentid="370118" data-postid="2967" data-belowelement="comment-370118" data-respondelement="respond" aria-label="Reply to L Fenu">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-370163" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-370163" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">November 10, 2016 at 7:42 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-370163" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Good question.</p>
<p>You might just need to us a loop around the whole lot for different projections/views of your training data.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-370163" data-commentid="370163" data-postid="2967" data-belowelement="comment-370163" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-370236" class="comment even depth-3 parent">

	      	<div id="li-comment-370236" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/8e8407386235e7156818bf8f93ae07ac.png" srcset="https://secure.gravatar.com/avatar/8e8407386235e7156818bf8f93ae07ac?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">L Fenu</span>
	                <span class="date">November 11, 2016 at 1:05 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-370236" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks. I ended up coding my own for loop, saving the results of 
each grid in a dict, sorting the hash by the perofrmance metrics, and 
picking the best model.</p>
<p>Now, the next question is: How do I save the model’s architecture and
 weights to a .json .hdf5 file? I know how to do that for a simple 
model. But how do I extract the best model out of the gridsearch 
results?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-370236" data-commentid="370236" data-postid="2967" data-belowelement="comment-370236" data-respondelement="respond" aria-label="Reply to L Fenu">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-370270" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4 parent">

	      	<div id="li-comment-370270" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">November 11, 2016 at 10:04 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-370270" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Well done.</p>
<p>No need. Once you know the parameters, you can use them to train a 
new standalone model on all of your training data and start making 
predictions.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-370270" data-commentid="370270" data-postid="2967" data-belowelement="comment-370270" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-370583" class="comment even depth-5">

	      	<div id="li-comment-370583" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/92d080fd34992dac8b20e8226b535e7d.jfif" srcset="https://secure.gravatar.com/avatar/92d080fd34992dac8b20e8226b535e7d?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Fenu Luca</span>
	                <span class="date">November 15, 2016 at 3:23 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-370583" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I may have found a way. How about this?</p>
<p>        best_model = grid_result.best_estimator_.model<br>
        best_model_file_path = ‘your_pick_here’<br>
        model2json = best_model.to_json()<br>
        with open( best_model_file_path+’.json’, ‘w’) as json_file:<br>
            json_file.write(model2json)<br>
        best_model.save_weights(best_model_file_path+’.h5′)</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-370544" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-370544" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/bcf6ba0e64f6cbc070afe0450c377c1d.jfif" srcset="https://secure.gravatar.com/avatar/bcf6ba0e64f6cbc070afe0450c377c1d?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">volador</span>
	                <span class="date">November 14, 2016 at 6:21 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-370544" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,  I think this is very best deep learning tutorial on 
the web. Thanks for your work. I have a question is :how to use the 
heuristic algorithm to optimize Hyperparameters for Deep Learning Models
 in Python With Keras, these algorithms like: Genetic algorithm, 
Particle swarm optimization, and Cuckoo algorithm etc.  If the idea 
could be experimented, could you give an example</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-370544" data-commentid="370544" data-postid="2967" data-belowelement="comment-370544" data-respondelement="respond" aria-label="Reply to volador">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-370606" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-370606" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">November 15, 2016 at 7:50 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-370606" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks for your support volador.</p>
<p>You could search the hyperparameter space using a stochastic 
optimization algorithm like a genetic algorithm and use the mean 
performance as the cost function orf fitness function. I don’t have a 
worked example, but it would be relatively easy to setup.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-370606" data-commentid="370606" data-postid="2967" data-belowelement="comment-370606" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-370600" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-370600" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/70312df7de0644f0c9ff1bec237e7230.jfif" srcset="https://secure.gravatar.com/avatar/70312df7de0644f0c9ff1bec237e7230?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Jan de Lange</span>
	                <span class="date">November 15, 2016 at 6:50 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-370600" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason, very helpful intro into gridsearch for Keras. I have 
used your guidance in my code, but rather than using the default 
‘accuracy’ to be optimized, my model requires a specific evaluation 
function to be optimized. You hint at this possibility in the 
introduction, but there is no example of it. I have followed the 
SciKit-learn documentation, but I fail to come up with the correct 
syntax.</p>
<p>I have posted my question at StackOverflow, but since it is quite 
specific, it requires understanding of SciKit-learn in combination with 
Keras.</p>
<p>Perhaps you can have a look? I think it would nicely extend your tutorial.</p>
<p><a href="http://stackoverflow.com/questions/40572743/scikit-learn-grid-search-own-scoring-object-syntax" rel="nofollow">http://stackoverflow.com/questions/40572743/scikit-learn-grid-search-own-scoring-object-syntax</a></p>
<p>Thanks, Jan</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-370600" data-commentid="370600" data-postid="2967" data-belowelement="comment-370600" data-respondelement="respond" aria-label="Reply to Jan de Lange">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-370614" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-370614" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">November 15, 2016 at 8:02 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-370614" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sorry Jan, I have not used a custom scoring function before.</p>
<p>Here are a list of built-in scoring functions:<br>
<a href="http://scikit-learn.org/stable/modules/model_evaluation.html#scoring-parameter" rel="nofollow">http://scikit-learn.org/stable/modules/model_evaluation.html#scoring-parameter</a></p>
<p>Here is help on defining your own scoring function:<br>
<a href="http://scikit-learn.org/stable/modules/model_evaluation.html#defining-your-scoring-strategy-from-metric-functions" rel="nofollow">http://scikit-learn.org/stable/modules/model_evaluation.html#defining-your-scoring-strategy-from-metric-functions</a></p>
<p>Let me know how you go.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-370614" data-commentid="370614" data-postid="2967" data-belowelement="comment-370614" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-370761" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-370761" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/70312df7de0644f0c9ff1bec237e7230.jfif" srcset="https://secure.gravatar.com/avatar/70312df7de0644f0c9ff1bec237e7230?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Jan de Lange</span>
	                <span class="date">November 16, 2016 at 7:31 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-370761" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yup, same sources as I referenced in my post at Stackoverflow.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-370761" data-commentid="370761" data-postid="2967" data-belowelement="comment-370761" data-respondelement="respond" aria-label="Reply to Jan de Lange">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-370796" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-370796" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">November 16, 2016 at 9:35 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-370796" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Excellent. Good luck Jan.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-370796" data-commentid="370796" data-postid="2967" data-belowelement="comment-370796" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-373928" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-373928" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/e029b6071ee3c7694e9aea295a758ee0.jfif" srcset="https://secure.gravatar.com/avatar/e029b6071ee3c7694e9aea295a758ee0?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Anthony Ohazulike</span>
	                <span class="date">December 6, 2016 at 12:46 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-373928" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Good tutorial again Jason…keep on the good job!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-373928" data-commentid="373928" data-postid="2967" data-belowelement="comment-373928" data-respondelement="respond" aria-label="Reply to Anthony Ohazulike">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-373994" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-373994" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">December 6, 2016 at 8:26 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-373994" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks Anthony.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-373994" data-commentid="373994" data-postid="2967" data-belowelement="comment-373994" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-375085" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-375085" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/9dc1076c8831ea242ddd4edd4448b8db.jfif" srcset="https://secure.gravatar.com/avatar/9dc1076c8831ea242ddd4edd4448b8db?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">nrcjea001</span>
	                <span class="date">December 13, 2016 at 10:48 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-375085" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason</p>
<p>First off, thank you for the tutorial. It’s very helpful.</p>
<p>I was also hoping you would assist on how to adapt the keras grid search to stateful lstms as discussed in </p>
<p><a href="http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/" rel="nofollow">http://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/</a></p>
<p>I’ve coded the following:</p>
<p> # create model<br>
model = KerasRegressor(build_fn=create_model, nb_epoch=1, batch_size=bats,<br>
                       verbose=2, shuffle=False)</p>
<p># define the grid search parameters<br>
h1n = [5, 10] # number of hidden neurons<br>
param_grid = dict(h1n=h1n)<br>
grid = GridSearchCV(estimator=model, param_grid=param_grid, n_jobs=-1, cv=5)</p>
<p>for i in range(100):<br>
    grid.fit(trainX, trainY)<br>
    grid.reset_states()</p>
<p>Is grid.reset_states() corrrect? or would you suggest creating function callback for reset states. </p>
<p>Thanks,</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-375085" data-commentid="375085" data-postid="2967" data-belowelement="comment-375085" data-respondelement="respond" aria-label="Reply to nrcjea001">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-375139" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-375139" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">December 14, 2016 at 8:27 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-375139" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Great question.</p>
<p>With stateful LSTMs we must control the resetting of states after 
each epoch. The sklearn framework does not open this capacity to us – at
 least it looks that way to me off the cuff.</p>
<p>I think you may have to grid search stateful LSTM params manually with a ton of for loops. Sorry. </p>
<p>If you discover something different, let me know. i.e. there may be a
 way in the back door to the sklearn grid search functionality that we 
can inject our own custom epoch handing.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-375139" data-commentid="375139" data-postid="2967" data-belowelement="comment-375139" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-376536" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-376536" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/6f9ca6f59716bfdc61bda7cf736b7d80.jfif" srcset="https://secure.gravatar.com/avatar/6f9ca6f59716bfdc61bda7cf736b7d80?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Thomas Maier</span>
	                <span class="date">December 21, 2016 at 2:53 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-376536" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason</p>
<p>Thanks a lot for this and all the other great tutorials!</p>
<p>I tried to combine this gridsearch/keras approach with a pipeline. It
 works if I tune nb_epoch or batch_size, but I get an error if I try to 
tune the optimizer or something else in the keras building function (I 
did not forget to include the variable as an argument):</p>
<p>def keras_model(optimizer = ‘adam’):<br>
    model = Sequential()<br>
    model.add(Dense(80, input_dim=79, init= ‘normal’))<br>
    model.add(Activation(‘relu’))<br>
    model.add(Dense(1, init=’normal’))<br>
    model.add(Activation(‘linear’))<br>
    model.compile(optimizer=optimizer, loss=’mse’)<br>
    return model</p>
<p>kRegressor = KerasRegressor(build_fn=keras_model, nb_epoch=500, batch_size=10, verbose=0)</p>
<p>estimators = []<br>
estimators.append((‘imputer’, preprocessing.Imputer(strategy=’mean’)))<br>
estimators.append((‘scaler’,  preprocessing.StandardScaler()))<br>
estimators.append((‘kerasR’,  kRegressor))<br>
pipeline = Pipeline(estimators)</p>
<p>param_grid = dict(kerasR__optimizer = [‘adam’,’rmsprop’])</p>
<p>grid = GridSearchCV(pipeline, param_grid, cv=5, scoring=’neg_mean_squared_error’)</p>
<p>Do you know this problem?</p>
<p>Thanks, Thomas</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-376536" data-commentid="376536" data-postid="2967" data-belowelement="comment-376536" data-respondelement="respond" aria-label="Reply to Thomas Maier">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-376590" class="comment byuser comment-author-jasonb bypostauthor even depth-2 parent">

	      	<div id="li-comment-376590" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">December 21, 2016 at 8:44 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-376590" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks Thomas. I’ve not seen this issue.</p>
<p>I think we’re starting to push the poor Keras sklearn wrapper to the limit.</p>
<p>Maybe the next step is to build out a few functions to do manual grid searching across network configs.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-376590" data-commentid="376590" data-postid="2967" data-belowelement="comment-376590" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-434940" class="comment odd alt depth-3 parent">

	      	<div id="li-comment-434940" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/d55bb6a4519ac6baffec491ac2a4a900.jfif" srcset="https://secure.gravatar.com/avatar/d55bb6a4519ac6baffec491ac2a4a900?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">James</span>
	                <span class="date">April 14, 2018 at 12:26 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-434940" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Has there been a blog post on this?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-434940" data-commentid="434940" data-postid="2967" data-belowelement="comment-434940" data-respondelement="respond" aria-label="Reply to James">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-434971" class="comment byuser comment-author-jasonb bypostauthor even depth-4">

	      	<div id="li-comment-434971" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">April 14, 2018 at 6:46 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-434971" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Not yet, maybe it’s time.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-434971" data-commentid="434971" data-postid="2967" data-belowelement="comment-434971" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-458304" class="comment odd alt depth-2">

	      	<div id="li-comment-458304" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1774a43284e740d30914b7c76cb728f6.jfif" srcset="https://secure.gravatar.com/avatar/1774a43284e740d30914b7c76cb728f6?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Anastasiya</span>
	                <span class="date">December 12, 2018 at 9:41 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-458304" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Have you solved this issue? I’m exploring Keras now as wel and came across exactly the same problem.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-458304" data-commentid="458304" data-postid="2967" data-belowelement="comment-458304" data-respondelement="respond" aria-label="Reply to Anastasiya">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-376633" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-376633" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/50545b2750d4dc0164c8d4c254d4dd94.jfif" srcset="https://secure.gravatar.com/avatar/50545b2750d4dc0164c8d4c254d4dd94?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://www.octaviuslabs.com/" rel="external nofollow" class="url">Jimi</a></span>
	                <span class="date">December 21, 2016 at 3:26 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-376633" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Great resource! </p>
<p>Any thoughts on how to get the “history” objects out of grid search? 
It could be beneficial to plot the loss and accuracy to see when a model
 starts to flatten out.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-376633" data-commentid="376633" data-postid="2967" data-belowelement="comment-376633" data-respondelement="respond" aria-label="Reply to Jimi">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-376723" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-376723" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">December 22, 2016 at 6:30 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-376723" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Not sure off the cuff Jimi, perhaps repeat the run standalone for the top performing configuration.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-376723" data-commentid="376723" data-postid="2967" data-belowelement="comment-376723" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-379919" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-379919" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/f79095faa0111f5b7c59fa77af746842.jfif" srcset="https://secure.gravatar.com/avatar/f79095faa0111f5b7c59fa77af746842?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">DeepLearning</span>
	                <span class="date">January 4, 2017 at 6:08 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-379919" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks for the post. Can we optimize the number of hidden layers as well on top of number of neurons in each layers?<br>
Thanks</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-379919" data-commentid="379919" data-postid="2967" data-belowelement="comment-379919" data-respondelement="respond" aria-label="Reply to DeepLearning">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-379962" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-379962" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">January 4, 2017 at 9:00 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-379962" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, it just may be very time consuming depending on the size of the dataset and the number of layers/nodes involved.</p>
<p>Try it on some small datasets from the UCI ML Repo.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-379962" data-commentid="379962" data-postid="2967" data-belowelement="comment-379962" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-379985" class="comment even depth-3 parent">

	      	<div id="li-comment-379985" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/f79095faa0111f5b7c59fa77af746842.jfif" srcset="https://secure.gravatar.com/avatar/f79095faa0111f5b7c59fa77af746842?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">DeepLearning</span>
	                <span class="date">January 4, 2017 at 12:02 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-379985" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks. Would you mind looking at below code? </p>
<p>def create_model(neurons=1, neurons2=1):<br>
	# create model<br>
	model = Sequential()<br>
	model.add(Dense(neurons1, input_dim=8))<br>
        model.add(Dense(neurons2))<br>
	model.add(Dense(1, init=’uniform’, activation=’sigmoid’))<br>
	# Compile model<br>
	model.compile(loss=’binary_crossentropy’, optimizer=’adam’, metrics=[‘accuracy’])<br>
	return model<br>
# define the grid search parameters<br>
neurons1 = [1, 3, 5, 7]<br>
neurons2=[0,1,2]<br>
param_grid = dict(neurons1=neurons1, neurons2=neurons2)<br>
grid = GridSearchCV(estimator=model, param_grid=param_grid, n_jobs=-1)<br>
grid_result = grid.fit(X, Y)</p>
<p>This code runs without error (I excluded certain X, y parts for 
brewity) but when I run “grid.fit(X, Y), it gives AssertionError.</p>
<p>I’d appreciate if you can show me where I am wrong.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-379985" data-commentid="379985" data-postid="2967" data-belowelement="comment-379985" data-respondelement="respond" aria-label="Reply to DeepLearning">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-379987" class="comment odd alt depth-4 parent">

	      	<div id="li-comment-379987" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/f79095faa0111f5b7c59fa77af746842.jfif" srcset="https://secure.gravatar.com/avatar/f79095faa0111f5b7c59fa77af746842?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">DeepLearning</span>
	                <span class="date">January 4, 2017 at 12:26 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-379987" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Update” It worked when I deleted 0 from neurons2. Thanks</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-379987" data-commentid="379987" data-postid="2967" data-belowelement="comment-379987" data-respondelement="respond" aria-label="Reply to DeepLearning">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-380246" class="comment byuser comment-author-jasonb bypostauthor even depth-5">

	      	<div id="li-comment-380246" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">January 5, 2017 at 9:16 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-380246" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Excellent, glad to hear it.</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-380245" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4">

	      	<div id="li-comment-380245" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">January 5, 2017 at 9:16 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-380245" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>A Dense() with a value of 0 neurons might blow up. Try removing the 0 from your neurons2 array. </p>
<p>A good debug strategy is to cut code back to the minimum, make it 
work, then and add complexity. Here. Try searching a grid of 1 and 1 
neurons, make it all work, then expand the grid you search.</p>
<p>Let me know how you go.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-380245" data-commentid="380245" data-postid="2967" data-belowelement="comment-380245" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-381153" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-381153" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/f79095faa0111f5b7c59fa77af746842.jfif" srcset="https://secure.gravatar.com/avatar/f79095faa0111f5b7c59fa77af746842?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">DeepLearning</span>
	                <span class="date">January 9, 2017 at 11:04 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-381153" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I keep getting error messages and I tried a big for loops that 
scan for all possible combinations of layer numbers, neuron numbers, 
other optimization stuff within defined limits. It is very time 
consuming code, but I could not figure it out how to adjust layer 
structure and other optimization parameters in the same code using 
GridSearch. If you would provide a code for that in your blog one day, 
that would be much appreciated. Thanks.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-381153" data-commentid="381153" data-postid="2967" data-belowelement="comment-381153" data-respondelement="respond" aria-label="Reply to DeepLearning">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-381286" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-381286" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">January 10, 2017 at 8:55 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-381286" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I’ll try to find the time.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-381286" data-commentid="381286" data-postid="2967" data-belowelement="comment-381286" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-381433" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-381433" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/25496707c7cc5f6d81ef087f44957ea6.jfif" srcset="https://secure.gravatar.com/avatar/25496707c7cc5f6d81ef087f44957ea6?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Rajneesh</span>
	                <span class="date">January 11, 2017 at 10:48 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-381433" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,<br>
Many thanks for this awesome tutorial !</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-381433" data-commentid="381433" data-postid="2967" data-belowelement="comment-381433" data-respondelement="respond" aria-label="Reply to Rajneesh">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-381591" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-381591" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">January 12, 2017 at 9:24 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-381591" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I’m glad you found it useful Rajneesh.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-381591" data-commentid="381591" data-postid="2967" data-belowelement="comment-381591" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-383424" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-383424" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/184b0490cacebe8997eec3072fcd897a.jfif" srcset="https://secure.gravatar.com/avatar/184b0490cacebe8997eec3072fcd897a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Andy</span>
	                <span class="date">January 22, 2017 at 1:02 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-383424" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>Great tutorial! I’m running into a slight issue. I tried running this
 on my own variation of the code and got the following error:</p>
<p>TypeError: get_params() got an unexpected keyword argument ‘deep’</p>
<p>I copied and pasted your code using the given data set and got the 
same error. The code is showing an error on the grid_result = 
grid.fit(X, Y) line. I looked through the other comments and didn’t see 
anyone with the same issue. Do you know where this could be coming from?</p>
<p>Thanks for your help!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-383424" data-commentid="383424" data-postid="2967" data-belowelement="comment-383424" data-respondelement="respond" aria-label="Reply to Andy">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-383535" class="comment odd alt depth-2">

	      	<div id="li-comment-383535" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/69d2e746204ec0024a8ca380b510da1f.jfif" srcset="https://secure.gravatar.com/avatar/69d2e746204ec0024a8ca380b510da1f?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">YechiBechi</span>
	                <span class="date">January 23, 2017 at 2:18 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-383535" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>same issue here,</p>
<p>great tutorial, life saver.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-383535" data-commentid="383535" data-postid="2967" data-belowelement="comment-383535" data-respondelement="respond" aria-label="Reply to YechiBechi">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-383578" class="comment byuser comment-author-jasonb bypostauthor even depth-2 parent">

	      	<div id="li-comment-383578" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">January 23, 2017 at 8:35 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-383578" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Andy, sorry to hear that.</p>
<p>Is this happening with a specific example or with all of them?</p>
<p>Are you able to check your version of Python/sklearn/keras/tf/theano?</p>
<p>UPDATE:</p>
<p>I can confirm the first example still works fine with Python 2.7, sklearn 0.18.1, Keras 1.2.0 and TensorFlow 0.12.1.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-383578" data-commentid="383578" data-postid="2967" data-belowelement="comment-383578" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-383973" class="comment odd alt depth-3 parent">

	      	<div id="li-comment-383973" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/184b0490cacebe8997eec3072fcd897a.jfif" srcset="https://secure.gravatar.com/avatar/184b0490cacebe8997eec3072fcd897a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Andy</span>
	                <span class="date">January 25, 2017 at 7:12 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-383973" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>The only differences are I am running Python 3.5 and Keras 1.2.1.
 The example I ran previously was the grid search for the number of 
neurons in a layer. But I just ran the first example and got the same 
error.</p>
<p>Do you think the issue is due to the next version of Python? If so, what should my next steps be?</p>
<p>Thanks for your help and quick response!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-383973" data-commentid="383973" data-postid="2967" data-belowelement="comment-383973" data-respondelement="respond" aria-label="Reply to Andy">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-384421" class="comment even depth-4 parent">

	      	<div id="li-comment-384421" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/fd3d6d436ebd55493bf72a1db11e0b87.jfif" srcset="https://secure.gravatar.com/avatar/fd3d6d436ebd55493bf72a1db11e0b87?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Jannes</span>
	                <span class="date">January 27, 2017 at 5:51 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-384421" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>It’s a bug in Keras 1.2.1. You can either downgrade to 1.2.0 or get the code from their github (where they already fixed it).</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-384421" data-commentid="384421" data-postid="2967" data-belowelement="comment-384421" data-respondelement="respond" aria-label="Reply to Jannes">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-384504" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-5">

	      	<div id="li-comment-384504" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">January 27, 2017 at 12:22 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-384504" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, I have a write up of the problem and available fixes here:<br>
<a href="http://stackoverflow.com/questions/41796618/python-keras-cross-val-score-error/41841066#41841066" rel="nofollow">http://stackoverflow.com/questions/41796618/python-keras-cross-val-score-error/41841066#41841066</a></p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-384729" class="comment even depth-5">

	      	<div id="li-comment-384729" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/184b0490cacebe8997eec3072fcd897a.jfif" srcset="https://secure.gravatar.com/avatar/184b0490cacebe8997eec3072fcd897a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Andy</span>
	                <span class="date">January 28, 2017 at 4:21 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-384729" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thank you so much for your help!</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-386485" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-386485" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/b32cf90586f47118347021c197d55eff.jfif" srcset="https://secure.gravatar.com/avatar/b32cf90586f47118347021c197d55eff?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">kono</span>
	                <span class="date">February 8, 2017 at 3:14 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-386485" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Jason,</p>
<p>Can you use early_stopping to decide n_epoch?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-386485" data-commentid="386485" data-postid="2967" data-belowelement="comment-386485" data-respondelement="respond" aria-label="Reply to kono">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-386533" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-386533" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">February 8, 2017 at 9:36 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-386533" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, that is a good method to find a generalized model.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-386533" data-commentid="386533" data-postid="2967" data-belowelement="comment-386533" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-389607" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-389607" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/c0161e0a5cc5cd0426e0f0ac1ab70d28.jfif" srcset="https://secure.gravatar.com/avatar/c0161e0a5cc5cd0426e0f0ac1ab70d28?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Jayant</span>
	                <span class="date">February 23, 2017 at 4:33 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-389607" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>Really great article. I am a big fan of your blog and your books. Can you please explain your following statement?</p>
<p>“A default cross-validation of 3 was used, but perhaps k=5 or k=10 
would be more stable. Carefully choose your cross validation 
configuration to ensure your results are stable.”</p>
<p>I didn’t see anywhere cross-validation being used.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-389607" data-commentid="389607" data-postid="2967" data-belowelement="comment-389607" data-respondelement="respond" aria-label="Reply to Jayant">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-389644" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-389644" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">February 23, 2017 at 8:56 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-389644" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jayant,</p>
<p>Grid search uses k-fold cross-validation to evaluate the performance of each combination of parameters on unseen data.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-389644" data-commentid="389644" data-postid="2967" data-belowelement="comment-389644" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-390453" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-390453" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/282310adecab4a4a1c3d33111b1612ad.jfif" srcset="https://secure.gravatar.com/avatar/282310adecab4a4a1c3d33111b1612ad?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Jing</span>
	                <span class="date">February 28, 2017 at 2:09 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-390453" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,<br>
 thanks for this awesome tutorial !<br>
 I have two questions: 1. In “model.compile(loss=’binary_crossentropy’, 
optimizer=’adam’, metrics=[‘accuracy’])”, accuracy is used for evaluate 
results. But GridSearchCV also has scoring parameter, if I set 
“scoring=’f1’”,which one is used for evaluate  the results of grid 
search? 2.How to set two evaluate parameters ,e.g. ‘accuracy’and ’f1’ 
evaluating the results of grid search？</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-390453" data-commentid="390453" data-postid="2967" data-belowelement="comment-390453" data-respondelement="respond" aria-label="Reply to Jing">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-390486" class="comment byuser comment-author-jasonb bypostauthor even depth-2 parent">

	      	<div id="li-comment-390486" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">February 28, 2017 at 8:13 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-390486" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jing,</p>
<p>You can set the “scoring” argument for GridSearchCV with a string of 
the performance measure to use, or the name of your own scoring 
function. You can learn about this argument here:<br>
<a href="http://scikit-learn.org/stable/modules/generated/sklearn.model_selection.GridSearchCV.html" rel="nofollow">http://scikit-learn.org/stable/modules/generated/sklearn.model_selection.GridSearchCV.html</a></p>
<p>You can see a full list of supported scoring measures here:<br>
<a href="http://scikit-learn.org/stable/modules/model_evaluation.html#scoring-parameter" rel="nofollow">http://scikit-learn.org/stable/modules/model_evaluation.html#scoring-parameter</a></p>
<p>As far as I know you can only grid search using a single measure.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-390486" data-commentid="390486" data-postid="2967" data-belowelement="comment-390486" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-390522" class="comment odd alt depth-3">

	      	<div id="li-comment-390522" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/282310adecab4a4a1c3d33111b1612ad.jfif" srcset="https://secure.gravatar.com/avatar/282310adecab4a4a1c3d33111b1612ad?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Jing</span>
	                <span class="date">February 28, 2017 at 12:50 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-390522" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thank you so much for your help!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-390522" data-commentid="390522" data-postid="2967" data-belowelement="comment-390522" data-respondelement="respond" aria-label="Reply to Jing">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-390540" class="comment even depth-3 parent">

	      	<div id="li-comment-390540" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/282310adecab4a4a1c3d33111b1612ad.jfif" srcset="https://secure.gravatar.com/avatar/282310adecab4a4a1c3d33111b1612ad?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Jing</span>
	                <span class="date">February 28, 2017 at 1:54 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-390540" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I find no matter what evaluate parameters used in GridSearchCV 
“scoring”,”metrics” in “model.compile” must be [‘accuracy’],otherwise 
the program gives “ValueError: The model is not configured to compute 
accuracy.You should pass ‘metrics=[“accuracy”]’ to the 
‘model.compile()’method. So, if  I set:<br>
model.compile(loss=’binary_crossentropy’, optimizer=’adam’, metrics=[‘accuracy’])<br>
grid = GridSearchCV(estimator=model, param_grid=param_grid, scoring=’recall’)<br>
the grid_result.best_score_ =0.72.My question is: 0.72 is accuracy or recall ? Thank you!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-390540" data-commentid="390540" data-postid="2967" data-belowelement="comment-390540" data-respondelement="respond" aria-label="Reply to Jing">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-390703" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4">

	      	<div id="li-comment-390703" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">March 1, 2017 at 8:31 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-390703" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jing,</p>
<p>When using GridSearchCV with Keras, I would suggest not specifying any metrics when compiling your Keras model.</p>
<p>I would suggest only setting the “scoring” argument on the 
GridSearchCV. I would expect the metric reported by GridSearchCV to be 
the one that you specified.</p>
<p>I hope that helps.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-390703" data-commentid="390703" data-postid="2967" data-belowelement="comment-390703" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-391735" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-391735" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/fe5552c5ba4d2c3d69230b79c40bedb6.jfif" srcset="https://secure.gravatar.com/avatar/fe5552c5ba4d2c3d69230b79c40bedb6?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Dan</span>
	                <span class="date">March 8, 2017 at 4:13 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-391735" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Great Blogpost. Love it. You are awesome Jason. I got one 
question to GridsearchCV. As far as i understand the crossvalidation 
already takes place in there. That’s why we do not need any kfold 
anymore.<br>
But with this technique we would have no validation set correct? e.g. 
with a default value of 3 we would have 2 training sets and one test 
set.</p>
<p>That means in kfold as well as in GridsearchCV there is no requirement for creating a validation set anymore?</p>
<p>Thanks</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-391735" data-commentid="391735" data-postid="2967" data-belowelement="comment-391735" data-respondelement="respond" aria-label="Reply to Dan">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-391774" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-391774" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">March 8, 2017 at 9:44 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-391774" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Dan,</p>
<p>Yes, GridSearchCV performs cross validation and you must specify the 
number of folds. You can hold back a validation set to double check the 
parameters found by the search if you like. This is optional.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-391774" data-commentid="391774" data-postid="2967" data-belowelement="comment-391774" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-391897" class="comment even depth-3 parent">

	      	<div id="li-comment-391897" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/fe5552c5ba4d2c3d69230b79c40bedb6.jfif" srcset="https://secure.gravatar.com/avatar/fe5552c5ba4d2c3d69230b79c40bedb6?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Dan</span>
	                <span class="date">March 9, 2017 at 3:25 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-391897" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thank you for the quick response Jason. Especially considering the huge amount of questions you get.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-391897" data-commentid="391897" data-postid="2967" data-belowelement="comment-391897" data-respondelement="respond" aria-label="Reply to Dan">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-391935" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4">

	      	<div id="li-comment-391935" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">March 9, 2017 at 9:55 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-391935" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I’m here to help, if I can Dan.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-391935" data-commentid="391935" data-postid="2967" data-belowelement="comment-391935" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-393789" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-393789" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/005d5d83b87e51291a18c761d504480f.jfif" srcset="https://secure.gravatar.com/avatar/005d5d83b87e51291a18c761d504480f?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://www.steunenberg.de/" rel="external nofollow" class="url">Johan Steunenberg</a></span>
	                <span class="date">March 22, 2017 at 8:25 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-393789" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>What I’m missing in the tutorial is the info, how to get the best
 params in the model with KERAS. Do I pickup the best parameters and 
call ‘create_model’ again with those parameters or can I call the 
GridSearchCV’s ‘predict’ function? (I will try out for myself but for 
completeness it would be good to have it in the tutorial as well.)</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-393789" data-commentid="393789" data-postid="2967" data-belowelement="comment-393789" data-respondelement="respond" aria-label="Reply to Johan Steunenberg">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-393849" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-393849" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">March 23, 2017 at 8:49 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-393849" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I see, but we don’t know the best parameters, we must search for them.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-393849" data-commentid="393849" data-postid="2967" data-belowelement="comment-393849" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-395393" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-395393" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/334dfca3a7d846b25e254da64501da63.jfif" srcset="https://secure.gravatar.com/avatar/334dfca3a7d846b25e254da64501da63?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Maycown Miranda</span>
	                <span class="date">April 5, 2017 at 2:09 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-395393" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi, Jason. I am getting<br>
/usr/local/lib/python2.7/dist-packages/keras/wrappers/scikit_learn.py in
 check_params(self=, params={‘batch_size’: 10, ‘epochs’: 10})<br>
     80             legal_params += inspect.getargspec(fn)[0]<br>
     81         legal_params = set(legal_params)<br>
     82<br>
     83         for params_name in params:<br>
     84             if params_name not in legal_params:<br>
—&gt; 85                 raise ValueError(‘{} is not a legal parameter’.format(params_name))<br>
        params_name = ‘epochs’<br>
     86<br>
     87     def get_params(self, _):<br>
     88         “””Gets parameters for this estimator.<br>
     89 </p>
<p>ValueError: epochs is not a legal parameter</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-395393" data-commentid="395393" data-postid="2967" data-belowelement="comment-395393" data-respondelement="respond" aria-label="Reply to Maycown Miranda">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-395777" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-395777" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">April 9, 2017 at 2:32 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-395777" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>It sounds like you need to upgrade to Keras v2.0 or higher.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-395777" data-commentid="395777" data-postid="2967" data-belowelement="comment-395777" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-421443" class="comment even depth-3">

	      	<div id="li-comment-421443" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/3384b0b717cf5bc53b38670d837c9a28.jfif" srcset="https://secure.gravatar.com/avatar/3384b0b717cf5bc53b38670d837c9a28?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Chandra Sutrisno Tjhong</span>
	                <span class="date">November 28, 2017 at 10:46 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-421443" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I experienced the same problem.I upgraded my keras and the same problem still occurs.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-421443" data-commentid="421443" data-postid="2967" data-belowelement="comment-421443" data-respondelement="respond" aria-label="Reply to Chandra Sutrisno Tjhong">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-466895" class="comment odd alt depth-2">

	      	<div id="li-comment-466895" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/710e9e6ec5503bba981befd0453dedd8.jfif" srcset="https://secure.gravatar.com/avatar/710e9e6ec5503bba981befd0453dedd8?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">neumatron11</span>
	                <span class="date">February 5, 2019 at 12:42 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-466895" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I was getting the ‘not a legal paramater’ error when I was trying
 to pass required inputs into my create_model function in the wrapper. </p>
<p>model = KerasClassifier(build_fn=create_model(input_dim = x ), verbose=0)</p>
<p>when I removed it and included it in the grid search instead it ran fine, I just added it to the dictionary of parameters</p>
<p>input_dim = [x]</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-466895" data-commentid="466895" data-postid="2967" data-belowelement="comment-466895" data-respondelement="respond" aria-label="Reply to neumatron11">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-398363" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-398363" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/42a96d94f177c1391f7088cbb23afde7.jfif" srcset="https://secure.gravatar.com/avatar/42a96d94f177c1391f7088cbb23afde7?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Usman</span>
	                <span class="date">May 3, 2017 at 7:56 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-398363" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Nice tutorial. I would like to optimize the number of hidden layers in the model. Can you please guide in this regard, thanks</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-398363" data-commentid="398363" data-postid="2967" data-belowelement="comment-398363" data-respondelement="respond" aria-label="Reply to Usman">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-398482" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-398482" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">May 4, 2017 at 7:59 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-398482" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks Usman.</p>
<p>Consider exploring specific patterns, e.g. small-big-small, etc.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-398482" data-commentid="398482" data-postid="2967" data-belowelement="comment-398482" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-398620" class="comment even thread-even depth-1">

	      	<div id="li-comment-398620" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/881f4d46c6d1d1f458831cb7ae591b03.jfif" srcset="https://secure.gravatar.com/avatar/881f4d46c6d1d1f458831cb7ae591b03?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Carl</span>
	                <span class="date">May 5, 2017 at 12:58 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-398620" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Do you know any way this could be possible using a network with multiple inputs?</p>
<p><a href="http://imgur.com/a/JJ7f1" rel="nofollow">http://imgur.com/a/JJ7f1</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-398620" data-commentid="398620" data-postid="2967" data-belowelement="comment-398620" data-respondelement="respond" aria-label="Reply to Carl">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-399132" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-399132" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/adc44a044c71c323c695050f974829ab.jfif" srcset="https://secure.gravatar.com/avatar/adc44a044c71c323c695050f974829ab?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">DanielP</span>
	                <span class="date">May 9, 2017 at 4:26 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-399132" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason, great to see posts like this – amazing job!</p>
<p>Just noticed, when you tune the optimisation algorithm SGD performs 
at 34% accuracy. As no parameters are being passed to the SGD function, 
I’d assume it takes the default configuration, lr=0.01, momentum=0.0. </p>
<p>Later on, as you look for better configurations for SGD, best result (68%) is found when {‘learn_rate’: 0.01, ‘momentum’: 0.0}. </p>
<p>It seems to me that these two experiments use exactly the same 
network configuration (including the same SGD parameters), yet their 
resulting accuracies differ significantly. Do you have any intuition as 
to why this may be happening?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-399132" data-commentid="399132" data-postid="2967" data-belowelement="comment-399132" data-respondelement="respond" aria-label="Reply to DanielP">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-399249" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-399249" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">May 10, 2017 at 8:43 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-399249" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Daniel, yes great point.</p>
<p>Neural networks are stochastic and give different results when evaluated on the same data.</p>
<p>Ideally, each configuration would be evaluated using the average of multiple (30+) repeats.</p>
<p>This post might help:<br>
<a href="http://machinelearningmastery.com/randomness-in-machine-learning/" rel="nofollow">http://machinelearningmastery.com/randomness-in-machine-learning/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-399249" data-commentid="399249" data-postid="2967" data-belowelement="comment-399249" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-399604" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-399604" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/672a38c4bbc1f7d84489491f54307ea5.jfif" srcset="https://secure.gravatar.com/avatar/672a38c4bbc1f7d84489491f54307ea5?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Pradanuari</span>
	                <span class="date">May 14, 2017 at 3:13 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-399604" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason!<br>
absolutely love your tutorial! But would you mind to give tutorial for how to tune the number of hidden layer?</p>
<p>Thanks</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-399604" data-commentid="399604" data-postid="2967" data-belowelement="comment-399604" data-respondelement="respond" aria-label="Reply to Pradanuari">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-399632" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-399632" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">May 14, 2017 at 7:32 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-399632" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I have an example here:<br>
<a href="http://machinelearningmastery.com/exploratory-configuration-multilayer-perceptron-network-time-series-forecasting/" rel="nofollow">http://machinelearningmastery.com/exploratory-configuration-multilayer-perceptron-network-time-series-forecasting/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-399632" data-commentid="399632" data-postid="2967" data-belowelement="comment-399632" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-399668" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-399668" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/672a38c4bbc1f7d84489491f54307ea5.jfif" srcset="https://secure.gravatar.com/avatar/672a38c4bbc1f7d84489491f54307ea5?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Pradanuari</span>
	                <span class="date">May 14, 2017 at 11:32 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-399668" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thank you so much Jason!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-399668" data-commentid="399668" data-postid="2967" data-belowelement="comment-399668" data-respondelement="respond" aria-label="Reply to Pradanuari">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-399686" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-399686" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">May 15, 2017 at 5:53 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-399686" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I’m glad it helped Pradanuari.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-399686" data-commentid="399686" data-postid="2967" data-belowelement="comment-399686" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-399874" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-399874" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/57e948b02de90bef2bfe8347bb77b29c.jfif" srcset="https://secure.gravatar.com/avatar/57e948b02de90bef2bfe8347bb77b29c?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Ibrahim El-Fayoumi</span>
	                <span class="date">May 17, 2017 at 12:53 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-399874" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello Jason<br>
I tried to use your idea in a similar problem but I am getting error : AttributeError: ‘NoneType’ object has no attribute ‘loss’<br>
it looks like the model does not define loss function?</p>
<p>This is the error I get:<br>
b\site-packages\keras-2.0.4-py3.5.egg\keras\wrappers\scikit_learn.py in fit(self=, x=memmap([[[ 0.,  0.,  0., …,  0.,  0.,  0.],<br>
  …,  0.,  0., …,  0.,  0.,  0.]]], dtype=float32), y=array([[ 0.,  0.,  0., …,  0.,  0.,  0.],<br>
    …0.],<br>
       [ 0.,  0.,  0., …,  0.,  1.,  0.]]), **kwargs={})<br>
    135             self.model = self.build_fn(<br>
    136                 **self.filter_sk_params(self.build_fn.__call__))<br>
    137         else:<br>
    138             self.model = self.build_fn(**self.filter_sk_params(self.build_fn))<br>
    139<br>
–&gt; 140         loss_name = self.model.loss<br>
        loss_name = undefined<br>
        self.model.loss = undefined<br>
    141         if hasattr(loss_name, ‘__name__’):<br>
    142             loss_name = loss_name.__name__<br>
    143         if loss_name == ‘categorical_crossentropy’ and len(y.shape) != 2:<br>
    144             y = to_categorical(y)</p>
<p>AttributeError: ‘NoneType’ object has no attribute ‘loss’<br>
___________________________________________________________________________</p>
<p>Process finished with exit code 1</p>
<p>Regards<br>
Ibrahim</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-399874" data-commentid="399874" data-postid="2967" data-belowelement="comment-399874" data-respondelement="respond" aria-label="Reply to Ibrahim El-Fayoumi">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-399925" class="comment byuser comment-author-jasonb bypostauthor even depth-2 parent">

	      	<div id="li-comment-399925" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">May 18, 2017 at 8:26 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-399925" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Does the example in the blog post work on your system?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-399925" data-commentid="399925" data-postid="2967" data-belowelement="comment-399925" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-399946" class="comment odd alt depth-3 parent">

	      	<div id="li-comment-399946" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/57e948b02de90bef2bfe8347bb77b29c.jfif" srcset="https://secure.gravatar.com/avatar/57e948b02de90bef2bfe8347bb77b29c?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Ibrahim El-Fayoumi</span>
	                <span class="date">May 18, 2017 at 12:18 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-399946" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Ok, I think your code needs to be placed after<br>
if __name__ == ‘__main__’:</p>
<p>to work with multiprocess…</p>
<p>But thanks for the post is great…</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-399946" data-commentid="399946" data-postid="2967" data-belowelement="comment-399946" data-respondelement="respond" aria-label="Reply to Ibrahim El-Fayoumi">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-400005" class="comment byuser comment-author-jasonb bypostauthor even depth-4">

	      	<div id="li-comment-400005" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">May 19, 2017 at 8:12 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-400005" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Not on Linux and OS X when I tested it, but thanks for the tip.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-400005" data-commentid="400005" data-postid="2967" data-belowelement="comment-400005" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-411117" class="comment odd alt depth-4">

	      	<div id="li-comment-411117" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/02b3f85b473484b2f5ae5d55d9a4bd5e.jfif" srcset="https://secure.gravatar.com/avatar/02b3f85b473484b2f5ae5d55d9a4bd5e?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Gautam</span>
	                <span class="date">August 25, 2017 at 11:33 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-411117" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>n_jobs=-1 doesnt work on Windows.</p>
<p>@Ibrahim: Can you please explain, what part of the code needs to be behind<br>
if __name__ == ‘__main__’: )</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-411117" data-commentid="411117" data-postid="2967" data-belowelement="comment-411117" data-respondelement="respond" aria-label="Reply to Gautam">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-400153" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-400153" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/875163e086ed54c30ce973cde9e5fbfe.jfif" srcset="https://secure.gravatar.com/avatar/875163e086ed54c30ce973cde9e5fbfe?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Edward</span>
	                <span class="date">May 21, 2017 at 3:17 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-400153" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello Jason!<br>
I do the first step – try to tune Batch Size and Number of Epochs and get<br>
print(“Best: %f using %s” % (grid_result.best_score_, grid_result.best_params_))<br>
Best: 0.707031 using {‘epochs’: 100, ‘batch_size’: 40}<br>
After that I do the same and get<br>
print(“Best: %f using %s” % (grid_result.best_score_, grid_result.best_params_))<br>
Best: 0.688802 using {‘epochs’: 100, ‘batch_size’: 20}<br>
And so on<br>
The problem is in the grid_result.best_score_</p>
<p>I expect that in the second step (for ample tuning optimizer) I will 
get grid_result.best_score_ better than in the first step (in the second
 step i use grid_result.best_params_ from the first step). But it is not
 true<br>
Tune all Hyperparameters is a very long time</p>
<p>How to fix it?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-400153" data-commentid="400153" data-postid="2967" data-belowelement="comment-400153" data-respondelement="respond" aria-label="Reply to Edward">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-400166" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-400166" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">May 21, 2017 at 6:01 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-400166" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Consider tuning different parameters, like network structure or number of input features.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-400166" data-commentid="400166" data-postid="2967" data-belowelement="comment-400166" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-400203" class="comment even depth-3">

	      	<div id="li-comment-400203" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/875163e086ed54c30ce973cde9e5fbfe.jfif" srcset="https://secure.gravatar.com/avatar/875163e086ed54c30ce973cde9e5fbfe?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Edward</span>
	                <span class="date">May 21, 2017 at 7:18 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-400203" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks a lot Jason!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-400203" data-commentid="400203" data-postid="2967" data-belowelement="comment-400203" data-respondelement="respond" aria-label="Reply to Edward">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-400172" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-400172" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/3d07a7b4845fb7c5c7b25a541e686818.jfif" srcset="https://secure.gravatar.com/avatar/3d07a7b4845fb7c5c7b25a541e686818?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">pattijane</span>
	                <span class="date">May 21, 2017 at 7:44 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-400172" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello, </p>
<p>I’d like to have your opinion about a problem:</p>
<p>I have two loss function plots, with SGD and Adamax as optimizer with same learning rate.<br>
Loss function of SGD looks like the red one, whereas Adamax’s looks like blue one.<br>
(<a href="http://cs231n.github.io/assets/nn3/learningrates.jpeg" rel="nofollow">http://cs231n.github.io/assets/nn3/learningrates.jpeg</a>)</p>
<p>I have better scores with Adamax on validation data. I’m confused 
about how to proceed, should I choose Adamax and play with learning 
rates a little more, or go on with SGD and somehow try to improve 
performance?</p>
<p>Thanks!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-400172" data-commentid="400172" data-postid="2967" data-belowelement="comment-400172" data-respondelement="respond" aria-label="Reply to pattijane">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-400233" class="comment byuser comment-author-jasonb bypostauthor even depth-2 parent">

	      	<div id="li-comment-400233" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">May 22, 2017 at 7:49 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-400233" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Explore both, but focus on the validation score of interest (e.g. accuracy, RMSE, etc.) over loss. </p>
<p>For example, you can get very low loss and get worse accuracy.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-400233" data-commentid="400233" data-postid="2967" data-belowelement="comment-400233" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-400263" class="comment odd alt depth-3 parent">

	      	<div id="li-comment-400263" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/3d07a7b4845fb7c5c7b25a541e686818.jfif" srcset="https://secure.gravatar.com/avatar/3d07a7b4845fb7c5c7b25a541e686818?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">pattijane</span>
	                <span class="date">May 22, 2017 at 6:35 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-400263" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks for your response! I experimented with different learning 
rates and found out a reasonable one, (good for both Adamax and SGD) and
 now I try to fix learning rate and optimizer and focus on other 
hyperparameters such as batch-size and number of neurons. Or would be 
better if I set those first?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-400263" data-commentid="400263" data-postid="2967" data-belowelement="comment-400263" data-respondelement="respond" aria-label="Reply to pattijane">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-400299" class="comment byuser comment-author-jasonb bypostauthor even depth-4">

	      	<div id="li-comment-400299" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">May 23, 2017 at 7:49 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-400299" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Number of neurons will have a big effect along with learning rate.</p>
<p>Batch size will have a smaller effect and could be optimized last.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-400299" data-commentid="400299" data-postid="2967" data-belowelement="comment-400299" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-400286" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-400286" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/2d9b02c88562fbc51e2aafd94159a114.jfif" srcset="https://secure.gravatar.com/avatar/2d9b02c88562fbc51e2aafd94159a114?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Lotem</span>
	                <span class="date">May 23, 2017 at 1:47 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-400286" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks for this post!</p>
<p>One question – why not use grid search on all the parameters 
together, rather than preforming several grid searches and finding each 
parameter separately? surly the results are not the same…</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-400286" data-commentid="400286" data-postid="2967" data-belowelement="comment-400286" data-respondelement="respond" aria-label="Reply to Lotem">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-400306" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-400306" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">May 23, 2017 at 7:54 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-400306" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Great question,</p>
<p>In practice, the datasets are large and it can take a long time and require a lot of RAM.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-400306" data-commentid="400306" data-postid="2967" data-belowelement="comment-400306" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-400476" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-400476" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/87caaed05117d32a58017ed3376224c0.jfif" srcset="https://secure.gravatar.com/avatar/87caaed05117d32a58017ed3376224c0?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">StatsSorceress</span>
	                <span class="date">May 25, 2017 at 6:52 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-400476" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>Excellent post!</p>
<p>It seems to me that if you use the entire training set during your 
cross-validation, then your cross-validation error is going to give you 
an optimistically biased estimate of your validation error. I think this
 is because when you train the final model on the entire dataset, the 
validation set you create to estimate test performance comes out of the 
training set. </p>
<p>My question is: assuming we have a lot of data, should we use perhaps
 only 50% of the training data for cross-validation for the 
hyperparameters, and then use the remaining 50% for fitting the final 
model (and a portion of that remaining 50% would be used for the 
validation set)? That way we wouldn’t be using the same data twice. I am
 assuming in this case that we would also have a separate test set.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-400476" data-commentid="400476" data-postid="2967" data-belowelement="comment-400476" data-respondelement="respond" aria-label="Reply to StatsSorceress">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-401118" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-401118" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">June 2, 2017 at 11:38 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-401118" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, it is a good idea to hold back a test set when tuning.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-401118" data-commentid="401118" data-postid="2967" data-belowelement="comment-401118" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-400610" class="comment odd alt thread-odd thread-alt depth-1">

	      	<div id="li-comment-400610" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/a0ffb067d3946c9b7d578b87bb3e7067.jfif" srcset="https://secure.gravatar.com/avatar/a0ffb067d3946c9b7d578b87bb3e7067?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Yang</span>
	                <span class="date">May 27, 2017 at 5:35 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-400610" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks for your valuable post. I learned a lot from it.<br>
When I wrote my code for grid search, I encountered a question: </p>
<p>I use fit_generator instead of fit in keras.<br>
Is it possible to use grid search with fit_generator ?</p>
<p>I have some Merge layers in my deep learning model.<br>
Hence, the input of the neural network is not a single matrix.<br>
For example:<br>
Suppose we have 1,000 samples<br>
Input =  [Input1,Input2]<br>
Input1 is a 1,000 *3 matrix<br>
Input2 is a 1,000*3*50*50 matrix (image)</p>
<p>When I use the fit in your post, there is a bug….because the input1 
and input2 don’t have the same dimension. So I wonder whether the 
fit_generator can work with grid search ?</p>
<p>Thanks in advance!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-400610" data-commentid="400610" data-postid="2967" data-belowelement="comment-400610" data-respondelement="respond" aria-label="Reply to Yang">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-400612" class="comment even thread-even depth-1">

	      	<div id="li-comment-400612" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/a0ffb067d3946c9b7d578b87bb3e7067.jfif" srcset="https://secure.gravatar.com/avatar/a0ffb067d3946c9b7d578b87bb3e7067?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Yang</span>
	                <span class="date">May 27, 2017 at 6:46 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-400612" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Please ignore my previous reply.<br>
I find an answer here: <a href="https://github.com/fchollet/keras/issues/6451" rel="nofollow">https://github.com/fchollet/keras/issues/6451</a><br>
Right now, the GridsearchCV using the scikit wrapper for network with multiple inputs is not available.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-400612" data-commentid="400612" data-postid="2967" data-belowelement="comment-400612" data-respondelement="respond" aria-label="Reply to Yang">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-400686" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-400686" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/203a993daf61e417e75c5141534b880e.jfif" srcset="https://secure.gravatar.com/avatar/203a993daf61e417e75c5141534b880e?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Kate liu</span>
	                <span class="date">May 28, 2017 at 4:31 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-400686" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason, thank you for your good tutorial of the grid research 
with Keras. I followed your example with my own dataset. It could be 
run. But when I using the autoencoder structure, instead of the 
sequential structure,  to gird the parameters with my own data. It could
 not be run. I don’t know the reason. Could you help me? Are there any 
differences between the gird of sequential structure and the grid of 
model structure?</p>
<p>The follows are my codes:</p>
<p>from keras.models import Sequential<br>
from keras.layers import Dense, Input<br>
from keras.wrappers.scikit_learn import KerasClassifier<br>
from sklearn.model_selection import StratifiedKFold<br>
from sklearn.model_selection import cross_val_score<br>
from sklearn.model_selection import GridSearchCV<br>
import numpy as np<br>
from keras.optimizers import SGD, Adam, RMSprop, Adagrad<br>
from keras.regularizers import l1,l2<br>
from keras.models import Model<br>
import pandas as pd<br>
from keras.models import load_model</p>
<p>np.random.seed(2017)</p>
<p>def create_model(optimizer=’rmsprop’):</p>
<p># encoder layers<br>
encoding_dim =140<br>
input_img = Input(shape=(6,))<br>
encoded = Dense(300, activation=’relu’,W_regularizer=l1(0.01))(input_img)<br>
encoded = Dense(300, activation=’relu’,W_regularizer=l1(0.01))(encoded)<br>
encoded = Dense(300, activation=’relu’,W_regularizer=l1(0.01))(encoded)<br>
encoder_output = Dense(encoding_dim, activation=’relu’,W_regularizer=l1(0.01))(encoded)</p>
<p># decoder layers<br>
decoded = Dense(300, activation=’relu’,W_regularizer=l1(0.01))(encoder_output)<br>
decoded = Dense(300, activation=’relu’,W_regularizer=l1(0.01))(decoded)<br>
decoded = Dense(300, activation=’relu’,W_regularizer=l1(0.01))(decoded)<br>
decoded = Dense(6, activation=’relu’,W_regularizer=l1(0.01))(decoded)</p>
<p># construct the autoencoder model<br>
autoencoder = Model(input_img, decoded)</p>
<p># construct the encoder model for plotting<br>
encoder = Model(input_img, encoder_output)</p>
<p># Compile model<br>
autoencoder.compile(optimizer=’RMSprop’, loss=’mean_squared_error’,metrics=[‘accuracy’])</p>
<p>return autoencoder</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-400686" data-commentid="400686" data-postid="2967" data-belowelement="comment-400686" data-respondelement="respond" aria-label="Reply to Kate liu">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-401161" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-401161" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">June 2, 2017 at 12:09 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-401161" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I’m surprised, I would not think the network architecture would make a difference. </p>
<p>Sorry, I have no good suggestions other than try to debug the cause of the fault.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-401161" data-commentid="401161" data-postid="2967" data-belowelement="comment-401161" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-400687" class="comment odd alt thread-even depth-1">

	      	<div id="li-comment-400687" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/203a993daf61e417e75c5141534b880e.jfif" srcset="https://secure.gravatar.com/avatar/203a993daf61e417e75c5141534b880e?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Kate liu</span>
	                <span class="date">May 28, 2017 at 4:36 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-400687" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>the command of autoencoder.compile is modified as the follows:<br>
# Compile model<br>
autoencoder.compile(optimizer=optimizer, loss=’mean_squared_error’,metrics=[‘accuracy’])</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-400687" data-commentid="400687" data-postid="2967" data-belowelement="comment-400687" data-respondelement="respond" aria-label="Reply to Kate liu">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-400771" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-400771" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/11d783924563f22c8ec8b3c555471005.jfif" srcset="https://secure.gravatar.com/avatar/11d783924563f22c8ec8b3c555471005?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Rahul</span>
	                <span class="date">May 30, 2017 at 12:07 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-400771" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Can we do this for functional API as well ?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-400771" data-commentid="400771" data-postid="2967" data-belowelement="comment-400771" data-respondelement="respond" aria-label="Reply to Rahul">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-401188" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-401188" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">June 2, 2017 at 12:28 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-401188" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Perhaps, I have not done this.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-401188" data-commentid="401188" data-postid="2967" data-belowelement="comment-401188" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-400844" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-400844" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/fdc80acbb584de0617b1c1bdaf34b063.jfif" srcset="https://secure.gravatar.com/avatar/fdc80acbb584de0617b1c1bdaf34b063?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Ian Worthington</span>
	                <span class="date">May 30, 2017 at 10:36 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-400844" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks for a great tutorial Jason, appreciated.</p>
<p>njobs=-1 didn’t work very well on my Windows 10 machine: took a very long time and never finished.</p>
<p><a href="https://stackoverflow.com/questions/28005307/gridsearchcv-no-reporting-on-high-verbosity" rel="nofollow">https://stackoverflow.com/questions/28005307/gridsearchcv-no-reporting-on-high-verbosity</a>
 seems to suggest this is (or at least was in 2015) a known problem 
under Windows so I changed to n_jobs=1, which also allowed me to see 
throughput using verbose=10.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-400844" data-commentid="400844" data-postid="2967" data-belowelement="comment-400844" data-respondelement="respond" aria-label="Reply to Ian Worthington">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-401204" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-401204" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">June 2, 2017 at 12:37 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-401204" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks for the tip.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-401204" data-commentid="401204" data-postid="2967" data-belowelement="comment-401204" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-400852" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-400852" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/fdc80acbb584de0617b1c1bdaf34b063.jfif" srcset="https://secure.gravatar.com/avatar/fdc80acbb584de0617b1c1bdaf34b063?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Ian Worthington</span>
	                <span class="date">May 31, 2017 at 1:56 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-400852" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Jason —</p>
<p>Given all the parameters it is possible to adjust, is there any 
recommendation for which should be fixed first before exploring others, 
or can ALL results for one change when others are changed?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-400852" data-commentid="400852" data-postid="2967" data-belowelement="comment-400852" data-respondelement="respond" aria-label="Reply to Ian Worthington">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-401207" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-401207" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">June 2, 2017 at 12:39 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-401207" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Great question, see this paper:<br>
<a href="https://arxiv.org/abs/1206.5533" rel="nofollow">https://arxiv.org/abs/1206.5533</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-401207" data-commentid="401207" data-postid="2967" data-belowelement="comment-401207" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-401291" class="comment even depth-3">

	      	<div id="li-comment-401291" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/fdc80acbb584de0617b1c1bdaf34b063.jfif" srcset="https://secure.gravatar.com/avatar/fdc80acbb584de0617b1c1bdaf34b063?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Ian Worthington</span>
	                <span class="date">June 3, 2017 at 2:39 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-401291" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks Jason, I’ll check it out.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-401291" data-commentid="401291" data-postid="2967" data-belowelement="comment-401291" data-respondelement="respond" aria-label="Reply to Ian Worthington">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-401904" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-401904" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/e562e2ff4b6d0fc005895c3a710e7cfa.jfif" srcset="https://secure.gravatar.com/avatar/e562e2ff4b6d0fc005895c3a710e7cfa?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Mario</span>
	                <span class="date">June 9, 2017 at 12:10 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-401904" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi and thank you for the resource.</p>
<p>Am I right in my understanding that this only works on one machine?</p>
<p>Any hints / pointers on how to run this on a cluster? I have found <a href="https://goo.gl/Q9Xy7B" rel="nofollow">https://goo.gl/Q9Xy7B</a> as a potential avenue using Spark (no Keras though).</p>
<p>Any comment at all? Information on the subject is scarce.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-401904" data-commentid="401904" data-postid="2967" data-belowelement="comment-401904" data-respondelement="respond" aria-label="Reply to Mario">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-401943" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-401943" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">June 9, 2017 at 6:26 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-401943" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, this example is for a single machine. Sorry, I do not have examples for running on a cluster.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-401943" data-commentid="401943" data-postid="2967" data-belowelement="comment-401943" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-402778" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-402778" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/f61a374094ff3ba065754b857667718e.jfif" srcset="https://secure.gravatar.com/avatar/f61a374094ff3ba065754b857667718e?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Shaun</span>
	                <span class="date">June 16, 2017 at 11:54 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-402778" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason, </p>
<p>I’m a little bit confused about the definition of the “score” or 
“accuracy”. How are they made? I believe that they are not simply 
comparing the results with target, otherwise it will be the overfitting 
model being the best (like the more neurons the better). </p>
<p>But on the other hand, they are just using those combinations of 
parameters to train the model, so what is the difference between I 
manually set the parameters and see my result good or not, with risk of 
overfitting and the grid search that creates an accuracy score to 
determine which one is the best?</p>
<p>Best regards,</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-402778" data-commentid="402778" data-postid="2967" data-belowelement="comment-402778" data-respondelement="respond" aria-label="Reply to Shaun">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-402839" class="comment byuser comment-author-jasonb bypostauthor even depth-2 parent">

	      	<div id="li-comment-402839" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">June 17, 2017 at 7:30 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-402839" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>The grid search will provide an estimate of the skill of the model with a set of parameters.</p>
<p>Any one configuration in the grid search can be set and evaluated manually. </p>
<p>Neural networks are stochastic and will give different predictions/skill when trained on the same data.</p>
<p>Ideally, if you have the time/compute the grid search should use 
repeated k-fold cross validation to provide robust estimates of model 
skill. More here:<br>
<a href="http://machinelearningmastery.com/evaluate-skill-deep-learning-models/" rel="nofollow">http://machinelearningmastery.com/evaluate-skill-deep-learning-models/</a></p>
<p>Does that help?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-402839" data-commentid="402839" data-postid="2967" data-belowelement="comment-402839" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-403081" class="comment odd alt depth-3 parent">

	      	<div id="li-comment-403081" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/2490869d5983b66d9554fd9ad2f3de8c.jfif" srcset="https://secure.gravatar.com/avatar/2490869d5983b66d9554fd9ad2f3de8c?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Shaun</span>
	                <span class="date">June 20, 2017 at 2:30 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-403081" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I’m new to the NN, a little bit puzzled. So say, if I have to 
many neurons that leads to overfitting (good on the train set, bad on 
the validation or test set), can grid search detect it by the score? </p>
<p>My guess is yes, because there is a validation set in the GridsearchCV. Is that correct?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-403081" data-commentid="403081" data-postid="2967" data-belowelement="comment-403081" data-respondelement="respond" aria-label="Reply to Shaun">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-403128" class="comment byuser comment-author-jasonb bypostauthor even depth-4">

	      	<div id="li-comment-403128" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">June 20, 2017 at 6:39 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-403128" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>A larget network can overfit. </p>
<p>The idea is to find a config that does well on the train and 
validation sets. We require a robust test harness. With enough 
resources, I’d recommend repeated k-fold cross validation within the 
grid search. </p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-403128" data-commentid="403128" data-postid="2967" data-belowelement="comment-403128" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-403056" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-403056" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/0138f6e24db7f665b7680a4faf1d0b28.jfif" srcset="https://secure.gravatar.com/avatar/0138f6e24db7f665b7680a4faf1d0b28?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Huyen</span>
	                <span class="date">June 19, 2017 at 4:21 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-403056" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>One more very useful tutorial, thank Jason.</p>
<p>One question about GridSearch in my case. I have tried to tune 
parameters of my neural network for regression with 18 inputs size 800 
but the time to use GridSearch totally long, like forever even though I 
have limited to the number. I saw in your code:</p>
<p>grid = GridSearchCV(estimator=model, param_grid=param_grid, n_jobs=-1)</p>
<p>Normally, n_jobs=1, can I increase that number to improve the performances?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-403056" data-commentid="403056" data-postid="2967" data-belowelement="comment-403056" data-respondelement="respond" aria-label="Reply to Huyen">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-403121" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-403121" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">June 20, 2017 at 6:36 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-403121" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>We often cannot grid search with neural nets because it takes so long!</p>
<p>Consider running on a large computer in the cloud over the weekend.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-403121" data-commentid="403121" data-postid="2967" data-belowelement="comment-403121" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-403244" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-403244" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/30c561819abf9fad31619edbd46d3455.jfif" srcset="https://secure.gravatar.com/avatar/30c561819abf9fad31619edbd46d3455?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Bobo</span>
	                <span class="date">June 21, 2017 at 4:57 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-403244" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason, </p>
<p>Any idea how to use GridSearchCV if you don’t want cross validation?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-403244" data-commentid="403244" data-postid="2967" data-belowelement="comment-403244" data-respondelement="respond" aria-label="Reply to Bobo">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-403270" class="comment byuser comment-author-jasonb bypostauthor even depth-2 parent">

	      	<div id="li-comment-403270" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">June 21, 2017 at 8:19 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-403270" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>GridSearch supports k-fold cross-validation by default. That is what the “CV” is in the name:<br>
<a href="http://scikit-learn.org/stable/modules/generated/sklearn.model_selection.GridSearchCV.html" rel="nofollow">http://scikit-learn.org/stable/modules/generated/sklearn.model_selection.GridSearchCV.html</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-403270" data-commentid="403270" data-postid="2967" data-belowelement="comment-403270" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-403606" class="comment odd alt depth-3 parent">

	      	<div id="li-comment-403606" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/d3da7adff6de42ef861b9f1c01423a9b.jfif" srcset="https://secure.gravatar.com/avatar/d3da7adff6de42ef861b9f1c01423a9b?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Bobo</span>
	                <span class="date">June 24, 2017 at 3:07 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-403606" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>So sklearn has no GridSearch without cross validation?<br>
In any case I found kind of a hack here to get rid of cv:<br>
<a href="https://stackoverflow.com/questions/44636370/scikit-learn-gridsearchcv-without-cross-validation-unsupervised-learning" rel="nofollow">https://stackoverflow.com/questions/44636370/scikit-learn-gridsearchcv-without-cross-validation-unsupervised-learning</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-403606" data-commentid="403606" data-postid="2967" data-belowelement="comment-403606" data-respondelement="respond" aria-label="Reply to Bobo">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-403644" class="comment byuser comment-author-jasonb bypostauthor even depth-4">

	      	<div id="li-comment-403644" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">June 24, 2017 at 8:04 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-403644" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You can configure the k in CV to 1 to it does train/test. Then configure it to repeat.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-403644" data-commentid="403644" data-postid="2967" data-belowelement="comment-403644" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-404126" class="comment odd alt thread-even depth-1">

	      	<div id="li-comment-404126" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/17184f825427eb8e482f69fd6ccd62c3.jfif" srcset="https://secure.gravatar.com/avatar/17184f825427eb8e482f69fd6ccd62c3?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">makis</span>
	                <span class="date">June 28, 2017 at 11:54 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-404126" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello. Thank you for the nice tutorial.</p>
<p>I am trying to combine pipeline and gridsearch.</p>
<p>Inside my keras model i use kernel_initializer=init_mode.<br>
Then I am trying to assign values to the init_mode dictionary in order to perform the gridsearch.</p>
<p>I get the following error: ValueError: init_mode is not a legal parameter</p>
<p>My code is here: <a href="https://www.dropbox.com/s/57n777j9w8bxf4t/keras_grid.py?dl=0" rel="nofollow">https://www.dropbox.com/s/57n777j9w8bxf4t/keras_grid.py?dl=0</a></p>
<p>Any tip? Thank you</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-404126" data-commentid="404126" data-postid="2967" data-belowelement="comment-404126" data-respondelement="respond" aria-label="Reply to makis">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-405448" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-405448" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/6b14f2bb7477a7781fd577850ca6341a.jfif" srcset="https://secure.gravatar.com/avatar/6b14f2bb7477a7781fd577850ca6341a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Abhijith Darshan Ravindra</span>
	                <span class="date">July 11, 2017 at 6:31 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-405448" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Dr. Brownlee,</p>
<p>When I run this in Spyder IDE nothing happens after grid.fit.</p>
<p>It just appears to do nothing.</p>
<p>Any suggestions as to why?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-405448" data-commentid="405448" data-postid="2967" data-belowelement="comment-405448" data-respondelement="respond" aria-label="Reply to Abhijith Darshan Ravindra">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-405487" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-405487" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">July 11, 2017 at 10:34 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-405487" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Consider running from the command line.</p>
<p>The grid search may take a long time.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-405487" data-commentid="405487" data-postid="2967" data-belowelement="comment-405487" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-405824" class="comment even depth-3 parent">

	      	<div id="li-comment-405824" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d87b7d00866913c793736e3d0a4ab78.jfif" srcset="https://secure.gravatar.com/avatar/1d87b7d00866913c793736e3d0a4ab78?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">DY</span>
	                <span class="date">July 14, 2017 at 6:11 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-405824" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello Dr Brownlee,</p>
<p>I saved your example codes into .py file and run it. Nothing happens 
after grid.fit. However, if I run line by line from your example codes 
it works.  Do you know why?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-405824" data-commentid="405824" data-postid="2967" data-belowelement="comment-405824" data-respondelement="respond" aria-label="Reply to DY">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-405853" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4">

	      	<div id="li-comment-405853" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">July 14, 2017 at 8:36 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-405853" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>It may take a long time. Consider reducing the scope of the search to see if you can get results sooner.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-405853" data-commentid="405853" data-postid="2967" data-belowelement="comment-405853" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-414211" class="comment even depth-2 parent">

	      	<div id="li-comment-414211" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/ffa63d210ca9bae2becd03e173fc3f83.jfif" srcset="https://secure.gravatar.com/avatar/ffa63d210ca9bae2becd03e173fc3f83?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Tryfon</span>
	                <span class="date">September 18, 2017 at 11:46 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-414211" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I had the same issue with you (using spyder and python 3.6) but 
after changing the parameter n_jobs = 1 it worked fine. Also n_jobs = 2 
was stuck although spyder showed it was running in the backgound (I 
checked the CPU usage and was down to 1% vs the 55-80% when it is 
actually running).</p>
<p>Don’t ask the reason why is that. My guess would be that it has to do
 with your system and the fact that it might not support parallelization
 (no CUDA GPU).</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-414211" data-commentid="414211" data-postid="2967" data-belowelement="comment-414211" data-respondelement="respond" aria-label="Reply to Tryfon">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-414248" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-3">

	      	<div id="li-comment-414248" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">September 19, 2017 at 7:47 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-414248" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Consider running the example from the command line instead.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-414248" data-commentid="414248" data-postid="2967" data-belowelement="comment-414248" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-407527" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-407527" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/a40fb54c7675ab8d64025bb8783a42f5.jfif" srcset="https://secure.gravatar.com/avatar/a40fb54c7675ab8d64025bb8783a42f5?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Kamal Thapa</span>
	                <span class="date">July 27, 2017 at 3:46 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-407527" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>How can I do Hyper-parameter optimization for MLPRegressor in scikit learn?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-407527" data-commentid="407527" data-postid="2967" data-belowelement="comment-407527" data-respondelement="respond" aria-label="Reply to Kamal Thapa">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-407613" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-407613" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">July 28, 2017 at 8:28 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-407613" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-407613" data-commentid="407613" data-postid="2967" data-belowelement="comment-407613" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-408320" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-408320" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/4fcb6fed918ad33ff8ddda1c6165874e.jfif" srcset="https://secure.gravatar.com/avatar/4fcb6fed918ad33ff8ddda1c6165874e?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Josep</span>
	                <span class="date">August 3, 2017 at 2:31 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-408320" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,<br>
I’m unable to apply the grid search to a seq to seq LSTM network (Keras 
Regressor model in the scikit API). When I set the GridSearchCV scoring 
algorithm to r^2 (or any scoring function for regression problems) the 
model.fit expect a 2 dim input vector, not the 3 dim used in Keras.<br>
Otherwise, if I left the default scoring algorithm named 
“_passthrough_scorer”( I don’t know what it does, I don’t even know what
 it is) it works but the best_score doesn’t match with the real best 
parametrization. I’m really confused…I’ll had to write the grid search 
manually…</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-408320" data-commentid="408320" data-postid="2967" data-belowelement="comment-408320" data-respondelement="respond" aria-label="Reply to Josep">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-408321" class="comment odd alt depth-2 parent">

	      	<div id="li-comment-408321" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/4fcb6fed918ad33ff8ddda1c6165874e.jfif" srcset="https://secure.gravatar.com/avatar/4fcb6fed918ad33ff8ddda1c6165874e?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Josep</span>
	                <span class="date">August 3, 2017 at 2:42 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-408321" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I’ve solved it, I share it if someone have the same issue…,If you
 set the gridsearch scoring function to “None” it uses the scoring 
metrics of the Keras model.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-408321" data-commentid="408321" data-postid="2967" data-belowelement="comment-408321" data-respondelement="respond" aria-label="Reply to Josep">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-408322" class="comment even depth-3">

	      	<div id="li-comment-408322" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/4fcb6fed918ad33ff8ddda1c6165874e.jfif" srcset="https://secure.gravatar.com/avatar/4fcb6fed918ad33ff8ddda1c6165874e?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Josep</span>
	                <span class="date">August 3, 2017 at 2:49 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-408322" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sorry for bothering, but the results of the approach I’ve said are incorrect. I don’t know what to do.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-408322" data-commentid="408322" data-postid="2967" data-belowelement="comment-408322" data-respondelement="respond" aria-label="Reply to Josep">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-408357" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-408357" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">August 3, 2017 at 6:54 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-408357" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Josep,</p>
<p>Consider writing your own for loop to iterate over params and run a Cross Validation for the params within the loop.</p>
<p>This is how I do it now for large/complex models.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-408357" data-commentid="408357" data-postid="2967" data-belowelement="comment-408357" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-408972" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-408972" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/a33cc4eda404a85e75841e76c8348302.jfif" srcset="https://secure.gravatar.com/avatar/a33cc4eda404a85e75841e76c8348302?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">kotb</span>
	                <span class="date">August 8, 2017 at 7:10 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-408972" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Can i use this grid search without using keras model</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-408972" data-commentid="408972" data-postid="2967" data-belowelement="comment-408972" data-respondelement="respond" aria-label="Reply to kotb">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-409035" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-409035" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">August 9, 2017 at 6:27 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-409035" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>For sure!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-409035" data-commentid="409035" data-postid="2967" data-belowelement="comment-409035" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-410159" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-410159" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/e106f1c922d7e4def5829d66b1d5ed85.jfif" srcset="https://secure.gravatar.com/avatar/e106f1c922d7e4def5829d66b1d5ed85?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Aman Garg</span>
	                <span class="date">August 19, 2017 at 3:35 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-410159" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello Jason, </p>
<p>Thanks for such a nice tutorial. </p>
<p>Instead of getting a output as ‘Best: 0.720052 using {‘init_mode’: 
‘uniform’}’ , it would be really nice if you could show us how to 
visualize this result with matplotlib so that it gets more easier.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-410159" data-commentid="410159" data-postid="2967" data-belowelement="comment-410159" data-respondelement="respond" aria-label="Reply to Aman Garg">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-410190" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-410190" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">August 19, 2017 at 6:23 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-410190" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Great suggestion, thanks.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-410190" data-commentid="410190" data-postid="2967" data-belowelement="comment-410190" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-410290" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-410290" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/35135dce61887e65f30f314b31dc4c42.jfif" srcset="https://secure.gravatar.com/avatar/35135dce61887e65f30f314b31dc4c42?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Michael</span>
	                <span class="date">August 20, 2017 at 4:42 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-410290" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi, Jason.  Thanks, again, for all of the blog posts and example 
code.  I’m trying to tune my binary classification Keras neural network.
  My dataset includes about 50,000 entries with 52 (numeric) variables. 
 Using Grid Search, I’ve tested all sorts of combinations of layer size,
 number of epochs, batch size, optimizers, activations, learning rates, 
dropout rates, and L2 regularization parameters.   My grid search shows 
every combination performs the same.  For example, here is a snippet 
from my latest results:</p>
<p>Best: 0.876381 using {‘act’: ‘relu’, ‘opt’: ‘Adam’}<br>
0.876381 (0.003878) with: {‘act’: ‘relu’, ‘opt’: ‘Adam’}<br>
0.876381 (0.003878) with: {‘act’: ‘relu’, ‘opt’: ‘SGD’}<br>
0.876381 (0.003878) with: {‘act’: ‘relu’, ‘opt’: ‘Adagrad’}<br>
0.876381 (0.003878) with: {‘act’: ‘relu’, ‘opt’: ‘Adadelta’}<br>
0.876361 (0.003880) with: {‘act’: ‘tanh’, ‘opt’: ‘Adam’}<br>
0.876381 (0.003878) with: {‘act’: ‘tanh’, ‘opt’: ‘SGD’}</p>
<p>But I also get 0.876381 whether I have 1000 nodes or 1 node, and for 
every other combo I’ve tested.  I’ve also tried different ways of 
scaling or transforming my input data with no impact.</p>
<p>Do you have any thoughts on why I’m having trouble finding different 
combinations of parameters that actually have a difference in 
performance?  </p>
<p>Thank you for your help!  You rock!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-410290" data-commentid="410290" data-postid="2967" data-belowelement="comment-410290" data-respondelement="respond" aria-label="Reply to Michael">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-410306" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-410306" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">August 20, 2017 at 6:09 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-410306" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Very odd results. Double check your train/test data. </p>
<p>Also, see this post for a long list of ideas to try:<br>
<a href="http://machinelearningmastery.com/improve-deep-learning-performance/" rel="nofollow">http://machinelearningmastery.com/improve-deep-learning-performance/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-410306" data-commentid="410306" data-postid="2967" data-belowelement="comment-410306" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-410316" class="comment even depth-3">

	      	<div id="li-comment-410316" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/35135dce61887e65f30f314b31dc4c42.jfif" srcset="https://secure.gravatar.com/avatar/35135dce61887e65f30f314b31dc4c42?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Michael</span>
	                <span class="date">August 20, 2017 at 9:20 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-410316" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-410316" data-commentid="410316" data-postid="2967" data-belowelement="comment-410316" data-respondelement="respond" aria-label="Reply to Michael">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-412375" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-412375" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/029d4ac64563bd9db1b8caa4eacbe3ab.png" srcset="https://secure.gravatar.com/avatar/029d4ac64563bd9db1b8caa4eacbe3ab?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Shubham Kumar</span>
	                <span class="date">September 3, 2017 at 11:54 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-412375" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hey Jason.<br>
I was using grid search to tune hyperparameters for a CNN-LSTM classification problem.<br>
I used the code template on your blog about sequence classification.<br>
MY original data has 38932 instances, but for tuning I am using only 1000 to save time.<br>
But even then, I am not sure how to best search for those parameters and save time. </p>
<p>Is it a bad idea to search for hyper parameters in a small subset (almost 1/40th of training in my case).<br>
Will the result vary largely when I use actual data size?<br>
Also, I passed in several parameters for the grid search. Left it 
overnight and it still hadn’t made enough progress, so I stopped the 
execution.<br>
How can I speed up this process?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-412375" data-commentid="412375" data-postid="2967" data-belowelement="comment-412375" data-respondelement="respond" aria-label="Reply to Shubham Kumar">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-412395" class="comment byuser comment-author-jasonb bypostauthor even depth-2 parent">

	      	<div id="li-comment-412395" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">September 3, 2017 at 3:44 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-412395" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>The result will be biased, but perhaps might give you an idea of 
the direction in which to proceed – this could be enough for you.</p>
<p>I often run a lot of sanity check grid searches on small samples to get ideas on which direction to push.</p>
<p>More data will result in less biased estimates of model skill, often proportionately to some point of diminishing returns.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-412395" data-commentid="412395" data-postid="2967" data-belowelement="comment-412395" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-412456" class="comment odd alt depth-3 parent">

	      	<div id="li-comment-412456" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/029d4ac64563bd9db1b8caa4eacbe3ab.png" srcset="https://secure.gravatar.com/avatar/029d4ac64563bd9db1b8caa4eacbe3ab?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Shubham Kumar</span>
	                <span class="date">September 4, 2017 at 3:10 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-412456" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Great !<br>
I did read that one of the sanity checks is to check whether the model 
overfits on a small sample! If yes, then we are good to go…<br>
I am slightly new to building proper models and find this part exciting but a little intimidating at the same time !<br>
I am going to use only a few hyper parameters at a time, and keep  the rest constant and check what happens ! </p>
<p>Love your posts ! They are amazingly helpful .<br>
Does the Python LSTM book have code snippets in  Python 3 as well?<br>
Coz it becomes a little difficult to search for the right modules and attributes otherwise :/</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-412456" data-commentid="412456" data-postid="2967" data-belowelement="comment-412456" data-respondelement="respond" aria-label="Reply to Shubham Kumar">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-412473" class="comment byuser comment-author-jasonb bypostauthor even depth-4">

	      	<div id="li-comment-412473" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">September 4, 2017 at 4:39 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-412473" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>THanks.</p>
<p>Yes, the code in my LSTM book was tested with Python 2.7 and Python 3.5.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-412473" data-commentid="412473" data-postid="2967" data-belowelement="comment-412473" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-413029" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-413029" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/f328475a0e14649e688c13d7e66860ff.jfif" srcset="https://secure.gravatar.com/avatar/f328475a0e14649e688c13d7e66860ff?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Kaushal Shetty</span>
	                <span class="date">September 8, 2017 at 12:24 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-413029" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason, Is this a valid approach to decide the number of layers?<br>
def neural_train(layer1 = 1,layer2 = 1,layer3 = 1,layers = 1):</p>
<p>    input_tensor = Input(shape=(2001,))<br>
    x = Dense(units = layer1,activation=’relu’)(input_tensor)<br>
    if layers == 2:<br>
        x = Dense(layer2,activation = ‘relu’)(x)<br>
    if layers ==3 :<br>
        x = Dense(layer2,activation = ‘relu’)(x)<br>
        x = Dense(layer3,activation = ‘relu’)(x)</p>
<p>    output_tensor = Dense(10,activation=’softmax’)(x)<br>
    model = Model(input_tensor,output_tensor)<br>
    model.compile(optimizer = ‘rmsprop’,loss=’categorical_crossentropy’,metrics = [‘accuracy’])<br>
    return model</p>
<p>layer1 = [1024,512]<br>
layer2 = [256,100]<br>
layer3 = [60,40]<br>
epochs = [10,11]<br>
layers = [2,3]<br>
param_grid = dict(epochs = epochs,layer1 = layer1,layer2 = layer2,layer3 = layer3,layers=layers)<br>
model = KerasClassifier(build_fn = neural_train)<br>
gsv_model = GridSearchCV(model,param_grid=param_grid)<br>
gsv_model.fit(x_train,y_train)</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-413029" data-commentid="413029" data-postid="2967" data-belowelement="comment-413029" data-respondelement="respond" aria-label="Reply to Kaushal Shetty">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-413206" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-413206" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">September 9, 2017 at 11:45 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-413206" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Maybe, you must have a test harness that you can trust, then explore different configurations of your model.</p>
<p>I have more on robustly evaluating neural nets here:<br>
<a href="https://machinelearningmastery.com/evaluate-skill-deep-learning-models/" rel="nofollow">https://machinelearningmastery.com/evaluate-skill-deep-learning-models/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-413206" data-commentid="413206" data-postid="2967" data-belowelement="comment-413206" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-413139" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-413139" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/2dd5894a979508a639f48151c90bd2e2.jfif" srcset="https://secure.gravatar.com/avatar/2dd5894a979508a639f48151c90bd2e2?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">ari</span>
	                <span class="date">September 9, 2017 at 1:29 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-413139" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Very helpful post Jason. Thanks for this. Are there any 
advantages for using gridsearch over something like hyperas/hyperopt ? 
To your best knowledge is one faster than the other?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-413139" data-commentid="413139" data-postid="2967" data-belowelement="comment-413139" data-respondelement="respond" aria-label="Reply to ari">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-413230" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-413230" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">September 9, 2017 at 11:58 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-413230" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Depends on your data and model. Use the took that you prefer.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-413230" data-commentid="413230" data-postid="2967" data-belowelement="comment-413230" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-413303" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-413303" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/029d4ac64563bd9db1b8caa4eacbe3ab.png" srcset="https://secure.gravatar.com/avatar/029d4ac64563bd9db1b8caa4eacbe3ab?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Shubham Kumar</span>
	                <span class="date">September 10, 2017 at 4:38 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-413303" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>{‘split0_test_score’: array([ 0.6641791,  0.6641791,  0.6641791, 
 0.6641791]), ‘split1_test_score’: array([ 0.65413534,  0.65413534,  
0.65413534,  0.65413534]), ‘split2_test_score’: array([ 0.69924811,  
0.69924811,  0.69924811,  0.69924811]), ‘mean_test_score’: array([ 
0.6725,  0.6725,  0.6725,  0.6725]), ‘std_test_score’: array([ 
0.01931902,  0.01931902,  0.01931902,  0.01931902]), ‘rank_test_score’: 
array([1, 1, 1, 1]), ‘split0_train_score’: array([ 0.67669174,  
0.67669174,  0.67669174,  0.67669174]), ‘split1_train_score’: array([ 
0.68164794,  0.68164794,  0.68164794,  0.68164794]), 
‘split2_train_score’: array([ 0.65917602,  0.65917602,  0.65917602,  
0.65917602]), ‘mean_train_score’: array([ 0.67250523,  0.67250523,  
0.67250523,  0.67250523]), ‘std_train_score’: array([ 0.00963991,  
0.00963991,  0.00963991,  0.00963991]), ‘mean_fit_time’: array([ 
36.72573058,  37.0244147 ,  38.12670692,  40.71116368]), ‘std_fit_time’:
 array([ 0.4829061 ,  0.35207924,  0.13746276,  2.71443639]), 
‘mean_score_time’: array([ 1.49508754,  1.76741695,  2.14029002,  
2.67426189]), ‘std_score_time’: array([ 0.04907801,  0.11919153,  
0.07953362,  0.13931651]), ‘param_dropout’: masked_array(data = [0.2 0.5
 0.6 0.7],<br>
             mask = [False False False False],<br>
       fill_value = ?)<br>
, ‘params’: ({‘dropout’: 0.2}, {‘dropout’: 0.5}, {‘dropout’: 0.6}, {‘dropout’: 0.7})}</p>
<p>Hey. I was hypertuning a model on 4 different choices of hyper 
parameters. However, in the grid_results_ dictionary, the 
rank_test_score key has array with all same values. I find that 
confusing. Shouldn’t it have 4 different values in each place?<br>
Something like [1,3,2,4] ?<br>
What could be the explanation for this?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-413303" data-commentid="413303" data-postid="2967" data-belowelement="comment-413303" data-respondelement="respond" aria-label="Reply to Shubham Kumar">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-413304" class="comment even depth-2">

	      	<div id="li-comment-413304" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/029d4ac64563bd9db1b8caa4eacbe3ab.png" srcset="https://secure.gravatar.com/avatar/029d4ac64563bd9db1b8caa4eacbe3ab?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Shubham Kumar</span>
	                <span class="date">September 10, 2017 at 4:50 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-413304" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>It must have something to do with all mean_test_scores being the same ,</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-413304" data-commentid="413304" data-postid="2967" data-belowelement="comment-413304" data-respondelement="respond" aria-label="Reply to Shubham Kumar">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-413425" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-413425" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">September 11, 2017 at 12:03 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-413425" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>If you are testing 4 different values for one parameter, then you must build 4 models/complete 4 runs.</p>
<p>Does that help?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-413425" data-commentid="413425" data-postid="2967" data-belowelement="comment-413425" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-413614" class="comment even depth-3 parent">

	      	<div id="li-comment-413614" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/029d4ac64563bd9db1b8caa4eacbe3ab.png" srcset="https://secure.gravatar.com/avatar/029d4ac64563bd9db1b8caa4eacbe3ab?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Shubham Kumar</span>
	                <span class="date">September 13, 2017 at 5:20 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-413614" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I am sorry. That’s confusing. 4 models or complete 4 runs means ? </p>
<p>Things are different if we are gridsearching/randomsearching just for one hyperparameter?</p>
<p>Does it have something to do with the actual code used to write TensorFlow /keras ?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-413614" data-commentid="413614" data-postid="2967" data-belowelement="comment-413614" data-respondelement="respond" aria-label="Reply to Shubham Kumar">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-413655" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4">

	      	<div id="li-comment-413655" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">September 13, 2017 at 12:36 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-413655" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>If you have one parameter and you want to test 4 values, each 
value needs one run. Ideally, we would run many times for each parameter
 value and take the average skill score given the stochastic nature of 
ML algorithms.</p>
<p>For a random search, you run for as long as you like.</p>
<p>Does that help?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-413655" data-commentid="413655" data-postid="2967" data-belowelement="comment-413655" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-413711" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-413711" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/029d4ac64563bd9db1b8caa4eacbe3ab.png" srcset="https://secure.gravatar.com/avatar/029d4ac64563bd9db1b8caa4eacbe3ab?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Shubham Kumar</span>
	                <span class="date">September 13, 2017 at 11:17 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-413711" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>What I understand is that when we have more than 1 (say 2) 
hyper-parameters in a grid, then for each combination, the code will 
complete as many epochs as I have specified, with as many 
training-cross-validation sets as specified (the CV in GridSearchCV). 
So, going through all those epochs, for each training-cross-validation 
set, we get the avg accuracy over all the cross-validation sets for 
every combination.</p>
<p>So when you say 1 run only in the case of a single hyperparameter, 
that means only 1 training-crossvalidation set? Because only in this 
case, there won’t be any averaging involved.</p>
<p>Is that what I have to do? Change the training-crossValidation set to just 1?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-413711" data-commentid="413711" data-postid="2967" data-belowelement="comment-413711" data-respondelement="respond" aria-label="Reply to Shubham Kumar">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-413882" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-413882" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">September 15, 2017 at 12:06 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-413882" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, 1 run is one CV pass (k folds).</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-413882" data-commentid="413882" data-postid="2967" data-belowelement="comment-413882" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-414146" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-414146" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/e9deb5fceeaa670e53216a9ec1a3132e.jfif" srcset="https://secure.gravatar.com/avatar/e9deb5fceeaa670e53216a9ec1a3132e?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Rishi</span>
	                <span class="date">September 18, 2017 at 5:18 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-414146" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Jason,<br>
would you please post an example of inheriting from KerasClassifier (or 
KerasRegressor) to create your own class? I’m attempting to do this and 
it works for the most part:</p>
<p>class MLP_Regressor(KerasRegressor):</p>
<p>    def __init__(self, **sk_params):<br>
        super().__init__(build_fn=None, **sk_params)</p>
<p>    def __call__(self, optimizer=’adam’, loss=’mean_squared_error’, **kwargs):<br>
        # more code goes here (that was previously in ‘build_fn’</p>
<p>I can include this in a pipeline and it runs perfectly:<br>
MLP Pipeline(memory=None,<br>
     steps=[(‘MLP’, )])</p>
<p>Only thing is: The Keras documentation includes the ‘build_fn’ keyword argument:</p>
<p>keras.wrappers.scikit_learn.KerasClassifier(build_fn=None, **sk_params)</p>
<p>While the actual KerasClassifier class definition shows the following in its __init__ method:</p>
<p> def __init__(self, model, optimizer=’adam’, loss=’categorical_crossentropy’, **kwargs):<br>
        super(KerasClassifier, self).__init__(model, optimizer, loss, **kwargs)</p>
<p>I’m not sure if my __init__ in MLP_Regressor has been setup correctly (to avoid hidden bugs in the future).</p>
<p>Would greatly appreciate it! (I’ve searched, but couldn’t find a single example of KerasClassifier inheritance).</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-414146" data-commentid="414146" data-postid="2967" data-belowelement="comment-414146" data-respondelement="respond" aria-label="Reply to Rishi">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-414159" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-414159" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">September 18, 2017 at 5:49 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-414159" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks for the suggestion, I have not done this but perhaps in the future.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-414159" data-commentid="414159" data-postid="2967" data-belowelement="comment-414159" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-420731" class="comment even depth-3 parent">

	      	<div id="li-comment-420731" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/e9deb5fceeaa670e53216a9ec1a3132e.jfif" srcset="https://secure.gravatar.com/avatar/e9deb5fceeaa670e53216a9ec1a3132e?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Rishi</span>
	                <span class="date">November 21, 2017 at 12:54 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-420731" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Jason, managed to get the inherited class working perfectly now:</p>
<p>class MLP_Classifier(KerasClassifier):</p>
<p>    def __init__(self, build_fn=None, **sk_params):<br>
        self.sk_params = sk_params<br>
        super().__init__(build_fn=None, **sk_params)</p>
<p>    def __call__(self, callbacks=None, 
layer_sizes=None,activations=None,input_dim=0,init=’normal’,optimizer=’adam’,
 metrics=’accuracy’, loss=’binary_crossentropy’, 
use_dropout_input=False, use_dropout_hidden=False):<br>
        “””<br>
        Constructs, compiles and return a Keras model<br>
        Implements the “build_fn” function</p>
<p>        Returns a “Sequential” model<br>
        “””<br>
        # Code to build a model (that would typically go in “build_fn”) goes here.<br>
        return model</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-420731" data-commentid="420731" data-postid="2967" data-belowelement="comment-420731" data-respondelement="respond" aria-label="Reply to Rishi">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-420808" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4">

	      	<div id="li-comment-420808" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">November 22, 2017 at 10:47 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-420808" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Well done!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-420808" data-commentid="420808" data-postid="2967" data-belowelement="comment-420808" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-414306" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-414306" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/e7d25fe9e5f6228aa13a97665b1c3413.jfif" srcset="https://secure.gravatar.com/avatar/e7d25fe9e5f6228aa13a97665b1c3413?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Tmn</span>
	                <span class="date">September 20, 2017 at 2:45 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-414306" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>I can not thank you enough. I am sure that there are many people like
 me  who have learnt a lost from your tutorial on both “R” and “Python”.
 I have been following your tutorial for more than 3 year now. Before I 
was using R however, recently I moved to python for Deep learning. And I
 find your tutorial as usual, exceptional. I think Andrew Ng and  CS231n
 (andrej karpathy),  theoretical course and your programming course on 
deep learning is one of the best in the world. You rock! Thanks a lot.</p>
<p>I do have a question <img draggable="false" class="emoji" alt="🙂" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1f642.svg"> as well.<br>
The grid search parameter tuning works perfectly with CPU. I agree with 
your suggestion not to tune everything at once. Now I moved to GPU 
implementation. I was able to execute the code if I chose options 
n_job=1. However, if I do multi-threading n_job=-1. I am getting 
“CUDA_ERROR_OUT_OF_MEMORY”. I have GeForce GTX 1080. Did you happen to 
encounter  similar kind of error? I will post you the error log if 
needed.  </p>
<p>Once, again thank you.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-414306" data-commentid="414306" data-postid="2967" data-belowelement="comment-414306" data-respondelement="respond" aria-label="Reply to Tmn">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-414329" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-414329" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">September 20, 2017 at 6:00 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-414329" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks for all of your support!</p>
<p>Yes, I have the same and I would recommend using a “single thread” and let the GPU do its thing for a given single run.</p>
<p>In general, I’d recommend contrasting different approaches to grid 
searching (cpu/gpu) and use the approach that is overall faster for your
 specific tests.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-414329" data-commentid="414329" data-postid="2967" data-belowelement="comment-414329" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-414380" class="comment even depth-3 parent">

	      	<div id="li-comment-414380" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/e7d25fe9e5f6228aa13a97665b1c3413.jfif" srcset="https://secure.gravatar.com/avatar/e7d25fe9e5f6228aa13a97665b1c3413?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Tmn</span>
	                <span class="date">September 20, 2017 at 11:33 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-414380" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,<br>
Thank you for the response. The parameter search using CPU (n_job=-1) is
 (2.961489-4.977758) while using GPU (n_job=1) is 
(140.101048-142.151023) second.  </p>
<p>One more thing, after grid search I have value for parameters 
{batch_size, activation, neurons, learn_rate..} and accuracy around 90%.
 However, I wonder  why reusing these model parameter  does not provide 
the same results, now accuracy is 52%. Even though I executed it many 
times with same parameter the accuracy remains the same (52%). I could 
not achieve the accuracy as shown in grid search using best model 
parameter. I am doing 5-fold CV I do not expect the accuracy to be the 
same since it is stochastic process but it should be around SD±5%. What 
do you think? Did you also happen to encounter the same thing ?</p>
<p>Also the best parameter values changes in each executions with an accuracy SD±5%.</p>
<p>Thanks</p>
<p>P.S:<br>
Below code is something I am doing to limit GPU memory usage and run 
multiple grid search. However, we should know the memory usage in 
advance (cs231n.github.io/convolutional-networks/#case). Let me know if 
it makes sense. </p>
<p>Also, we can use n-job. I tried with n_job = 2 however the GPU memory
 is allocated based on fraction. I am searching how to allocated memory 
based on MB. I will do  more research on this “CUDA_ERROR_OUT_OF_MEMORY”
 and update you.</p>
<p>import tensorflow as tf<br>
from keras.backend.tensorflow_backend import set_session<br>
config = tf.ConfigProto()<br>
config.gpu_options.per_process_gpu_memory_fraction = 0.3<br>
set_session(tf.Session(config=config))</p>
<p>Thanks!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-414380" data-commentid="414380" data-postid="2967" data-belowelement="comment-414380" data-respondelement="respond" aria-label="Reply to Tmn">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-414411" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4 parent">

	      	<div id="li-comment-414411" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">September 21, 2017 at 5:42 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-414411" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>The results for the standalone model should fit into the 
distribution of the grid search results – if you repeated each grid 
search result many times, e.g. 10-30. See this post on evaluating model 
skill of neural networks:<br>
<a href="https://machinelearningmastery.com/evaluate-skill-deep-learning-models/" rel="nofollow">https://machinelearningmastery.com/evaluate-skill-deep-learning-models/</a></p>
<p>Nice, sorry, I cannot give you good advice on grid searching with the
 GPU, it is not something I do generally. I am more likely to run 
instances serially or across AWS instances.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-414411" data-commentid="414411" data-postid="2967" data-belowelement="comment-414411" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-415750" class="comment even depth-5">

	      	<div id="li-comment-415750" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/4f87b9c712e61cb3669690d18ea2549d.jfif" srcset="https://secure.gravatar.com/avatar/4f87b9c712e61cb3669690d18ea2549d?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">TMN</span>
	                <span class="date">October 6, 2017 at 2:12 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-415750" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>Could you please help on how to do features normalization while doing
 the grid search and cross-validation. Is normalization is done 
automatically here, GridSearchCV(estimator=model, param_grid=param_grid,
 n_jobs=15,cv=rkf)? If I normalize the features during training X = 
scaler.transform(X_train), this will introduce bias in cross-validation.
 Also, if possible, can you please provide me references on using 
scikit-learn wrapper with Keras for advance options, is their any 
limitation on wrapper ?<br>
Thanks   </p>
<p>Without normalization:<br>
Best: 0.535211 using {‘learn_rate’: 0.01, ‘dropout_rate’: 25, 
‘batch_size’: 40, ‘neurons’: 200, ‘init_mode’: ‘lecun_uniform’, 
‘optimizer’: ‘SGD’, ‘activation’: ‘relu’, ‘epochs’: 1000}</p>
<p>With normalization:<br>
Best: 0.695775 using {‘optimizer’: ‘SGD’, ‘batch_size’: 132, 
‘init_mode’: ‘lecun_uniform’, ‘epochs’: 1000, ‘learn_rate’: 0.01, 
‘dropout_rate’: 25, ‘neurons’: 200, ‘activation’: ‘relu’}</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-415770" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-5">

	      	<div id="li-comment-415770" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">October 6, 2017 at 5:37 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-415770" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Perhaps you can normalize your data prior to the grid search?</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-415802" class="comment even depth-5">

	      	<div id="li-comment-415802" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/4f87b9c712e61cb3669690d18ea2549d.jfif" srcset="https://secure.gravatar.com/avatar/4f87b9c712e61cb3669690d18ea2549d?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">TMN</span>
	                <span class="date">October 6, 2017 at 10:59 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-415802" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I normalize my data prior to grid search using X = 
scaler.transform(X_train) but dont you think it would introduce bias in 
the performance. Normally, I expect to normalize train set and use that 
normalization factor to normalize test or validation set before 
prediction. May be I did not understand you properly, how do you do 
normalization prior to grid search?</p>
<p>Thanks</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-415809" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-5">

	      	<div id="li-comment-415809" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">October 6, 2017 at 11:07 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-415809" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, it’s a struggle or trade-off.</p>
<p>Perhaps you can see if a Pipeline will work in the grid search, it may, but I expect it will error.</p>
<p>Perhaps the bias is minor and you can ignore it.</p>
<p>Perhaps you can implement your own grid search loop to only use training data to calculate data scaling coefficients.</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-415848" class="comment even depth-5">

	      	<div id="li-comment-415848" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/4f87b9c712e61cb3669690d18ea2549d.jfif" srcset="https://secure.gravatar.com/avatar/4f87b9c712e61cb3669690d18ea2549d?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">TMN</span>
	                <span class="date">October 6, 2017 at 6:44 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-415848" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I started looking at the pipeline (<a href="http://scikit-learn.org/stable/modules/pipeline.html" rel="nofollow">http://scikit-learn.org/stable/modules/pipeline.html</a>)
 on how they have been using it for SVM, lets see. I would expect the 
pipeline to work for Keras as well, as this is a classical problem in 
machine learning. Why do you expect error here?  I wanted to take the 
full advantage from automatic grid search. Well, the final option will 
be to implement my own grid search. </p>
<p>The bias is really significant in 5-repeated 10-fold CV. Thanks</p>
<p>Without normalization:<br>
Best: 0.535211 using {‘learn_rate’: 0.01, ‘dropout_rate’: 25, 
‘batch_size’: 40, ‘neurons’: 200, ‘init_mode’: ‘lecun_uniform’, 
‘optimizer’: ‘SGD’, ‘activation’: ‘relu’, ‘epochs’: 1000}</p>
<p>With normalization:<br>
Best: 0.695775 using {‘optimizer’: ‘SGD’, ‘batch_size’: 132, 
‘init_mode’: ‘lecun_uniform’, ‘epochs’: 1000, ‘learn_rate’: 0.01, 
‘dropout_rate’: 25, ‘neurons’: 200, ‘activation’: ‘relu’}</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-415887" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-5">

	      	<div id="li-comment-415887" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">October 7, 2017 at 5:51 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-415887" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>If it works, that is great. I have seen cases where when grid search + keras gets fancy it causes errors.</p>
<p>I have a tutorial on Pipeline here that might help:<br>
<a href="https://machinelearningmastery.com/automate-machine-learning-workflows-pipelines-python-scikit-learn/" rel="nofollow">https://machinelearningmastery.com/automate-machine-learning-workflows-pipelines-python-scikit-learn/</a></p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-414498" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-414498" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/0061a1b39292e9ad7b769a62c185e7c5.jfif" srcset="https://secure.gravatar.com/avatar/0061a1b39292e9ad7b769a62c185e7c5?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">HWU</span>
	                <span class="date">September 22, 2017 at 6:52 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-414498" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>This is such a great, thorough tutorial. Thanks for keeping your 
tutorials up to date! It’s so nice finding a resource with examples that
 you know will work because they’ve been tested on recent versions of 
required packages.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-414498" data-commentid="414498" data-postid="2967" data-belowelement="comment-414498" data-respondelement="respond" aria-label="Reply to HWU">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-414589" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-414589" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">September 23, 2017 at 5:32 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-414589" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-414589" data-commentid="414589" data-postid="2967" data-belowelement="comment-414589" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-415076" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-415076" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/08cd14dd9af7cf83fb5126b7f5ca0a1b.jfif" srcset="https://secure.gravatar.com/avatar/08cd14dd9af7cf83fb5126b7f5ca0a1b?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Marjan</span>
	                <span class="date">September 29, 2017 at 1:08 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-415076" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thank you for your great tutorial.  I tried to use it for my 
model with multiple inputs. but It didn`t work. I found that the 
scikit-learn wrapper does not work for multiple inputs. it gives me an 
error for grid.fit([input1,input2],y)<br>
Do you have any suggestion to handle it?<br>
Thanks,</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-415076" data-commentid="415076" data-postid="2967" data-belowelement="comment-415076" data-respondelement="respond" aria-label="Reply to Marjan">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-415152" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-415152" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">September 30, 2017 at 7:34 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-415152" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sorry I do not. Perhaps run the grid search manually (e.g. your own for loop)?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-415152" data-commentid="415152" data-postid="2967" data-belowelement="comment-415152" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-415665" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-415665" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/60a51e0353b4d4515f7579911fcf7e3f.jfif" srcset="https://secure.gravatar.com/avatar/60a51e0353b4d4515f7579911fcf7e3f?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Buz Fifer</span>
	                <span class="date">October 5, 2017 at 7:06 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-415665" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>When I run your code to tune the dropout_rate, I get the following error:<br>
ValueError: dropout_rate is not a legal parameter</p>
<p>In fact, I get this error for all labels except epochs and 
batch_size. Both of these were recognized and ran fine. I could not find
 a reference to valid labels anywhere, even in API docs. Any 
suggestions?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-415665" data-commentid="415665" data-postid="2967" data-belowelement="comment-415665" data-respondelement="respond" aria-label="Reply to Buz Fifer">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-415709" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-415709" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">October 5, 2017 at 5:16 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-415709" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>What do you mean by valid labels exactly?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-415709" data-commentid="415709" data-postid="2967" data-belowelement="comment-415709" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-415758" class="comment even depth-3">

	      	<div id="li-comment-415758" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/60a51e0353b4d4515f7579911fcf7e3f.jfif" srcset="https://secure.gravatar.com/avatar/60a51e0353b4d4515f7579911fcf7e3f?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Buz Fifer</span>
	                <span class="date">October 6, 2017 at 3:02 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-415758" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sorry, I should have included the code in the first place. I have
 added comments in the code to show exactly what I tried for each 
parameter. </p>
<p>    #  ———— Define Keras Classifier Wrapper<br>
    model1 = KerasClassifier(build_fn=kerasModel1, epochs=5, batch_size=10, verbose=0)</p>
<p>    # ———– define the grid search parameters<br>
    mybatchs = [10, 20, 128]<br>
    myepochs = [5, 10, 20, 50, 60, 80, 100]<br>
    mylearn = [0.001, 0.002, 0.0025, 0.003]<br>
    myopts = [‘Adam’, ‘Nadam’, ‘RMSprop’]<br>
    myinits = [‘uniform’, ‘normal’, ‘lecun_uniform’, ‘lecun_normal’, ‘glorot_uniform’, ‘glorot_normal’]<br>
    mydrop = [0.10, 0.20, 0.30, 0.35, 0.40, 0.50, 0.60, 0.70, 0.80]</p>
<p># ————- Not Recognized<br>
    #param_grid = dict(optimizer=myopts)<br>
    #param_grid = dict(learn_rate=mylearn)<br>
    #param_grid = dict(learning_rate=mylearn)<br>
    #param_grid = dict(init=myinits)<br>
    #param_grid = dict(init_mode=myinits)<br>
    #param_grid = dict(dropout_rate=mydrop)</p>
<p> # ———— Recognized<br>
    #param_grid = dict(epochs=myepochs)            # —– OK<br>
    #param_grid = dict(batch_size=mybatchs)        # —– OK</p>
<p>I removed comment # and ran each one separately. For example, running
 the first param_grid values resulted in: Error – optimizer is not a 
valid parameter. They all got the same rejection notice except for 
epochs and batch_size.<br>
I hope that helps.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-415758" data-commentid="415758" data-postid="2967" data-belowelement="comment-415758" data-respondelement="respond" aria-label="Reply to Buz Fifer">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-415759" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-415759" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/60a51e0353b4d4515f7579911fcf7e3f.jfif" srcset="https://secure.gravatar.com/avatar/60a51e0353b4d4515f7579911fcf7e3f?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Buz Fifer</span>
	                <span class="date">October 6, 2017 at 3:09 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-415759" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Just to be clearer, each parameter had it’s own name in the error message as follows:</p>
<p>Error – optimizer is not a valid parameter<br>
Error – learn_rate is not a valid parameter<br>
Error – learning_rate is not a valid parameter<br>
Error – init is not a valid parameter<br>
Error – init_mode is not a valid parameter<br>
Error – dropout_rate is not a valid parameter</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-415759" data-commentid="415759" data-postid="2967" data-belowelement="comment-415759" data-respondelement="respond" aria-label="Reply to Buz Fifer">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-415771" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-415771" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">October 6, 2017 at 5:39 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-415771" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>That is odd, I don’t have any good ideas, other than continue to 
debug and try different variations to see if you can expose the cause of
 the issue.</p>
<p>Double check all of your python libraries are up to date.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-415771" data-commentid="415771" data-postid="2967" data-belowelement="comment-415771" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-415862" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-415862" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/b0e460c3d26494201784ebe9880b5a75.jfif" srcset="https://secure.gravatar.com/avatar/b0e460c3d26494201784ebe9880b5a75?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">ritika</span>
	                <span class="date">October 6, 2017 at 11:49 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-415862" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason, Very nice tutorial..very well explained</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-415862" data-commentid="415862" data-postid="2967" data-belowelement="comment-415862" data-respondelement="respond" aria-label="Reply to ritika">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-415893" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-415893" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">October 7, 2017 at 5:55 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-415893" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-415893" data-commentid="415893" data-postid="2967" data-belowelement="comment-415893" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-416998" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-416998" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/02af56754af67009cef2171451716ab1.jfif" srcset="https://secure.gravatar.com/avatar/02af56754af67009cef2171451716ab1?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">TC</span>
	                <span class="date">October 17, 2017 at 10:27 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-416998" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason thanks for the great post.  </p>
<p>Let’s say I’m using 5 fold CV on a relatively small dataset (not 
necessarily for a deep learning model).  In this case, the variance of 
the performance metric might be quite high, and just by chance, a point 
on the grid that is in reality far from optimal, might be selected as 
the “best”.  </p>
<p>So are there any approaches to smooth out the response surface of the
 grid search, to deal with “spikes” in performance due to variance?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-416998" data-commentid="416998" data-postid="2967" data-belowelement="comment-416998" data-respondelement="respond" aria-label="Reply to TC">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-417017" class="comment byuser comment-author-jasonb bypostauthor even depth-2 parent">

	      	<div id="li-comment-417017" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">October 17, 2017 at 4:05 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-417017" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Wonderful question.</p>
<p>Yes, we can approach this problem by increasing the number of repeats (not folds) of each param combination.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-417017" data-commentid="417017" data-postid="2967" data-belowelement="comment-417017" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-417226" class="comment odd alt depth-3 parent">

	      	<div id="li-comment-417226" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/02af56754af67009cef2171451716ab1.jfif" srcset="https://secure.gravatar.com/avatar/02af56754af67009cef2171451716ab1?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">TC</span>
	                <span class="date">October 20, 2017 at 8:40 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-417226" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason, by “number of repeats” do you mean to just repeat the process many times, with perhaps a different random seed?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-417226" data-commentid="417226" data-postid="2967" data-belowelement="comment-417226" data-respondelement="respond" aria-label="Reply to TC">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-417314" class="comment byuser comment-author-jasonb bypostauthor even depth-4">

	      	<div id="li-comment-417314" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">October 21, 2017 at 5:23 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-417314" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Exactly.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-417314" data-commentid="417314" data-postid="2967" data-belowelement="comment-417314" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-417281" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-417281" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/0f5cb9519f644248ef6a8763668a2067.jfif" srcset="https://secure.gravatar.com/avatar/0f5cb9519f644248ef6a8763668a2067?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Lea</span>
	                <span class="date">October 20, 2017 at 10:09 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-417281" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thank you for this great tutorial! I tried to adapt the code for a
 CNN, but I am running constantly in the same error. May anyone help? </p>
<p>That is the code:</p>
<p>def create_model(nb_filters=3, nb_conv=2, pool=20):<br>
    model = Sequential()<br>
    model.add(Convolution1D(nb_filters, nb_conv, activation=’relu’,<br>
                            input_shape=(X.shape[1], X.shape[2]), padding=”same”))<br>
    model.add(MaxPooling1D(pool))<br>
    model.add(Flatten())<br>
    model.add(Dense(1, activation=’sigmoid’))<br>
    model.compile(loss=’binary_crossentropy’, optimizer=’adam’, metrics=[‘accuracy’])<br>
    model.summary()<br>
    return model</p>
<p>model = KerasClassifier(build_fn=create_model(), verbose=0)</p>
<p>nb_conv = [2, 4, 6, 8, 10]<br>
pool= [10, 20, 30, 50]<br>
param_grid = dict(nb_conv=nb_conv, epochs=pool)<br>
grid = GridSearchCV(estimator=model, param_grid=param_grid)<br>
grid_result = grid.fit(X, y)</p>
<p>And the error I am getting is “nb_conv is not a legal parameter”. Unfortunately, I do not understand why.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-417281" data-commentid="417281" data-postid="2967" data-belowelement="comment-417281" data-respondelement="respond" aria-label="Reply to Lea">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-417334" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-417334" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">October 21, 2017 at 5:37 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-417334" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>The API has changed:<br>
<a href="https://keras.io/layers/convolutional/" rel="nofollow">https://keras.io/layers/convolutional/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-417334" data-commentid="417334" data-postid="2967" data-belowelement="comment-417334" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-417460" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-417460" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/e64fbdefc9c5622f7a991adc14c8c08b.jfif" srcset="https://secure.gravatar.com/avatar/e64fbdefc9c5622f7a991adc14c8c08b?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">went</span>
	                <span class="date">October 22, 2017 at 2:55 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-417460" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>Great post and Thank you.</p>
<p>What do you think is the best sequence when tuning all those 
Hyperparameters? I think difference sequence will lead to difference 
final Hyperparameters..</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-417460" data-commentid="417460" data-postid="2967" data-belowelement="comment-417460" data-respondelement="respond" aria-label="Reply to went">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-417483" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-417483" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">October 22, 2017 at 5:32 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-417483" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>This post has some ideas (at the end):<br>
<a href="https://machinelearningmastery.com/gentle-introduction-mini-batch-gradient-descent-configure-batch-size/" rel="nofollow">https://machinelearningmastery.com/gentle-introduction-mini-batch-gradient-descent-configure-batch-size/</a></p>
<p>Also see the referenced paper.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-417483" data-commentid="417483" data-postid="2967" data-belowelement="comment-417483" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-417579" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-417579" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/a069d886d5d270e3794fadea53fe0272.png" srcset="https://secure.gravatar.com/avatar/a069d886d5d270e3794fadea53fe0272?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Bgie</span>
	                <span class="date">October 23, 2017 at 6:28 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-417579" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>What a great blog, I very much appreciate you sharing some of your expertise!</p>
<p>I want to grid search the hyperparams from my CNN, but I’m using data
 augmentation with ImageDataGenerator. So I’m not calling model.fit but 
model.fit_generator for the actual training.<br>
This does not seem to be supported through the grid search..<br>
Am I forced to write my own KerasClassifier implementation?</p>
<p>Would you advise to just fall back to using (nested) for loops 
instead, or would I be missing some ‘magic’ from the existing scikit 
gridsearch?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-417579" data-commentid="417579" data-postid="2967" data-belowelement="comment-417579" data-respondelement="respond" aria-label="Reply to Bgie">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-417614" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-417614" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">October 23, 2017 at 4:10 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-417614" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I would recommend writing your own for loops to grid search instead.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-417614" data-commentid="417614" data-postid="2967" data-belowelement="comment-417614" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-417942" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-417942" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/029d4ac64563bd9db1b8caa4eacbe3ab.png" srcset="https://secure.gravatar.com/avatar/029d4ac64563bd9db1b8caa4eacbe3ab?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Shubham Kumar</span>
	                <span class="date">October 26, 2017 at 3:58 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-417942" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hey Jason!</p>
<p>Needed help with model improvement!<br>
Can you help me in understanding how to realize whether your model is suffering from<br>
bad local minima, vanishing/exploding gradient problem?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-417942" data-commentid="417942" data-postid="2967" data-belowelement="comment-417942" data-respondelement="respond" aria-label="Reply to Shubham Kumar">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-417972" class="comment byuser comment-author-jasonb bypostauthor even depth-2 parent">

	      	<div id="li-comment-417972" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">October 26, 2017 at 5:34 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-417972" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>If you have exploding or vanishing gradients, then you will have NaN outputs.</p>
<p>This post will give you ideas on how to lift skill:<br>
<a href="http://machinelearningmastery.com/improve-deep-learning-performance/" rel="nofollow">http://machinelearningmastery.com/improve-deep-learning-performance/</a></p>
<p>This post will give you advice on how to effectively evaluate your model:<br>
<a href="https://machinelearningmastery.com/evaluate-skill-deep-learning-models/" rel="nofollow">https://machinelearningmastery.com/evaluate-skill-deep-learning-models/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-417972" data-commentid="417972" data-postid="2967" data-belowelement="comment-417972" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-419116" class="comment odd alt depth-3 parent">

	      	<div id="li-comment-419116" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/029d4ac64563bd9db1b8caa4eacbe3ab.png" srcset="https://secure.gravatar.com/avatar/029d4ac64563bd9db1b8caa4eacbe3ab?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Shubham Kumar</span>
	                <span class="date">November 6, 2017 at 7:05 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-419116" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>NaN outputs as in my predictions ?<br>
Or the weights ?<br>
If exploding gradient then weight will be very large (probably NaN) hence output would also be NaN.<br>
But how will this logic be used for vanishing gradients. I  this case the weights basically stop changing r8?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-419116" data-commentid="419116" data-postid="2967" data-belowelement="comment-419116" data-respondelement="respond" aria-label="Reply to Shubham Kumar">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-419118" class="comment even depth-4">

	      	<div id="li-comment-419118" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/029d4ac64563bd9db1b8caa4eacbe3ab.png" srcset="https://secure.gravatar.com/avatar/029d4ac64563bd9db1b8caa4eacbe3ab?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Shubham Kumar</span>
	                <span class="date">November 6, 2017 at 7:07 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-419118" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Should I use some kind of code that checks by how much the 
weights at each layer are changing…and if after a certain threshold they
 haven’t changed by a certain amount, I’ll declare vanishing gradient !</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-419118" data-commentid="419118" data-postid="2967" data-belowelement="comment-419118" data-respondelement="respond" aria-label="Reply to Shubham Kumar">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-419188" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4">

	      	<div id="li-comment-419188" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">November 7, 2017 at 9:44 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-419188" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Try gradient clipping on the optimization algorithm.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-419188" data-commentid="419188" data-postid="2967" data-belowelement="comment-419188" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-418144" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-418144" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/5a1b1f2340ed9290f79b0220760dcb4a.jfif" srcset="https://secure.gravatar.com/avatar/5a1b1f2340ed9290f79b0220760dcb4a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Mustafa Murat ARAT</span>
	                <span class="date">October 28, 2017 at 12:45 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-418144" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I have a question for you, Jason and for general audience. I 
tried to find optimal number of neurons for one of the hidden layers. i 
did loop over my function which contains my deep learning model. It is 
fast enough for the values I define and I get a result based on 
accuracy. However, when I use your code, it is extremely slow and never 
reached to an end. How long does it take on your computer?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-418144" data-commentid="418144" data-postid="2967" data-belowelement="comment-418144" data-respondelement="respond" aria-label="Reply to Mustafa Murat ARAT">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-418172" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-418172" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">October 28, 2017 at 5:14 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-418172" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You could try to test fewer parameters or try to search on a smaller dataset?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-418172" data-commentid="418172" data-postid="2967" data-belowelement="comment-418172" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-418274" class="comment even depth-3 parent">

	      	<div id="li-comment-418274" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/5a1b1f2340ed9290f79b0220760dcb4a.jfif" srcset="https://secure.gravatar.com/avatar/5a1b1f2340ed9290f79b0220760dcb4a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Mustafa Murat ARAT</span>
	                <span class="date">October 29, 2017 at 4:12 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-418274" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hey Jason,</p>
<p>Thank you for your quick reply. I try grid search for number of 
neurons on Iris data set for the purpose of learning. I scale the data 
first and then transform and encode the dependent variable. However, 
first of all, even though I use small data set or fewer parameters, it 
is slow; second of all, when I get the results, it is all zero. This is 
very basic example and I am pretty much sure that my code is correct but
 I guess I am missing out something. </p>
<p>Best: 0.000000 using {‘neurons’: 3}<br>
0.000000 (0.000000) with: {‘neurons’: 3}<br>
0.000000 (0.000000) with: {‘neurons’: 5}</p>
<p>THE CODE:</p>
<p>from pandas import read_csv<br>
import numpy<br>
from sklearn.preprocessing import LabelEncoder<br>
from sklearn.preprocessing import StandardScaler<br>
from keras.wrappers.scikit_learn import KerasClassifier<br>
from keras.models import Sequential<br>
from keras.layers import Dense<br>
from keras.utils import np_utils<br>
from sklearn.model_selection import GridSearchCV</p>
<p>dataframe=read_csv(“iris.csv”, header=None)<br>
dataset=dataframe.values<br>
X=dataset[:,0:4].astype(float)<br>
Y=dataset[:,4]</p>
<p>seed=7<br>
numpy.random.seed(seed)</p>
<p>#encode class values as integers<br>
encoder = LabelEncoder()<br>
encoder.fit(Y)<br>
encoded_Y = encoder.transform(Y)<br>
#one-hot encoding<br>
dummy_y = np_utils.to_categorical(encoded_Y)</p>
<p>scaler = StandardScaler()<br>
X = scaler.fit_transform(X)</p>
<p>def create_model(n_neurons):<br>
    model = Sequential()<br>
    model.add(Dense(n_neurons, input_dim=X.shape[1], activation=’relu’)) # hidden layer<br>
    model.add(Dense(3, activation=’softmax’)) # output layer<br>
    model.compile(loss=’categorical_crossentropy’, optimizer=’adam’, metrics=[‘accuracy’])<br>
    return model</p>
<p>model = KerasClassifier(build_fn=create_model, epochs=100, batch_size=10, initial_epoch=0, verbose=0)<br>
# define the grid search parameters<br>
neurons=[3, 5]</p>
<p>#this does 3-fold classification. One can change k.<br>
param_grid = dict(n_neurons=neurons)<br>
grid = GridSearchCV(estimator=model, param_grid=param_grid, n_jobs=-1)<br>
grid_result = grid.fit(X, dummy_y)<br>
# summarize results<br>
print(“Best: %f using %s” % (grid_result.best_score_, grid_result.best_params_))<br>
means = grid_result.cv_results_[‘mean_test_score’]<br>
stds = grid_result.cv_results_[‘std_test_score’]<br>
params = grid_result.cv_results_[‘params’]<br>
for mean, stdev, param in zip(means, stds, params):<br>
    print(“%f (%f) with: %r” % (mean, stdev, param))</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-418274" data-commentid="418274" data-postid="2967" data-belowelement="comment-418274" data-respondelement="respond" aria-label="Reply to Mustafa Murat ARAT">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-418296" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4 parent">

	      	<div id="li-comment-418296" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">October 29, 2017 at 5:59 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-418296" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sorry, I cannot debug your code/problem for you.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-418296" data-commentid="418296" data-postid="2967" data-belowelement="comment-418296" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-418419" class="comment even depth-5">

	      	<div id="li-comment-418419" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/5a1b1f2340ed9290f79b0220760dcb4a.jfif" srcset="https://secure.gravatar.com/avatar/5a1b1f2340ed9290f79b0220760dcb4a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Mustafa Murat ARAT</span>
	                <span class="date">October 30, 2017 at 8:29 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-418419" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I totally understand you. Thank you so much, though. I figured 
out my mistake. Iris dataset is very well balanced so I need to shuffle 
the data because GridSearchCV is using 3-Fold Cross Validation.</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-418454" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-5">

	      	<div id="li-comment-418454" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">October 30, 2017 at 3:49 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-418454" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Glad to hear it.</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-419302" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-419302" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/b6aa4dd62807cee9ae6a8be54157c770.jfif" srcset="https://secure.gravatar.com/avatar/b6aa4dd62807cee9ae6a8be54157c770?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">jenny</span>
	                <span class="date">November 8, 2017 at 4:12 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-419302" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks for sharing such a wonderful tutorial. Learnt many new things.</p>
<p>How can i save all the models that the grid search is generation with identifiers for each model?</p>
<p>I am an R user. This how I do it in R to save models with passing parameter values to its names.</p>
<p>xgb.object &lt;- paste0('/path/xgb_disc20_new_',</p>
<p> sample.sizes[i], '_', s,'_',nrounds[j],'_',max.depth[k],'_',eta[l], '.RData')</p>
<p>write.table(cbind(sample.sizes[i], s,nrounds[j],max.depth[k],eta[l],tpr, tnr, acc, roc.area, </p>
<p>concordance),   paste0('/path/xgb_disc20_new_', min.sample.size,'_', max.sample.size, </p>
<p>'.csv'),   append=TRUE, sep=",",row.names=FALSE,col.names=FALSE)</p>
<p>How can this be achieved in python for keras(neural network) and other models in other libraries?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-419302" data-commentid="419302" data-postid="2967" data-belowelement="comment-419302" data-respondelement="respond" aria-label="Reply to jenny">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-419346" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-419346" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">November 8, 2017 at 9:29 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-419346" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I would recommend using grid search to find the parameters for a 
well performing model then train a new standalone model with those 
parameters that you can then save.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-419346" data-commentid="419346" data-postid="2967" data-belowelement="comment-419346" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-419424" class="comment even thread-even depth-1">

	      	<div id="li-comment-419424" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/b6aa4dd62807cee9ae6a8be54157c770.jfif" srcset="https://secure.gravatar.com/avatar/b6aa4dd62807cee9ae6a8be54157c770?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">jenny</span>
	                <span class="date">November 8, 2017 at 9:34 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-419424" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>thank you jason for your quick reply . I will try that way.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-419424" data-commentid="419424" data-postid="2967" data-belowelement="comment-419424" data-respondelement="respond" aria-label="Reply to jenny">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-420232" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-420232" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/d8e8ced78a8c0b3840add4d093b17d92.jfif" srcset="https://secure.gravatar.com/avatar/d8e8ced78a8c0b3840add4d093b17d92?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Wassim</span>
	                <span class="date">November 16, 2017 at 11:26 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-420232" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,<br>
Thank you for the great tutorial. I just have an issue when using 
exactly your code: when I try to parallelize the grid search with 
n_jobs=-1, I end up with the error “AttributeError: Can’t get attribute 
‘create_model’ on ” while it works well without parallelization. Any 
idea where the issue comes from?<br>
Thank you,<br>
Wassim</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-420232" data-commentid="420232" data-postid="2967" data-belowelement="comment-420232" data-respondelement="respond" aria-label="Reply to Wassim">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-420287" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-420287" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">November 17, 2017 at 9:25 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-420287" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I’m not sure, perhaps you cannot parallelize the grid search with Keras models.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-420287" data-commentid="420287" data-postid="2967" data-belowelement="comment-420287" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-421493" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-421493" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/b1cb5cb4b8e7778f0764cb1d1d9f9a2b.jfif" srcset="https://secure.gravatar.com/avatar/b1cb5cb4b8e7778f0764cb1d1d9f9a2b?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Sangwon Chae</span>
	                <span class="date">November 28, 2017 at 9:51 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-421493" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>The example code calculates the best score for accuracy to obtain the hyperparameter.</p>
<p>In my problem, I want to find RMSE rather than accuracy because it is regression problem (numerical prediction).</p>
<p>However, ‘grid_result.cv_resluts_’ only provides ‘fit_time’ and ‘score’, so it can not calculate RMSE.</p>
<p>What should I do?</p>
<p>Thank you.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-421493" data-commentid="421493" data-postid="2967" data-belowelement="comment-421493" data-respondelement="respond" aria-label="Reply to Sangwon Chae">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-421546" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-421546" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">November 29, 2017 at 8:23 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-421546" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You can change the configuration to calculate MSE (e.g. scoring=’neg_mean_squared_error’) and then take the square root.</p>
<p>Learn more here:<br>
<a href="http://scikit-learn.org/stable/modules/generated/sklearn.model_selection.GridSearchCV.html" rel="nofollow">http://scikit-learn.org/stable/modules/generated/sklearn.model_selection.GridSearchCV.html</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-421546" data-commentid="421546" data-postid="2967" data-belowelement="comment-421546" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-422176" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-422176" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/89d0969896fb6a859806eabd41e196ce.jfif" srcset="https://secure.gravatar.com/avatar/89d0969896fb6a859806eabd41e196ce?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Estelle</span>
	                <span class="date">December 5, 2017 at 7:37 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-422176" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>Thank you for this post.</p>
<p>Is there anything that prevents me to use Grid Search with train_on_batch() instead of fit()?</p>
<p>Thank you for letting me know.</p>
<p>All the best,</p>
<p>Estelle</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-422176" data-commentid="422176" data-postid="2967" data-belowelement="comment-422176" data-respondelement="respond" aria-label="Reply to Estelle">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-422184" class="comment byuser comment-author-jasonb bypostauthor even depth-2 parent">

	      	<div id="li-comment-422184" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">December 5, 2017 at 10:26 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-422184" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I think the wrapper is quite limited and does not offer this facility via sklearn.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-422184" data-commentid="422184" data-postid="2967" data-belowelement="comment-422184" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-422239" class="comment odd alt depth-3 parent">

	      	<div id="li-comment-422239" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/89d0969896fb6a859806eabd41e196ce.jfif" srcset="https://secure.gravatar.com/avatar/89d0969896fb6a859806eabd41e196ce?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Estelle</span>
	                <span class="date">December 6, 2017 at 8:15 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-422239" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks for your quick answer.</p>
<p>All the best,</p>
<p>Estelle</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-422239" data-commentid="422239" data-postid="2967" data-belowelement="comment-422239" data-respondelement="respond" aria-label="Reply to Estelle">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-422256" class="comment byuser comment-author-jasonb bypostauthor even depth-4">

	      	<div id="li-comment-422256" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">December 6, 2017 at 9:08 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-422256" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>No problem.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-422256" data-commentid="422256" data-postid="2967" data-belowelement="comment-422256" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-422489" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-422489" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/144cfdaee3128f729535ee1d45fb0a5f.jfif" srcset="https://secure.gravatar.com/avatar/144cfdaee3128f729535ee1d45fb0a5f?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Peter</span>
	                <span class="date">December 8, 2017 at 1:56 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-422489" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks very much for the tutorial. It is extremely helpful for my
 work. I came across a problem with grid search with Keras (tensorflow 
backend). I want to run the same grid search on different datasets. 
Everything works fine on the first dataset. But when I fit the grid 
search to the second dataset, the program got stuck there. I run the 
grid search with n_jobs=-1 and put keras.backend.clear_session() between
 two fits. You can replicate this issue by fit to the data twice in your
 examples. Could you please kindly help me with this issue?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-422489" data-commentid="422489" data-postid="2967" data-belowelement="comment-422489" data-respondelement="respond" aria-label="Reply to Peter">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-422497" class="comment byuser comment-author-jasonb bypostauthor even depth-2 parent">

	      	<div id="li-comment-422497" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">December 8, 2017 at 2:30 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-422497" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I’m sorry to hear that, perhaps change n_jobs to 1?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-422497" data-commentid="422497" data-postid="2967" data-belowelement="comment-422497" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-422498" class="comment odd alt depth-3 parent">

	      	<div id="li-comment-422498" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/144cfdaee3128f729535ee1d45fb0a5f.jfif" srcset="https://secure.gravatar.com/avatar/144cfdaee3128f729535ee1d45fb0a5f?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Peter</span>
	                <span class="date">December 8, 2017 at 2:40 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-422498" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks for the quick reply. It works when n_jobs=1, but I do need parallel threads for speed.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-422498" data-commentid="422498" data-postid="2967" data-belowelement="comment-422498" data-respondelement="respond" aria-label="Reply to Peter">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-422532" class="comment byuser comment-author-jasonb bypostauthor even depth-4 parent">

	      	<div id="li-comment-422532" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">December 9, 2017 at 5:34 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-422532" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>The neural network will be using all the cores, so running multiple threads may not offer any benefit.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-422532" data-commentid="422532" data-postid="2967" data-belowelement="comment-422532" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-422741" class="comment odd alt depth-5">

	      	<div id="li-comment-422741" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/144cfdaee3128f729535ee1d45fb0a5f.jfif" srcset="https://secure.gravatar.com/avatar/144cfdaee3128f729535ee1d45fb0a5f?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Peter</span>
	                <span class="date">December 11, 2017 at 9:53 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-422741" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I got it to work by just fitting one dataset in the python script
 and looping the python script over multiple datasets in a bash script. I
 am still not clear why second fitting fails in python, but this is a 
not-so-beautiful workaround.</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-422768" class="comment byuser comment-author-jasonb bypostauthor even depth-5">

	      	<div id="li-comment-422768" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">December 11, 2017 at 4:52 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-422768" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Glad to hear that you made some progress.</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-422927" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-422927" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/e3bdb278a840dd8d70a45c71d7f4ee79.jfif" srcset="https://secure.gravatar.com/avatar/e3bdb278a840dd8d70a45c71d7f4ee79?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Daniel Pamplona</span>
	                <span class="date">December 13, 2017 at 1:37 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-422927" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason</p>
<p>Thank you so much for sharing your knowledge.<br>
I am trying to optimize the number of hidden layers.<br>
I can´t figure it out how to do it with keras (actually I am wondering 
how to set up the function create_model in order to maximize the number 
of hidden layers)<br>
Could you please help me?<br>
Thank you</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-422927" data-commentid="422927" data-postid="2967" data-belowelement="comment-422927" data-respondelement="respond" aria-label="Reply to Daniel Pamplona">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-422953" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-422953" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">December 13, 2017 at 5:42 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-422953" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Perhaps the number of layers could be a parameter to your function.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-422953" data-commentid="422953" data-postid="2967" data-belowelement="comment-422953" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-423135" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-423135" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/ffc374afc4a711bd44e088af5608b4df.jfif" srcset="https://secure.gravatar.com/avatar/ffc374afc4a711bd44e088af5608b4df?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Sean</span>
	                <span class="date">December 15, 2017 at 1:43 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-423135" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>Thanks for this insightful and useful tutorial as always</p>
<p>No doubt your blog posts are arguably the best in the field of data sciences</p>
<p>Best wishes</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-423135" data-commentid="423135" data-postid="2967" data-belowelement="comment-423135" data-respondelement="respond" aria-label="Reply to Sean">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-423159" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-423159" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">December 15, 2017 at 5:36 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-423159" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks Sean.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-423159" data-commentid="423159" data-postid="2967" data-belowelement="comment-423159" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-423269" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-423269" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/ffc374afc4a711bd44e088af5608b4df.jfif" srcset="https://secure.gravatar.com/avatar/ffc374afc4a711bd44e088af5608b4df?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Sean</span>
	                <span class="date">December 16, 2017 at 12:06 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-423269" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello Jason,<br>
I decided to try the code on a textual data of about 3000 tweets having 
binary classification (Y) and the text corpus as (X). Started off with 
tuning the batch size and number of epochs</p>
<p>but got the following error:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5cf4a8ee42571673040420" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="readonly" style="-moz-tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;" wrap="soft">Name: 0, Length: 2185, dtype: object, names=['dense_1_input'], shapes=[(None, 8)], check_batch_axis=False, exception_prefix='input')
    148                         raise ValueError(
    149                             'Error when checking ' + exception_prefix +
    150                             ': expected ' + names[i] +
    151                             ' to have shape ' + str(shapes[i]) +
    152                             ' but got array with shape ' +
--&gt; 153                             str(array.shape))
        array.shape = (2185, 1)
    154     return arrays
    155 
    156 
    157 def _standardize_sample_or_class_weights(x_weight, output_names, weight_type):

ValueError: Error when checking input: expected dense_1_input to have shape (None, 8) but got array with shape (2185, 1)</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5cf4a8ee42571673040420-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee42571673040420-2">2</div><div class="crayon-num" data-line="crayon-5cf4a8ee42571673040420-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee42571673040420-4">4</div><div class="crayon-num" data-line="crayon-5cf4a8ee42571673040420-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee42571673040420-6">6</div><div class="crayon-num" data-line="crayon-5cf4a8ee42571673040420-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee42571673040420-8">8</div><div class="crayon-num" data-line="crayon-5cf4a8ee42571673040420-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee42571673040420-10">10</div><div class="crayon-num" data-line="crayon-5cf4a8ee42571673040420-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee42571673040420-12">12</div><div class="crayon-num" data-line="crayon-5cf4a8ee42571673040420-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee42571673040420-14">14</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5cf4a8ee42571673040420-1"><span class="crayon-v">Name</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">Length</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">2185</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dtype</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-t">object</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">names</span><span class="crayon-o">=</span><span class="crayon-sy">[</span><span class="crayon-s">'dense_1_input'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">shapes</span><span class="crayon-o">=</span><span class="crayon-sy">[</span><span class="crayon-sy">(</span><span class="crayon-v">None</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">8</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">check_batch_axis</span><span class="crayon-o">=</span><span class="crayon-t">False</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">exception_prefix</span><span class="crayon-o">=</span><span class="crayon-s">'input'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee42571673040420-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-cn">148</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-e">raise </span><span class="crayon-e">ValueError</span><span class="crayon-sy">(</span></div><div class="crayon-line" id="crayon-5cf4a8ee42571673040420-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-cn">149</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-s">'Error when checking '</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">exception_prefix</span><span class="crayon-h"> </span><span class="crayon-o">+</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee42571673040420-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-cn">150</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-s">': expected '</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">names</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">+</span></div><div class="crayon-line" id="crayon-5cf4a8ee42571673040420-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-cn">151</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-s">' to have shape '</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-e">str</span><span class="crayon-sy">(</span><span class="crayon-v">shapes</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">+</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee42571673040420-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-cn">152</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-s">' but got array with shape '</span><span class="crayon-h"> </span><span class="crayon-o">+</span></div><div class="crayon-line" id="crayon-5cf4a8ee42571673040420-7"><span class="crayon-o">--</span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-cn">153</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-e">str</span><span class="crayon-sy">(</span><span class="crayon-t">array</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee42571673040420-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-t">array</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">2185</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5cf4a8ee42571673040420-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-cn">154</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-i">arrays</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee42571673040420-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-cn">155</span><span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-5cf4a8ee42571673040420-11"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-cn">156</span><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee42571673040420-12"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-cn">157</span><span class="crayon-h"> </span><span class="crayon-e">def </span><span class="crayon-e">_standardize_sample_or_class_weights</span><span class="crayon-sy">(</span><span class="crayon-v">x_weight</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">output_names</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">weight_type</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5cf4a8ee42571673040420-13">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee42571673040420-14"><span class="crayon-v">ValueError</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-e">Error </span><span class="crayon-e">when </span><span class="crayon-e">checking </span><span class="crayon-v">input</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-e">expected </span><span class="crayon-e">dense_1_input </span><span class="crayon-st">to</span><span class="crayon-h"> </span><span class="crayon-e">have </span><span class="crayon-e">shape</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">None</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">8</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-e">but </span><span class="crayon-e">got </span><span class="crayon-t">array</span><span class="crayon-h"> </span><span class="crayon-e">with </span><span class="crayon-e">shape</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">2185</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0020 seconds] -->
<p></p>
<p>Here’s the modified code below:</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5cf4a8ee42579659379018" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" mouseover overlay hide delay" style="font-size: 12px !important; height: 18px !important; line-height: 18px !important; margin-top: -19px; display: none; position: absolute; z-index: 2;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon" style="background-size: 48px 128px; background-image: url(&quot;https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/plugins/crayon-syntax-highlighter/css/images/toolbar/buttons@2x.png&quot;);"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="dblclick" readonly="readonly" style="-moz-tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;" wrap="soft"># Use scikit-learn to grid search the batch size and epochs
import pandas as pd
import numpy as np
from sklearn.model_selection import GridSearchCV
from keras.models import Sequential
from keras.layers import Dense
from keras.wrappers.scikit_learn import KerasClassifier
# Function to create model, required for KerasClassifier
def create_model():
	# create model
	model = Sequential()
	model.add(Dense(12, input_dim=8, activation='relu'))
	model.add(Dense(1, activation='sigmoid'))
	# Compile model
	model.compile(loss='binary_crossentropy', optimizer='adam', metrics=['accuracy'])
	return model
# fix random seed for reproducibility
seed = 7
np.random.seed(seed)
# load dataset
dataset = pd.read_csv('training.txt', delimiter = '\t', quoting = 3, header = None)
# split into input (X) and output (Y) variables
X = dataset.iloc[:,0]
Y = dataset.iloc[:,1]
# create model
model = KerasClassifier(build_fn=create_model, verbose=0)
# define the grid search parameters
batch_size = [10, 20, 40, 60, 80, 100]
epochs = [10, 50, 100]
param_grid = dict(batch_size=batch_size, epochs=epochs)
grid = GridSearchCV(estimator=model, param_grid=param_grid, n_jobs=-1)
grid_result = grid.fit(X, Y)
# summarize results
print("Best: %f using %s" % (grid_result.best_score_, grid_result.best_params_))
means = grid_result.cv_results_['mean_test_score']
stds = grid_result.cv_results_['std_test_score']
params = grid_result.cv_results_['params']
for mean, stdev, param in zip(means, stds, params):
    print("%f (%f) with: %r" % (mean, stdev, param))</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5cf4a8ee42579659379018-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee42579659379018-2">2</div><div class="crayon-num" data-line="crayon-5cf4a8ee42579659379018-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee42579659379018-4">4</div><div class="crayon-num" data-line="crayon-5cf4a8ee42579659379018-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee42579659379018-6">6</div><div class="crayon-num" data-line="crayon-5cf4a8ee42579659379018-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee42579659379018-8">8</div><div class="crayon-num" data-line="crayon-5cf4a8ee42579659379018-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee42579659379018-10">10</div><div class="crayon-num" data-line="crayon-5cf4a8ee42579659379018-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee42579659379018-12">12</div><div class="crayon-num" data-line="crayon-5cf4a8ee42579659379018-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee42579659379018-14">14</div><div class="crayon-num" data-line="crayon-5cf4a8ee42579659379018-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee42579659379018-16">16</div><div class="crayon-num" data-line="crayon-5cf4a8ee42579659379018-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee42579659379018-18">18</div><div class="crayon-num" data-line="crayon-5cf4a8ee42579659379018-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee42579659379018-20">20</div><div class="crayon-num" data-line="crayon-5cf4a8ee42579659379018-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee42579659379018-22">22</div><div class="crayon-num" data-line="crayon-5cf4a8ee42579659379018-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee42579659379018-24">24</div><div class="crayon-num" data-line="crayon-5cf4a8ee42579659379018-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee42579659379018-26">26</div><div class="crayon-num" data-line="crayon-5cf4a8ee42579659379018-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee42579659379018-28">28</div><div class="crayon-num" data-line="crayon-5cf4a8ee42579659379018-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee42579659379018-30">30</div><div class="crayon-num" data-line="crayon-5cf4a8ee42579659379018-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee42579659379018-32">32</div><div class="crayon-num" data-line="crayon-5cf4a8ee42579659379018-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee42579659379018-34">34</div><div class="crayon-num" data-line="crayon-5cf4a8ee42579659379018-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee42579659379018-36">36</div><div class="crayon-num" data-line="crayon-5cf4a8ee42579659379018-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-5cf4a8ee42579659379018-38">38</div><div class="crayon-num" data-line="crayon-5cf4a8ee42579659379018-39">39</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5cf4a8ee42579659379018-1"><span class="crayon-p"># Use scikit-learn to grid search the batch size and epochs</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee42579659379018-2"><span class="crayon-e">import </span><span class="crayon-e">pandas </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-e">pd</span></div><div class="crayon-line" id="crayon-5cf4a8ee42579659379018-3"><span class="crayon-e">import </span><span class="crayon-e">numpy </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-e">np</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee42579659379018-4"><span class="crayon-e">from </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">model_selection </span><span class="crayon-e">import </span><span class="crayon-e">GridSearchCV</span></div><div class="crayon-line" id="crayon-5cf4a8ee42579659379018-5"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">models </span><span class="crayon-e">import </span><span class="crayon-e">Sequential</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee42579659379018-6"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">layers </span><span class="crayon-e">import </span><span class="crayon-e">Dense</span></div><div class="crayon-line" id="crayon-5cf4a8ee42579659379018-7"><span class="crayon-e">from </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-v">wrappers</span><span class="crayon-sy">.</span><span class="crayon-e">scikit_learn </span><span class="crayon-e">import </span><span class="crayon-v">KerasClassifier</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee42579659379018-8"><span class="crayon-p"># Function to create model, required for KerasClassifier</span></div><div class="crayon-line" id="crayon-5cf4a8ee42579659379018-9"><span class="crayon-e">def </span><span class="crayon-e">create_model</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee42579659379018-10"><span class="crayon-h">	</span><span class="crayon-p"># create model</span></div><div class="crayon-line" id="crayon-5cf4a8ee42579659379018-11"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Sequential</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee42579659379018-12"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">12</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">input_dim</span><span class="crayon-o">=</span><span class="crayon-cn">8</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'relu'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5cf4a8ee42579659379018-13"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">add</span><span class="crayon-sy">(</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-o">=</span><span class="crayon-s">'sigmoid'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee42579659379018-14"><span class="crayon-h">	</span><span class="crayon-p"># Compile model</span></div><div class="crayon-line" id="crayon-5cf4a8ee42579659379018-15"><span class="crayon-h">	</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">compile</span><span class="crayon-sy">(</span><span class="crayon-v">loss</span><span class="crayon-o">=</span><span class="crayon-s">'binary_crossentropy'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">optimizer</span><span class="crayon-o">=</span><span class="crayon-s">'adam'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">metrics</span><span class="crayon-o">=</span><span class="crayon-sy">[</span><span class="crayon-s">'accuracy'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee42579659379018-16"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">model</span></div><div class="crayon-line" id="crayon-5cf4a8ee42579659379018-17"><span class="crayon-p"># fix random seed for reproducibility</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee42579659379018-18"><span class="crayon-v">seed</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">7</span></div><div class="crayon-line" id="crayon-5cf4a8ee42579659379018-19"><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-v">random</span><span class="crayon-sy">.</span><span class="crayon-e">seed</span><span class="crayon-sy">(</span><span class="crayon-v">seed</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee42579659379018-20"><span class="crayon-p"># load dataset</span></div><div class="crayon-line" id="crayon-5cf4a8ee42579659379018-21"><span class="crayon-v">dataset</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">pd</span><span class="crayon-sy">.</span><span class="crayon-e">read_csv</span><span class="crayon-sy">(</span><span class="crayon-s">'training.txt'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">delimiter</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'\t'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">quoting</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">header</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">None</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee42579659379018-22"><span class="crayon-p"># split into input (X) and output (Y) variables</span></div><div class="crayon-line" id="crayon-5cf4a8ee42579659379018-23"><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">.</span><span class="crayon-v">iloc</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee42579659379018-24"><span class="crayon-v">Y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">dataset</span><span class="crayon-sy">.</span><span class="crayon-v">iloc</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5cf4a8ee42579659379018-25"><span class="crayon-p"># create model</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee42579659379018-26"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">KerasClassifier</span><span class="crayon-sy">(</span><span class="crayon-v">build_fn</span><span class="crayon-o">=</span><span class="crayon-v">create_model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">verbose</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5cf4a8ee42579659379018-27"><span class="crayon-p"># define the grid search parameters</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee42579659379018-28"><span class="crayon-v">batch_size</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">20</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">40</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">60</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">80</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">100</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5cf4a8ee42579659379018-29"><span class="crayon-v">epochs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">50</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">100</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee42579659379018-30"><span class="crayon-v">param_grid</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">dict</span><span class="crayon-sy">(</span><span class="crayon-v">batch_size</span><span class="crayon-o">=</span><span class="crayon-v">batch_size</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">epochs</span><span class="crayon-o">=</span><span class="crayon-v">epochs</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5cf4a8ee42579659379018-31"><span class="crayon-v">grid</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">GridSearchCV</span><span class="crayon-sy">(</span><span class="crayon-v">estimator</span><span class="crayon-o">=</span><span class="crayon-v">model</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">param_grid</span><span class="crayon-o">=</span><span class="crayon-v">param_grid</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_jobs</span><span class="crayon-o">=</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee42579659379018-32"><span class="crayon-v">grid_result</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">grid</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">Y</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5cf4a8ee42579659379018-33"><span class="crayon-p"># summarize results</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee42579659379018-34"><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">"Best: %f using %s"</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">grid_result</span><span class="crayon-sy">.</span><span class="crayon-v">best_score_</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">grid_result</span><span class="crayon-sy">.</span><span class="crayon-v">best_params_</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5cf4a8ee42579659379018-35"><span class="crayon-v">means</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">grid_result</span><span class="crayon-sy">.</span><span class="crayon-v">cv_results_</span><span class="crayon-sy">[</span><span class="crayon-s">'mean_test_score'</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee42579659379018-36"><span class="crayon-v">stds</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">grid_result</span><span class="crayon-sy">.</span><span class="crayon-v">cv_results_</span><span class="crayon-sy">[</span><span class="crayon-s">'std_test_score'</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5cf4a8ee42579659379018-37"><span class="crayon-v">params</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">grid_result</span><span class="crayon-sy">.</span><span class="crayon-v">cv_results_</span><span class="crayon-sy">[</span><span class="crayon-s">'params'</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5cf4a8ee42579659379018-38"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-v">mean</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">stdev</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">param </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">zip</span><span class="crayon-sy">(</span><span class="crayon-v">means</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">stds</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">params</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5cf4a8ee42579659379018-39"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">print</span><span class="crayon-sy">(</span><span class="crayon-s">"%f (%f) with: %r"</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">mean</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">stdev</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">param</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0038 seconds] -->
<p>Thanks</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-423269" data-commentid="423269" data-postid="2967" data-belowelement="comment-423269" data-respondelement="respond" aria-label="Reply to Sean">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-423336" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-423336" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">December 16, 2017 at 5:29 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-423336" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sorry to hear that, it’s not clear to me. Perhaps post to stackoverflow to get help debugging your code?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-423336" data-commentid="423336" data-postid="2967" data-belowelement="comment-423336" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-423303" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-423303" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/48da113c5b645ca4772f150d9bd3baba.jfif" srcset="https://secure.gravatar.com/avatar/48da113c5b645ca4772f150d9bd3baba?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Olivier Blais</span>
	                <span class="date">December 16, 2017 at 3:24 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-423303" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason, first thanks for your articles! Super useful!</p>
<p>I tried to execute the gripsearch but cam up with parallelism issues.
 I have a Windows OS and I get this error when I try to run the script 
on multiple cpus:</p>
<p>ImportError: [joblib] Attempting to do parallel computing without 
protecting your import on a system that does not support forking. To use
 parallel-computing in a script, you must protect your main loop using 
“if __name__ == ‘__main__'”. Please see the joblib documentation on 
Parallel for more information.</p>
<p>Do you know how I should address that?</p>
<p>Thanks in advance</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-423303" data-commentid="423303" data-postid="2967" data-belowelement="comment-423303" data-respondelement="respond" aria-label="Reply to Olivier Blais">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-423342" class="comment byuser comment-author-jasonb bypostauthor even depth-2 parent">

	      	<div id="li-comment-423342" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">December 16, 2017 at 5:35 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-423342" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Perhaps try setting the number of jobs to 1?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-423342" data-commentid="423342" data-postid="2967" data-belowelement="comment-423342" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-425016" class="comment odd alt depth-3 parent">

	      	<div id="li-comment-425016" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/48da113c5b645ca4772f150d9bd3baba.jfif" srcset="https://secure.gravatar.com/avatar/48da113c5b645ca4772f150d9bd3baba?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Olivier Blais</span>
	                <span class="date">December 28, 2017 at 5:30 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-425016" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason! Yes this works but it is very slow as this is not 
parallel. Do you understand why it cannot run in parallel and how to fix
 that?</p>
<p>Thanks again !<br>
Olivier</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-425016" data-commentid="425016" data-postid="2967" data-belowelement="comment-425016" data-respondelement="respond" aria-label="Reply to Olivier Blais">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-425027" class="comment byuser comment-author-jasonb bypostauthor even depth-4">

	      	<div id="li-comment-425027" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">December 28, 2017 at 2:10 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-425027" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>The backend is parallelized and the two levels of parallelization are in conflict.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-425027" data-commentid="425027" data-postid="2967" data-belowelement="comment-425027" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-423706" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-423706" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/4ec06604b4b9704f02ba854e94ce3d6b.jfif" srcset="https://secure.gravatar.com/avatar/4ec06604b4b9704f02ba854e94ce3d6b?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Shabnam</span>
	                <span class="date">December 18, 2017 at 2:21 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-423706" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks a lot for such a wonderful post. Overall, there are a lot 
of parameters that need to be tuned. I was thinking to use 
RandomizedSearchCV instead of GridSearchCV. Still, it will be time 
consuming for a lot of simulations. Do you have any suggestion for fast 
parameter tuning? For example, can we say that specific parameters have 
more effect on scores, so lets try to Grid/RandomizedSearchCV them 
first?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-423706" data-commentid="423706" data-postid="2967" data-belowelement="comment-423706" data-respondelement="respond" aria-label="Reply to Shabnam">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-423726" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-423726" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">December 18, 2017 at 3:32 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-423726" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, there are some great tips at the end of this post:<br>
<a href="https://machinelearningmastery.com/gentle-introduction-mini-batch-gradient-descent-configure-batch-size/" rel="nofollow">https://machinelearningmastery.com/gentle-introduction-mini-batch-gradient-descent-configure-batch-size/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-423726" data-commentid="423726" data-postid="2967" data-belowelement="comment-423726" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-424222" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-424222" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/55676389f8a807c4bd76664b16776c91.png" srcset="https://secure.gravatar.com/avatar/55676389f8a807c4bd76664b16776c91?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Henry</span>
	                <span class="date">December 20, 2017 at 10:51 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-424222" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Dear Jason,</p>
<p>Fantastic post, thank you for this wonderful tutorial.</p>
<p>I was wondering if it would be more appropriate to tune all the 
hyperparameters at one go instead of breaking it up into various parts 
as shown above – you may be doing it for the sake of visibility of how 
each component is tuned but would it be better to tune everything 
together since there might be “interactions between the hyperparameters”
 which would not be captured if they were tuned separately?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-424222" data-commentid="424222" data-postid="2967" data-belowelement="comment-424222" data-respondelement="respond" aria-label="Reply to Henry">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-424251" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-424251" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">December 21, 2017 at 5:25 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-424251" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>If you have the resources, then sure.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-424251" data-commentid="424251" data-postid="2967" data-belowelement="comment-424251" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-425467" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-425467" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/c3ca9682e18d179d2056e207536b7ce7.jfif" srcset="https://secure.gravatar.com/avatar/c3ca9682e18d179d2056e207536b7ce7?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Hao</span>
	                <span class="date">January 3, 2018 at 2:26 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-425467" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>Many thanks for a series of excellent posts!</p>
<p>I have an extremely imbalanced data set to study, of which #negative :
 #positive is about 100:1. When I built the first model, I performed 
10-fold validation and in each validation round, I use oversampling to 
add positive samples on training data, but not on testing data. Now I 
question is: if I want to perform hyperparameter search, how do I tell 
GridSearchCV() to do  oversampling for each round of cross-validation?</p>
<p>Many thanks</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-425467" data-commentid="425467" data-postid="2967" data-belowelement="comment-425467" data-respondelement="respond" aria-label="Reply to Hao">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-425486" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-425486" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">January 3, 2018 at 5:40 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-425486" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Good question, you might need to use a Pipeline and have data prep happen within it.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-425486" data-commentid="425486" data-postid="2967" data-belowelement="comment-425486" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-425837" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-425837" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/9ee305e63d55b45f80e0625164e65074.jfif" srcset="https://secure.gravatar.com/avatar/9ee305e63d55b45f80e0625164e65074?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Justin Solms</span>
	                <span class="date">January 7, 2018 at 11:24 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-425837" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello Jason</p>
<p>A good 2018 to you. I have a question about how Keras early stopping 
callbacks might be able to use the GridSearchCV k-fold generated 
validation data set as their <code>val_loss</code> or <code>val_acc</code>. The question I posted on StackOverflow but I wished to call your attention to it – should you so wish. </p>
<p><a href="https://stackoverflow.com/questions/48127550/how-do-i-implement-early-stopping-with-keras-and-the-sklearn-gridsearchcv-cross" rel="nofollow">https://stackoverflow.com/questions/48127550/how-do-i-implement-early-stopping-with-keras-and-the-sklearn-gridsearchcv-cross</a>  </p>
<p>Kind regards,<br>
Justin</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-425837" data-commentid="425837" data-postid="2967" data-belowelement="comment-425837" data-respondelement="respond" aria-label="Reply to Justin Solms">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-425852" class="comment byuser comment-author-jasonb bypostauthor even depth-2 parent">

	      	<div id="li-comment-425852" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">January 8, 2018 at 5:43 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-425852" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I would suggest not combing CV and early stopping.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-425852" data-commentid="425852" data-postid="2967" data-belowelement="comment-425852" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-431819" class="comment odd alt depth-3 parent">

	      	<div id="li-comment-431819" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/d55bb6a4519ac6baffec491ac2a4a900.jfif" srcset="https://secure.gravatar.com/avatar/d55bb6a4519ac6baffec491ac2a4a900?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">James</span>
	                <span class="date">March 11, 2018 at 6:16 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-431819" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Could early stopping be used as a substitute for grid searching epoch size?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-431819" data-commentid="431819" data-postid="2967" data-belowelement="comment-431819" data-respondelement="respond" aria-label="Reply to James">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-431839" class="comment byuser comment-author-jasonb bypostauthor even depth-4">

	      	<div id="li-comment-431839" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">March 11, 2018 at 6:30 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-431839" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, but you might need to code it up yourself. sklearn might blow up.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-431839" data-commentid="431839" data-postid="2967" data-belowelement="comment-431839" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-426848" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-426848" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/3604fd0e71629773cd6bec4359a250f6.jfif" srcset="https://secure.gravatar.com/avatar/3604fd0e71629773cd6bec4359a250f6?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">shwetabh shekhar</span>
	                <span class="date">January 19, 2018 at 12:03 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-426848" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello sir<br>
if i have large dataset the also we can do this hyperparameter tunning .<br>
If i have 70 to 80 feature column and about 50000 rows.<br>
can we apply this tunnig</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-426848" data-commentid="426848" data-postid="2967" data-belowelement="comment-426848" data-respondelement="respond" aria-label="Reply to shwetabh shekhar">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-426881" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-426881" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">January 19, 2018 at 6:31 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-426881" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sure, you might need a large computer or to split the work up across many computers.</p>
<p>Perhaps you can work with a sample of your data.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-426881" data-commentid="426881" data-postid="2967" data-belowelement="comment-426881" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-426853" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-426853" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/3604fd0e71629773cd6bec4359a250f6.jfif" srcset="https://secure.gravatar.com/avatar/3604fd0e71629773cd6bec4359a250f6?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">shwetabh shekhar</span>
	                <span class="date">January 19, 2018 at 1:13 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-426853" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>how to select the hidden layer if i have largedataset mentioned as above</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-426853" data-commentid="426853" data-postid="2967" data-belowelement="comment-426853" data-respondelement="respond" aria-label="Reply to shwetabh shekhar">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-426885" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-426885" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">January 19, 2018 at 6:33 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-426885" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I don’t follow, what do you mean exactly?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-426885" data-commentid="426885" data-postid="2967" data-belowelement="comment-426885" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-427858" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-427858" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/b083d3b60de9de6175ec8da648504747.jfif" srcset="https://secure.gravatar.com/avatar/b083d3b60de9de6175ec8da648504747?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Kafeel Basha</span>
	                <span class="date">January 29, 2018 at 5:48 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-427858" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Very good post.</p>
<p>Hyper Parameter Tuning: How can I do grid search on number of neuron/epochs or batch size using Keras interface in R.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-427858" data-commentid="427858" data-postid="2967" data-belowelement="comment-427858" data-respondelement="respond" aria-label="Reply to Kafeel Basha">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-427910" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-427910" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">January 30, 2018 at 9:48 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-427910" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sorry, I don’t have an example in R.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-427910" data-commentid="427910" data-postid="2967" data-belowelement="comment-427910" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-428163" class="comment odd alt thread-even depth-1">

	      	<div id="li-comment-428163" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/797a6e98d9e489c72171374fd40bf235.jfif" srcset="https://secure.gravatar.com/avatar/797a6e98d9e489c72171374fd40bf235?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">neha</span>
	                <span class="date">February 2, 2018 at 6:34 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-428163" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi,I am facing a basic query where i have training and test set.i
 built lstm on training and using history = model.fit(trainX, trainY, 
epochs=100, batch_size=50,<br>
                    validation_data=(testX, testY), verbose=0, shuffle=False) to fit my model.<br>
After this i tried to model.predict(testX) to get predicted Y values.Now
 that was basic code.i am now trying to apply gridsearch.what variation 
in the history statement code i have to make to apply grid =<br>
GridSearchCV(estimator=model, param_grid=param_grid, n_jobs=-1)<br>
grid_result = grid.fit(testX, testY, verbose=0, shuffle=False)</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-428163" data-commentid="428163" data-postid="2967" data-belowelement="comment-428163" data-respondelement="respond" aria-label="Reply to neha">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-428164" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-428164" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/797a6e98d9e489c72171374fd40bf235.jfif" srcset="https://secure.gravatar.com/avatar/797a6e98d9e489c72171374fd40bf235?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">neha</span>
	                <span class="date">February 2, 2018 at 6:50 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-428164" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>can gridsearchcv work for time series as well?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-428164" data-commentid="428164" data-postid="2967" data-belowelement="comment-428164" data-respondelement="respond" aria-label="Reply to neha">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-428193" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-428193" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">February 2, 2018 at 8:25 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-428193" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Not really. You will have to write your own for loops and perform walk forward validation.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-428193" data-commentid="428193" data-postid="2967" data-belowelement="comment-428193" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-428225" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-428225" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/f8675c9cdb374c2350f3240e4e6a9e66.jfif" srcset="https://secure.gravatar.com/avatar/f8675c9cdb374c2350f3240e4e6a9e66?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Jack</span>
	                <span class="date">February 2, 2018 at 8:01 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-428225" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason, thank you for your great tutorial! My question here is 
about ‘grid_result.best_score’. In this article the best score seems to 
be the best mean score, but in a regression problem, the mean score is 
irrelevant, so I have to look for the best std score. Is that correct?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-428225" data-commentid="428225" data-postid="2967" data-belowelement="comment-428225" data-respondelement="respond" aria-label="Reply to Jack">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-428269" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-428269" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">February 3, 2018 at 8:35 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-428269" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Mean score in regression will be mean error. Not irrelevant.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-428269" data-commentid="428269" data-postid="2967" data-belowelement="comment-428269" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-428302" class="comment even depth-3 parent">

	      	<div id="li-comment-428302" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/f8675c9cdb374c2350f3240e4e6a9e66.jfif" srcset="https://secure.gravatar.com/avatar/f8675c9cdb374c2350f3240e4e6a9e66?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Jack</span>
	                <span class="date">February 3, 2018 at 8:15 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-428302" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I see. But when I run the code, the ‘grid_result.best_score’ 
printed out the biggest score. I don’t think that’s right, cause in a 
regression problem I should look for the smallest mean error. Am I 
understanding this right?<br>
Below are the results:<br>
Best: 0.062234 using {‘optimizer’: ‘Nadam’}<br>
0.059561 (0.017101) with: {‘optimizer’: ‘SGD’}<br>
0.056818 (0.013662) with: {‘optimizer’: ‘RMSprop’}<br>
0.059617 (0.014734) with: {‘optimizer’: ‘Adagrad’}<br>
0.061506 (0.014503) with: {‘optimizer’: ‘Adadelta’}<br>
0.059331 (0.014835) with: {‘optimizer’: ‘Adam’}<br>
0.057696 (0.014828) with: {‘optimizer’: ‘Adamax’}<br>
0.062234 (0.010834) with: {‘optimizer’: ‘Nadam’}</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-428302" data-commentid="428302" data-postid="2967" data-belowelement="comment-428302" data-respondelement="respond" aria-label="Reply to Jack">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-428327" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4 parent">

	      	<div id="li-comment-428327" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">February 4, 2018 at 5:09 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-428327" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, for regression it should be the smallest error. Are you using negative mse as the score function?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-428327" data-commentid="428327" data-postid="2967" data-belowelement="comment-428327" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-428450" class="comment even depth-5">

	      	<div id="li-comment-428450" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/f8675c9cdb374c2350f3240e4e6a9e66.jfif" srcset="https://secure.gravatar.com/avatar/f8675c9cdb374c2350f3240e4e6a9e66?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Jack</span>
	                <span class="date">February 5, 2018 at 6:52 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-428450" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I’m not sure. I just copied the codes from this tutorial and 
changed ‘KerasClassifier’ to ‘KerasRegressor’.I didn’t make any change 
other than that.  I don’t understand how score function works and I’m 
not familiar with the concept of negative mse. Would you please 
elaborate?</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-428542" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-5">

	      	<div id="li-comment-428542" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">February 6, 2018 at 9:12 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-428542" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You must specify a scoring function in sklearn, learn more about the API here:<br>
<a href="http://scikit-learn.org/stable/modules/generated/sklearn.model_selection.GridSearchCV.html" rel="nofollow">http://scikit-learn.org/stable/modules/generated/sklearn.model_selection.GridSearchCV.html</a></p>
<p>Here are examples:<br>
<a href="http://scikit-learn.org/stable/modules/model_evaluation.html#scoring-parameter" rel="nofollow">http://scikit-learn.org/stable/modules/model_evaluation.html#scoring-parameter</a></p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-428343" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-428343" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/90571e70cbccc9f2981e10aeb8092600.jfif" srcset="https://secure.gravatar.com/avatar/90571e70cbccc9f2981e10aeb8092600?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Mohamed Abd-Allah</span>
	                <span class="date">February 4, 2018 at 9:09 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-428343" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>very good tutorial, But I have a small question. can I tune all 
these hyperparameters together or I should take a part of the dataset 
and tune them separately like the examples you mentioned.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-428343" data-commentid="428343" data-postid="2967" data-belowelement="comment-428343" data-respondelement="respond" aria-label="Reply to Mohamed Abd-Allah">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-428402" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-428402" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">February 5, 2018 at 7:43 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-428402" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Ideally, you would tune them all together, but this is often to computationally expensive.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-428402" data-commentid="428402" data-postid="2967" data-belowelement="comment-428402" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-428731" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-428731" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/61780cae880197f8a3f53472203f7cbb.jfif" srcset="https://secure.gravatar.com/avatar/61780cae880197f8a3f53472203f7cbb?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Vidar</span>
	                <span class="date">February 8, 2018 at 7:40 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-428731" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Is there a way to do similar things in R using the Caret package?
 Or other package that can help you with hyperparameter grid search when
 using Keras in R?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-428731" data-commentid="428731" data-postid="2967" data-belowelement="comment-428731" data-respondelement="respond" aria-label="Reply to Vidar">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-428756" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-428756" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">February 8, 2018 at 8:33 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-428756" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I don’t know if Keras and caret are compatible, sorry.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-428756" data-commentid="428756" data-postid="2967" data-belowelement="comment-428756" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-428774" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-428774" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/2cffbd9e5ab04126024dd33e3501c07e.jfif" srcset="https://secure.gravatar.com/avatar/2cffbd9e5ab04126024dd33e3501c07e?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/" rel="external nofollow" class="url">joseph</a></span>
	                <span class="date">February 8, 2018 at 3:17 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-428774" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>hi Jason,</p>
<p>do i need to split the training data for cross validation, or only perform splitting on the input data.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-428774" data-commentid="428774" data-postid="2967" data-belowelement="comment-428774" data-respondelement="respond" aria-label="Reply to joseph">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-428836" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-428836" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">February 9, 2018 at 8:59 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-428836" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Why do you want to split exactly? You goals will help me answer your question.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-428836" data-commentid="428836" data-postid="2967" data-belowelement="comment-428836" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-428858" class="comment even depth-3 parent">

	      	<div id="li-comment-428858" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/2cffbd9e5ab04126024dd33e3501c07e.jfif" srcset="https://secure.gravatar.com/avatar/2cffbd9e5ab04126024dd33e3501c07e?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/" rel="external nofollow" class="url">joseph</a></span>
	                <span class="date">February 9, 2018 at 10:36 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-428858" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks Jason for the quick reply…i will figure that out.. Just 
another minor question, is there any way to perform data preprocessing 
on 3d input (due to the input shape for lstm)</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-428858" data-commentid="428858" data-postid="2967" data-belowelement="comment-428858" data-respondelement="respond" aria-label="Reply to joseph">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-428955" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4 parent">

	      	<div id="li-comment-428955" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">February 10, 2018 at 8:49 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-428955" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sure, but it might be easier (or make more sense) to perform data prep prior to shaping data for the LSTM.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-428955" data-commentid="428955" data-postid="2967" data-belowelement="comment-428955" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-428987" class="comment even depth-5">

	      	<div id="li-comment-428987" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/2cffbd9e5ab04126024dd33e3501c07e.jfif" srcset="https://secure.gravatar.com/avatar/2cffbd9e5ab04126024dd33e3501c07e?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">joseph</span>
	                <span class="date">February 10, 2018 at 12:12 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-428987" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks Jason..i will try that out.. Is it a good idea to tune the
 hyperparameter using the keras wrapper, then apply those tuned 
parameters on lstm model? Hope to get some comments on it. Thank you.</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-429045" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-5">

	      	<div id="li-comment-429045" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">February 11, 2018 at 7:51 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-429045" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You can. Or you can write your own for loop and tune the model directly.</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-429160" class="comment even depth-5">

	      	<div id="li-comment-429160" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/2cffbd9e5ab04126024dd33e3501c07e.jfif" srcset="https://secure.gravatar.com/avatar/2cffbd9e5ab04126024dd33e3501c07e?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">joseph</span>
	                <span class="date">February 12, 2018 at 1:10 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-429160" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks a lot Jason.. i will definitely try that one out..</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-429532" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-429532" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/4b94ef685fd6ef274d3e9ad3d65bc60d.jfif" srcset="https://secure.gravatar.com/avatar/4b94ef685fd6ef274d3e9ad3d65bc60d?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Boris Branson</span>
	                <span class="date">February 15, 2018 at 7:27 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-429532" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason, wonderful post. I love your books – amazing.</p>
<p>I wish to include callbacks in the Grid Search (one for TensorBoard 
and one for logging losses on every combination over the params).</p>
<p>I have something like:</p>
<p>loggerCB = keras.callbacks.TensorBoard(log_dir=’logs’, histogram_freq=0, write_graph=True)<br>
class LossHistory(keras.callbacks.Callback):<br>
    def on_train_begin(self, logs={}):<br>
        self.losses = []<br>
    def on_batch_end(self, batch, logs={}):<br>
        self.losses.append(logs.get(‘loss’))</p>
<p>historyCB = LossHistory()</p>
<p>grid_search = GridSearchCV(estimator=model,<br>
                           param_grid=fit_params,<br>
                           scoring=’accuracy’,<br>
                           cv=10)<br>
grid_search = grid_search.fit(X_train, y_train, fit_params={‘callbacks’: [loggerCB, historyCB]})</p>
<p>BUT I got this error:<br>
TypeError: Unrecognized keyword arguments: {‘fit_params’: {‘callbacks’: [, ]}}</p>
<p>How can I pass callbacks using Grid Search?</p>
<p>Thanks,<br>
Boris Branson</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-429532" data-commentid="429532" data-postid="2967" data-belowelement="comment-429532" data-respondelement="respond" aria-label="Reply to Boris Branson">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-429560" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-429560" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">February 15, 2018 at 8:52 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-429560" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>ry, I have not used callbacks with a grid search. You might need to write your own for-loops for the search.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-429560" data-commentid="429560" data-postid="2967" data-belowelement="comment-429560" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-429734" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-429734" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/98605e05553435d716938e836e19bacb.jfif" srcset="https://secure.gravatar.com/avatar/98605e05553435d716938e836e19bacb?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Alessandro</span>
	                <span class="date">February 17, 2018 at 4:02 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-429734" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello Jason,<br>
let me congratulate for the good post.</p>
<p>I am curious about the use of CV . Each time you call<br>
grid = GridSearchCV(estimator=model, param_grid=param_grid, n_jobs=-1)<br>
you are compiling a new keras model with the new set of parameters. </p>
<p>Are these different models of keras, compiled one after another, 
accumulating in the memory? Would this imply a memory usage problem in 
the case of an extensive grid search with bigger models? Any tips?</p>
<p>Best,<br>
Alessandro</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-429734" data-commentid="429734" data-postid="2967" data-belowelement="comment-429734" data-respondelement="respond" aria-label="Reply to Alessandro">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-429761" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-429761" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">February 17, 2018 at 8:50 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-429761" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, each model is evaluated and discarded.</p>
<p>For larger models, you could run each fold on a different machine (e.g. run the eval manually).</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-429761" data-commentid="429761" data-postid="2967" data-belowelement="comment-429761" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-430345" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-430345" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/4b94ef685fd6ef274d3e9ad3d65bc60d.jfif" srcset="https://secure.gravatar.com/avatar/4b94ef685fd6ef274d3e9ad3d65bc60d?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Boris Branson</span>
	                <span class="date">February 23, 2018 at 9:26 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-430345" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello Jason,</p>
<p>I see you have used only SGD in the example of learning rate 
parameterization. Is it possible to combine different values for lr with
 different optimizers (not only SGD) in one grid search or i’d need a 
for loop?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-430345" data-commentid="430345" data-postid="2967" data-belowelement="comment-430345" data-respondelement="respond" aria-label="Reply to Boris Branson">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-430399" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-430399" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">February 24, 2018 at 9:11 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-430399" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, but the more parameters you grid search at once, the slower the search.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-430399" data-commentid="430399" data-postid="2967" data-belowelement="comment-430399" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-430485" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-430485" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/c4dba6dcb6a5806dfadb6382c8a46a84.jfif" srcset="https://secure.gravatar.com/avatar/c4dba6dcb6a5806dfadb6382c8a46a84?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Priyansh</span>
	                <span class="date">February 25, 2018 at 7:39 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-430485" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I Jason your article is super useful, but I am having problem 
using it for MNIST data set which is a three dimensional data set , When
 I try so ‘fit’ this one gives me error, Dimension error. Can you do one
 for MNIST data set. Thanks a lot</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-430485" data-commentid="430485" data-postid="2967" data-belowelement="comment-430485" data-respondelement="respond" aria-label="Reply to Priyansh">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-430504" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-430504" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">February 26, 2018 at 6:05 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-430504" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Perhaps try this tutorial:<br>
<a href="https://machinelearningmastery.com/handwritten-digit-recognition-using-convolutional-neural-networks-python-keras/" rel="nofollow">https://machinelearningmastery.com/handwritten-digit-recognition-using-convolutional-neural-networks-python-keras/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-430504" data-commentid="430504" data-postid="2967" data-belowelement="comment-430504" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-430644" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-430644" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/4fc73441eb5edaec18924ac02781d36e.jfif" srcset="https://secure.gravatar.com/avatar/4fc73441eb5edaec18924ac02781d36e?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">TonyWang</span>
	                <span class="date">February 27, 2018 at 10:20 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-430644" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason, Great tutorial, always learn a lot from your post. I 
have question, is it possible to combine all the parameters and with 
gridsearch? Seems more than thousands of combinations. For some models 
it will cost few days or weeks. Is there any better solution for this? 
randomgridsearch or something else? Thanks again!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-430644" data-commentid="430644" data-postid="2967" data-belowelement="comment-430644" data-respondelement="respond" aria-label="Reply to TonyWang">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-430681" class="comment byuser comment-author-jasonb bypostauthor even depth-2 parent">

	      	<div id="li-comment-430681" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">February 28, 2018 at 6:04 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-430681" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, but as you say, you will need a lot of time or a lot of parallel compute resources to get a result.</p>
<p>Random search is often preferred because you can uniformly sample the domain and get good enough results quickly.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-430681" data-commentid="430681" data-postid="2967" data-belowelement="comment-430681" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-430760" class="comment odd alt depth-3 parent">

	      	<div id="li-comment-430760" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/4fc73441eb5edaec18924ac02781d36e.jfif" srcset="https://secure.gravatar.com/avatar/4fc73441eb5edaec18924ac02781d36e?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">TonyWang</span>
	                <span class="date">March 1, 2018 at 3:18 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-430760" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks for your reply. Googled a lot but didn’t find any method 
to search optimizers and their params, say different optimizer, adam and
 it’s learning rates. Is there any suggestions? Thanks!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-430760" data-commentid="430760" data-postid="2967" data-belowelement="comment-430760" data-respondelement="respond" aria-label="Reply to TonyWang">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-430792" class="comment byuser comment-author-jasonb bypostauthor even depth-4">

	      	<div id="li-comment-430792" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">March 1, 2018 at 6:16 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-430792" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, just start searching for viable params on your model/data. No need to find confirmation.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-430792" data-commentid="430792" data-postid="2967" data-belowelement="comment-430792" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-430871" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-430871" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/e31bf4c6964d1beba241278bb97f3540.jfif" srcset="https://secure.gravatar.com/avatar/e31bf4c6964d1beba241278bb97f3540?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Johnson Muthii</span>
	                <span class="date">March 2, 2018 at 8:56 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-430871" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello Jason,</p>
<p>Thanks for this awesome tutorial. Am very fresh in machine learning and your tutorials are so simplified and easy to follow.</p>
<p>Am encountering an error when i run the  epochs and batch size tuning code. Kindly help</p>
<p>This the code part bringing the error…</p>
<p># create model<br>
model = KerasClassifier(build_fn=create_model, verbose=0)<br>
# define the grid search parameters<br>
batch_size = [10, 20, 40, 60, 80, 100]<br>
epochs = [10, 50, 100]<br>
param_grid = dict(batch_size=batch_size, epochs=epochs)<br>
grid = GridSearchCV(estimator=model, param_grid=param_grid, n_jobs= 1)<br>
grid_result = grid.fit(X_train, y_train)</p>
<p>TypeError: __call__() missing 1 required positional argument: ‘inputs’</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-430871" data-commentid="430871" data-postid="2967" data-belowelement="comment-430871" data-respondelement="respond" aria-label="Reply to Johnson Muthii">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-430887" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-430887" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">March 2, 2018 at 3:20 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-430887" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sorry, I have not seen this error. Are you able to confirm that 
you have copied all of the code and that your development environment is
 up to date?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-430887" data-commentid="430887" data-postid="2967" data-belowelement="comment-430887" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-447019" class="comment odd alt depth-2 parent">

	      	<div id="li-comment-447019" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/b1dbc589fffe735f9129587efe9ba597.jfif" srcset="https://secure.gravatar.com/avatar/b1dbc589fffe735f9129587efe9ba597?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Nathan Rasch</span>
	                <span class="date">August 27, 2018 at 5:52 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-447019" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I ran into this over the weekend, and hopefully to same some one else some pain down the road:</p>
<p>I kept getting the following error when working the prediction section of my code, which frankly was driving me nuts:</p>
<p>    TypeError: call() missing 1 required positional argument: ‘inputs’</p>
<p>After researching the error message I came upon this comment which let me to the resolution:</p>
<p>_The thing here is that KerasRegressor expects a callable that builds
 a model, rather than the model itself. By wrapping your function in 
this way you can return the build function (without calling it)._  
[Source](<a href="https://stackoverflow.com/questions/47944463/specify-input-argument-with-kerasregressor" rel="nofollow">https://stackoverflow.com/questions/47944463/specify-input-argument-with-kerasregressor</a>)</p>
<p>Solution:  I needed to **wrap** my <code>buildModel()</code> function!  <img draggable="false" class="emoji" alt="🙁" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1f641.svg"></p>
<p>Once I ‘wrapped’ the <code>buildModel()</code> function the 
prediction code blocks finally started working.  Git it a try, and it 
should resolve your issue.  The link I provided above should give you a 
working code example.  If not let me know, and I’ll post my working 
example for you.</p>
<p>Thanks!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-447019" data-commentid="447019" data-postid="2967" data-belowelement="comment-447019" data-respondelement="respond" aria-label="Reply to Nathan Rasch">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-447030" class="comment byuser comment-author-jasonb bypostauthor even depth-3">

	      	<div id="li-comment-447030" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">August 27, 2018 at 6:15 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-447030" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>It might be easier to write your own for loops to grid search Keras models.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-447030" data-commentid="447030" data-postid="2967" data-belowelement="comment-447030" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-431376" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-431376" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/7477051e31716fe0e642b05eabb7ca07.jfif" srcset="https://secure.gravatar.com/avatar/7477051e31716fe0e642b05eabb7ca07?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">sonia</span>
	                <span class="date">March 7, 2018 at 2:05 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-431376" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>dear jason<br>
how much time this program run while tunning ?like tuning epoch and batch size?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-431376" data-commentid="431376" data-postid="2967" data-belowelement="comment-431376" data-respondelement="respond" aria-label="Reply to sonia">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-431406" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-431406" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">March 7, 2018 at 6:16 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-431406" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>It depends on the size of the dataset, the size of the model and the speed of your system.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-431406" data-commentid="431406" data-postid="2967" data-belowelement="comment-431406" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-431922" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-431922" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/05f6f6d5c5cbf9d2c393032c735870b0.jfif" srcset="https://secure.gravatar.com/avatar/05f6f6d5c5cbf9d2c393032c735870b0?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Yumlembam Rahul</span>
	                <span class="date">March 12, 2018 at 1:59 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-431922" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi,</p>
<p>As you mention in your blog “As we proceed through the examples in 
this post, we will aggregate the best parameters. This is not the best 
way to grid search because parameters can interact, but it is good for 
demonstration purposes.” does this mean we should so the hyper parameter
 search in one grid instead of dividing.</p>
<p>regrads,</p>
<p>Yumlembam Rahul</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-431922" data-commentid="431922" data-postid="2967" data-belowelement="comment-431922" data-respondelement="respond" aria-label="Reply to Yumlembam Rahul">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-431934" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-431934" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">March 12, 2018 at 2:28 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-431934" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Ideally, if you have the time and resources.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-431934" data-commentid="431934" data-postid="2967" data-belowelement="comment-431934" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-432250" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-432250" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/2d9c9d2418d6d67d70c3c7c0e955a352.jfif" srcset="https://secure.gravatar.com/avatar/2d9c9d2418d6d67d70c3c7c0e955a352?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">jessy</span>
	                <span class="date">March 15, 2018 at 8:51 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-432250" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>sir,</p>
<p>      I have tried above code. it is executing ,but not displaying results..i don’t know the reason ..</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-432250" data-commentid="432250" data-postid="2967" data-belowelement="comment-432250" data-respondelement="respond" aria-label="Reply to jessy">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-432299" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-432299" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">March 16, 2018 at 6:17 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-432299" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Perhaps try from the command line, then be patient.</p>
<p>Perhaps try to reduce the data set size or use fewer combinations?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-432299" data-commentid="432299" data-postid="2967" data-belowelement="comment-432299" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-432349" class="comment odd alt thread-odd thread-alt depth-1">

	      	<div id="li-comment-432349" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/05f6f6d5c5cbf9d2c393032c735870b0.jfif" srcset="https://secure.gravatar.com/avatar/05f6f6d5c5cbf9d2c393032c735870b0?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Yumlembam Rahul</span>
	                <span class="date">March 16, 2018 at 5:25 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-432349" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>hi, in your example optimizer parameter are not specified while 
doing grid search do they assume default values if not specified??</p>
<p>and for reproducibility  of result i added the following code and have been able to get same result<br>
<b><br>
import os<br>
os.environ[‘PYTHONHASHSEED’] = ‘0’<br>
np.random.seed(42)<br>
rn.seed(12345)<br>
session_conf = tf.ConfigProto(intra_op_parallelism_threads=1, inter_op_parallelism_threads=1)<br>
from keras import backend as K<br>
# The below tf.set_random_seed() will make random number generation<br>
# in the TensorFlow backend have a well-defined initial state.<br>
# For further details, see: <a href="https://www.tensorflow.org/api_docs/python/tf/set_random_seed" rel="nofollow">https://www.tensorflow.org/api_docs/python/tf/set_random_seed</a><br>
tf.set_random_seed(1234)<br>
sess = tf.Session(graph=tf.get_default_graph(), config=session_conf)<br>
K.set_session(sess)</b></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-432349" data-commentid="432349" data-postid="2967" data-belowelement="comment-432349" data-respondelement="respond" aria-label="Reply to Yumlembam Rahul">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-432351" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-432351" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/2d9c9d2418d6d67d70c3c7c0e955a352.jfif" srcset="https://secure.gravatar.com/avatar/2d9c9d2418d6d67d70c3c7c0e955a352?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">jessy</span>
	                <span class="date">March 16, 2018 at 6:05 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-432351" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>sir,</p>
<p>     I have doubt ,Whether LSTM concept could be used for prediction 
of diabetes dataset(PIMA INDIAN DATASET)…I don’t know how LSTM Learns 
data from dataset..is it possible to put an hands on calculation..</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-432351" data-commentid="432351" data-postid="2967" data-belowelement="comment-432351" data-respondelement="respond" aria-label="Reply to jessy">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-432401" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-432401" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">March 17, 2018 at 8:32 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-432401" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>LSTMs are not appropriate for classification problems. They are intended for sequence classification:<br>
<a href="https://machinelearningmastery.com/sequence-prediction/" rel="nofollow">https://machinelearningmastery.com/sequence-prediction/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-432401" data-commentid="432401" data-postid="2967" data-belowelement="comment-432401" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-432598" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-432598" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/2d9c9d2418d6d67d70c3c7c0e955a352.jfif" srcset="https://secure.gravatar.com/avatar/2d9c9d2418d6d67d70c3c7c0e955a352?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">jessy</span>
	                <span class="date">March 19, 2018 at 7:32 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-432598" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Is it possible to put an hands on calculation particularly for 
hidden layers and LSTM layers..Is it possible to put manual calculation 
on weights(how it transfer weight from one layer to another layer)…</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-432598" data-commentid="432598" data-postid="2967" data-belowelement="comment-432598" data-respondelement="respond" aria-label="Reply to jessy">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-432655" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-432655" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">March 20, 2018 at 6:15 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-432655" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sure, but you will need to code these as extensions to the Keras library.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-432655" data-commentid="432655" data-postid="2967" data-belowelement="comment-432655" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-433030" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-433030" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/2d9c9d2418d6d67d70c3c7c0e955a352.jfif" srcset="https://secure.gravatar.com/avatar/2d9c9d2418d6d67d70c3c7c0e955a352?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">jessy</span>
	                <span class="date">March 23, 2018 at 9:26 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-433030" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>sir ,<br>
      i have tried above code without n_jobs==-1 parameter .it is 
working …I have doubt ,that is above code can be run using LSTM model 
…is that possible…</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-433030" data-commentid="433030" data-postid="2967" data-belowelement="comment-433030" data-respondelement="respond" aria-label="Reply to jessy">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-433065" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-433065" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">March 24, 2018 at 6:26 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-433065" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Perhaps set it to 1 thread and let Keras have all of the cores?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-433065" data-commentid="433065" data-postid="2967" data-belowelement="comment-433065" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-433131" class="comment even thread-odd thread-alt depth-1">

	      	<div id="li-comment-433131" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/4c7a7434bfbc58df90f9332aaad31922.jfif" srcset="https://secure.gravatar.com/avatar/4c7a7434bfbc58df90f9332aaad31922?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Max</span>
	                <span class="date">March 25, 2018 at 1:12 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-433131" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>I’m sure it’s possible – but I can’t figure it out.<br>
The above code gives me as a result the best hyper-parameters as measured on the cross-validation.<br>
Now which adjustments to the code would be necessary to additionally calculate the optimum hyper-parameters on a test set?<br>
The optimum hyper-parameters seem to lead to significantly different 
results when applied to my model that I use to predict values.</p>
<p>Thanks<br>
Max</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-433131" data-commentid="433131" data-postid="2967" data-belowelement="comment-433131" data-respondelement="respond" aria-label="Reply to Max">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-433473" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-433473" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/2d9c9d2418d6d67d70c3c7c0e955a352.jfif" srcset="https://secure.gravatar.com/avatar/2d9c9d2418d6d67d70c3c7c0e955a352?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">jessy</span>
	                <span class="date">March 28, 2018 at 7:12 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-433473" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>sir ,<br>
         I have an doubt that is multivariate time series data can be 
used for classification or prediction .whether we can use that data for 
prediction or classification or both.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-433473" data-commentid="433473" data-postid="2967" data-belowelement="comment-433473" data-respondelement="respond" aria-label="Reply to jessy">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-433532" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-433532" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">March 29, 2018 at 6:32 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-433532" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You can learn the difference between classification and regression here:<br>
<a href="https://machinelearningmastery.com/classification-versus-regression-in-machine-learning/" rel="nofollow">https://machinelearningmastery.com/classification-versus-regression-in-machine-learning/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-433532" data-commentid="433532" data-postid="2967" data-belowelement="comment-433532" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-433475" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-433475" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/2d9c9d2418d6d67d70c3c7c0e955a352.jfif" srcset="https://secure.gravatar.com/avatar/2d9c9d2418d6d67d70c3c7c0e955a352?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">jessy</span>
	                <span class="date">March 28, 2018 at 7:18 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-433475" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>sir,<br>
     In LSTM  model you are using only RMSE loss function …..why you are
 not used other loss function ..In particular sequence prediction 
problem (forecasting) you used only RMSE loss function ….why sir.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-433475" data-commentid="433475" data-postid="2967" data-belowelement="comment-433475" data-respondelement="respond" aria-label="Reply to jessy">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-433533" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-433533" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">March 29, 2018 at 6:33 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-433533" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I use MSE not RMSE. You can try other loss functions if you prefer. I find MSE loss function works well for most problems.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-433533" data-commentid="433533" data-postid="2967" data-belowelement="comment-433533" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-433511" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-433511" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/8c6515c6af23066ead4cd63fa75a99d2.jfif" srcset="https://secure.gravatar.com/avatar/8c6515c6af23066ead4cd63fa75a99d2?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">hamidi</span>
	                <span class="date">March 29, 2018 at 4:57 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-433511" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi<br>
Thanks for your nice post. </p>
<p>Could you please let me know how to incorporate class_weight and tune it?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-433511" data-commentid="433511" data-postid="2967" data-belowelement="comment-433511" data-respondelement="respond" aria-label="Reply to hamidi">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-433544" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-433544" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">March 29, 2018 at 6:38 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-433544" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sorry, I do not have a worked example.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-433544" data-commentid="433544" data-postid="2967" data-belowelement="comment-433544" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-434929" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-434929" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/6afbeb5b20373971b34db2f58e292a58.jfif" srcset="https://secure.gravatar.com/avatar/6afbeb5b20373971b34db2f58e292a58?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Prabha</span>
	                <span class="date">April 13, 2018 at 8:58 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-434929" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello, great post as always!<br>
I had a query regarding this. So I have a training set and a test set, and I am using a stacking ensemble for predictions.<br>
So when I run GridSearchCV on this, should I fit just the training set 
on this and print CV score on the training set ONLY? And not touch the 
test set at all?<br>
Also should I fit the new grid classifier on the set before printing the CV score or after?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-434929" data-commentid="434929" data-postid="2967" data-belowelement="comment-434929" data-respondelement="respond" aria-label="Reply to Prabha">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-434965" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-434965" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">April 14, 2018 at 6:43 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-434965" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, hold back the test set, and use the training set for CV.</p>
<p>More on this here:<br>
<a href="https://machinelearningmastery.com/difference-test-validation-datasets/" rel="nofollow">https://machinelearningmastery.com/difference-test-validation-datasets/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-434965" data-commentid="434965" data-postid="2967" data-belowelement="comment-434965" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-435174" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-435174" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/74e972be71521108d604461dd271909a.jfif" srcset="https://secure.gravatar.com/avatar/74e972be71521108d604461dd271909a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Aditya Jain</span>
	                <span class="date">April 17, 2018 at 1:53 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-435174" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>model = KerasClassifier(build_fn=create_model, verbose=0)<br>
# define the grid search parameters<br>
batch_size = [10, 20]<br>
epochs = [10, 20, 30]<br>
param_grid = dict(batch_size=batch_size, epochs=epochs)<br>
grid = GridSearchCV(estimator=model, param_grid=param_grid, n_jobs=-1)<br>
grid_result = grid.fit(x_train, y_train)</p>
<p>When I am running this code snippet I am getting error as<br>
AttributeError: ‘NoneType’ object has no attribute ‘loss’</p>
<p>Can you please help me on that ?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-435174" data-commentid="435174" data-postid="2967" data-belowelement="comment-435174" data-respondelement="respond" aria-label="Reply to Aditya Jain">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-435194" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-435194" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">April 17, 2018 at 6:02 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-435194" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sorry, I have not seen this error before.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-435194" data-commentid="435194" data-postid="2967" data-belowelement="comment-435194" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-436150" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-436150" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/31111a2b3f03792dc341dd17a2cef1c9.jfif" srcset="https://secure.gravatar.com/avatar/31111a2b3f03792dc341dd17a2cef1c9?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Marshall</span>
	                <span class="date">April 28, 2018 at 5:28 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-436150" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>First and foremost, this is an incredible writeup – very informative.</p>
<p>I’m getting an error that reads “can’t pickle _thread.RLock objects”</p>
<p>When I use the following code:</p>
<p>————————————————————————–</p>
<p>def build_neural_network(n_predictors, hidden_layer_neurons):<br>
    “””<br>
    Builds a Multi-Layer-Perceptron utilizing Keras.</p>
<p>    Parameters:<br>
        x_train: (2D numpy array) A n x p matrix, with n observations<br>
                 and p features<br>
        y_train: (1D numpy array) A numpy array of length n with the<br>
                 target training values.<br>
        hidden_layer_neurons: (list) List of ints for the number of<br>
                              neurons in each hidden layer.</p>
<p>    Returns:<br>
        model: A MLP with 2 hidden layers<br>
    “””<br>
    model = Sequential()<br>
    input_layer_neurons = n_predictors</p>
<p>    model.add(Dense(units=hidden_layer_neurons[0],<br>
                    input_dim=input_layer_neurons,<br>
                    kernel_initializer=’uniform’,<br>
                    activation=’relu’))</p>
<p>    model.add(Dense(units=hidden_layer_neurons[1],<br>
                    kernel_initializer=’uniform’,<br>
                    activation=’relu’))</p>
<p>    model.add(Dense(units=1))</p>
<p>    model.compile(optimizer=’rmsprop’,<br>
                  loss=’mse’)</p>
<p>    return model</p>
<p># columns variable defined elsewhere, works as expected</p>
<p>mlp = build_neural_network(len(columns), [8, 12])</p>
<p>model = KerasRegressor(build_fn=mlp)</p>
<p># create parameter lists for GridSearchCV<br>
batch_size = list(np.arange(10, 250, 10))<br>
epochs = list(np.arange(5, 20, 5))</p>
<p>neural_net_grid_dict = {‘batch_size’: batch_size,<br>
                        ‘epochs’: epochs}</p>
<p>neural_net_grid = GridSearchCV(estimator=model,<br>
                               param_grid=neural_net_grid_dict,<br>
                               scoring=’neg_mean_squared_error’,<br>
                               verbose=1,<br>
                               n_jobs=-1)</p>
<p>mask = df[‘Date’] == ‘2006-11-06’<br>
X, y = create_X_y(df[mask], columns)</p>
<p>grid_result = neural_net_grid.fit(X, y)</p>
<p>——————————————————–</p>
<p>Any idea what might be going on?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-436150" data-commentid="436150" data-postid="2967" data-belowelement="comment-436150" data-respondelement="respond" aria-label="Reply to Marshall">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-436217" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-436217" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">April 29, 2018 at 6:21 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-436217" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sorry, I have not seen this error. Perhaps try posting to stackoverflow?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-436217" data-commentid="436217" data-postid="2967" data-belowelement="comment-436217" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-436210" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-436210" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/09967ac6b0e8a8b054050fe4f6b62175.jfif" srcset="https://secure.gravatar.com/avatar/09967ac6b0e8a8b054050fe4f6b62175?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Cristiana</span>
	                <span class="date">April 29, 2018 at 4:52 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-436210" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks so much ! This post helped me a lot !</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-436210" data-commentid="436210" data-postid="2967" data-belowelement="comment-436210" data-respondelement="respond" aria-label="Reply to Cristiana">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-436229" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-436229" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">April 29, 2018 at 6:28 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-436229" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I’m glad to hear that.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-436229" data-commentid="436229" data-postid="2967" data-belowelement="comment-436229" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-444399" class="comment odd alt depth-2">

	      	<div id="li-comment-444399" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/14d5948f510643f16501d857a3e458f9.jfif" srcset="https://secure.gravatar.com/avatar/14d5948f510643f16501d857a3e458f9?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Sandra</span>
	                <span class="date">July 26, 2018 at 4:56 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-444399" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I am experiencing the same error  “can’t pickle _thread.RLock objects”, may I know how you solved it?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-444399" data-commentid="444399" data-postid="2967" data-belowelement="comment-444399" data-respondelement="respond" aria-label="Reply to Sandra">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-436972" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-436972" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/f478e6a4c825fa9749e492fdfe8761bb.jfif" srcset="https://secure.gravatar.com/avatar/f478e6a4c825fa9749e492fdfe8761bb?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Juan</span>
	                <span class="date">May 9, 2018 at 4:16 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-436972" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>how can tune your model to found hyperparameters (learning rate, 
epoch and output dim in hidden layer) using RandomizedSearchCV? </p>
<p>Thanks !!<br>
Regards</p>
<p>Juan</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-436972" data-commentid="436972" data-postid="2967" data-belowelement="comment-436972" data-respondelement="respond" aria-label="Reply to Juan">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-436998" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-436998" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">May 9, 2018 at 6:28 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-436998" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Specify ranges and search. What is the problem exactly?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-436998" data-commentid="436998" data-postid="2967" data-belowelement="comment-436998" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-437280" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-437280" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/5ea9c3c745314c061dec3db041da6cdf.jfif" srcset="https://secure.gravatar.com/avatar/5ea9c3c745314c061dec3db041da6cdf?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">June</span>
	                <span class="date">May 12, 2018 at 6:18 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-437280" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason, I got a help from this blog post. Thank you very much!</p>
<p>I have one question though. What if I want to test with optimizers 
that has customized parameters and not default parameters. From your 
example, it’s just an array of Strings of optimizers name. </p>
<p>Do you know how I can do this?</p>
<p>Best,<br>
June</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-437280" data-commentid="437280" data-postid="2967" data-belowelement="comment-437280" data-respondelement="respond" aria-label="Reply to June">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-437307" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-437307" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">May 12, 2018 at 6:52 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-437307" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You can provide lists of strings with optimizer names if you wish.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-437307" data-commentid="437307" data-postid="2967" data-belowelement="comment-437307" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-437310" class="comment even depth-3 parent">

	      	<div id="li-comment-437310" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/5ea9c3c745314c061dec3db041da6cdf.jfif" srcset="https://secure.gravatar.com/avatar/5ea9c3c745314c061dec3db041da6cdf?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">June</span>
	                <span class="date">May 12, 2018 at 7:14 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-437310" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes. Isn’t this what’s provided in the example code?<br>
optimizer = [‘SGD’, ‘RMSprop’, ‘Adagrad’, ‘Adadelta’, ‘Adam’, ‘Adamax’, ‘Nadam’]</p>
<p>What I meant was not with default ones but like when I have my own optimizer defined as follows:</p>
<p>sgd_custom = SGD(lr_rate=0.7)<br>
adam_custom = (decay=0.005)</p>
<p>How can I give optimizer list for this setting? optimizer=[sgd_custom, adam_custom]?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-437310" data-commentid="437310" data-postid="2967" data-belowelement="comment-437310" data-respondelement="respond" aria-label="Reply to June">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-437361" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4">

	      	<div id="li-comment-437361" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">May 13, 2018 at 6:02 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-437361" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Good question.</p>
<p>Yes, you could provide a list of pre-configured objects to use instead of strings.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-437361" data-commentid="437361" data-postid="2967" data-belowelement="comment-437361" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-437567" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-437567" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/d3442f7295b8e66406af73d1b1873467.jfif" srcset="https://secure.gravatar.com/avatar/d3442f7295b8e66406af73d1b1873467?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Philipp</span>
	                <span class="date">May 15, 2018 at 3:52 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-437567" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>Your posts are really helpful – thanks a lot!</p>
<p>1. I’m using grid search on my own Keras CNN and everything is 
working. One thing that keep’s confusing me though: The F1 measures 
reported by grid search are always a bit (3-4%) higher than when running
 the same network configurations in Keras directly. I know that Keras 
isn’t using CV, but this shouldn’t lead to systematic deviations in one 
direction but to deviations in both directions I think. </p>
<p>2. Also I found that my network is always performing slightly better 
(accuracy) when using the TF-Layers API instead of Keras, even though 
the network configurations are exactly the same (as far as I can control
 this in Keras).</p>
<p>Any ideas why Keras seems to perform poorer? Have others experienced the same issues with Keras? I just can’t figure it out…</p>
<p>Cheers,<br>
Philipp</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-437567" data-commentid="437567" data-postid="2967" data-belowelement="comment-437567" data-respondelement="respond" aria-label="Reply to Philipp">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-437621" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-437621" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">May 16, 2018 at 5:58 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-437621" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>No good idea sorry. It might be statistical chance, or it might 
be real. See if you can tease this out with some hypothesis tests on the
 results.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-437621" data-commentid="437621" data-postid="2967" data-belowelement="comment-437621" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-437911" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-437911" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/d3442f7295b8e66406af73d1b1873467.jfif" srcset="https://secure.gravatar.com/avatar/d3442f7295b8e66406af73d1b1873467?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Philipp</span>
	                <span class="date">May 19, 2018 at 4:33 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-437911" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks, Jason. </p>
<p>Just to let you know: Apparently it has something to do with the F1 
score. Accuracy scores reported by grid search are pretty much the same 
as my results in Keras.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-437911" data-commentid="437911" data-postid="2967" data-belowelement="comment-437911" data-respondelement="respond" aria-label="Reply to Philipp">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-437933" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-437933" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">May 19, 2018 at 7:45 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-437933" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Interesting.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-437933" data-commentid="437933" data-postid="2967" data-belowelement="comment-437933" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-438860" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-438860" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/0bf556894f80734627dedbbcb5acb577.jfif" srcset="https://secure.gravatar.com/avatar/0bf556894f80734627dedbbcb5acb577?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Ng Minh Hieu</span>
	                <span class="date">May 28, 2018 at 3:43 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-438860" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason, thank you for very detailed and interesting tutorial.<br>
1. I tried to grid hyperparameters of epochs and batch size as your 
code. No result was launched and no error message appeared. after that, i
 changed n_jobs equal 1, python gave me the result. I do not understand 
why value of n_jobs = -1 prevented the calculation process.</p>
<p>2. If i have complicated network (with two layers for example), could
 you tell me how grid can be implemented with number of epochs and batch
 size?</p>
<p>Thank you a lot!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-438860" data-commentid="438860" data-postid="2967" data-belowelement="comment-438860" data-respondelement="respond" aria-label="Reply to Ng Minh Hieu">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-438879" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-438879" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">May 28, 2018 at 6:03 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-438879" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Might have caused a deadlock internally.</p>
<p>I don’t understand your second question sorry, perhaps you can rephrase it?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-438879" data-commentid="438879" data-postid="2967" data-belowelement="comment-438879" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-438933" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-438933" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/4d279d0372f39d4db2ae2db6c7c9cf2d.jfif" srcset="https://secure.gravatar.com/avatar/4d279d0372f39d4db2ae2db6c7c9cf2d?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Sumit</span>
	                <span class="date">May 28, 2018 at 7:21 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-438933" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi, Jason, excellent post and help lot for improving my predictive model.</p>
<p>I have one question, is there any way I can optimise number of layer in network ?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-438933" data-commentid="438933" data-postid="2967" data-belowelement="comment-438933" data-respondelement="respond" aria-label="Reply to Sumit">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-438963" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-438963" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">May 29, 2018 at 6:25 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-438963" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, use a grid search and choose the configuration with the lowest loss.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-438963" data-commentid="438963" data-postid="2967" data-belowelement="comment-438963" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-439106" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-439106" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/fdf0453372d624a9c1b9774ecf4aad8c.jfif" srcset="https://secure.gravatar.com/avatar/fdf0453372d624a9c1b9774ecf4aad8c?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">John</span>
	                <span class="date">May 30, 2018 at 2:20 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-439106" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I tried the gird search but got this error </p>
<p>ipython-input-49-ea7e264ec276&gt; in ()<br>
      3 param_grid = dict(batch_size=batch_size, epochs=epochs)<br>
      4 grid = GridSearchCV(estimator=model, param_grid=param_grid, n_jobs=-1)<br>
—-&gt; 5 grid_result = grid.fit(xs, testY)<br>
      6 # summarize results<br>
      7 print(“Best: %f using %s” % (grid_result.best_score_, grid_result.best_params_))</p>
<p>~\Anaconda3\envs\tfdeeplearning\lib\site-packages\sklearn\model_selection\_search.py in fit(self, X, y, groups, **fit_params)<br>
    612             refit_metric = ‘score’<br>
    613<br>
–&gt; 614         X, y, groups = indexable(X, y, groups)<br>
    615         n_splits = cv.get_n_splits(X, y, groups)<br>
    616         # Regenerate parameter iterable for each fit</p>
<p>~\Anaconda3\envs\tfdeeplearning\lib\site-packages\sklearn\utils\validation.py in indexable(*iterables)<br>
    196         else:<br>
    197             result.append(np.array(X))<br>
–&gt; 198     check_consistent_length(*result)<br>
    199     return result<br>
    200 </p>
<p>~\Anaconda3\envs\tfdeeplearning\lib\site-packages\sklearn\utils\validation.py in check_consistent_length(*arrays)<br>
    171     if len(uniques) &gt; 1:<br>
    172         raise ValueError(“Found input variables with inconsistent numbers of”<br>
–&gt; 173                          ” samples: %r” % [int(l) for l in lengths])<br>
    174<br>
    175 </p>
<p>ValueError: Found input variables with inconsistent numbers of samples: [17, 1]</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-439106" data-commentid="439106" data-postid="2967" data-belowelement="comment-439106" data-respondelement="respond" aria-label="Reply to John">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-439115" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-439115" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">May 30, 2018 at 3:09 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-439115" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I have some suggestions here John:<br>
<a href="https://machinelearningmastery.com/faq/single-faq/why-does-the-code-in-the-tutorial-not-work-for-me" rel="nofollow">https://machinelearningmastery.com/faq/single-faq/why-does-the-code-in-the-tutorial-not-work-for-me</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-439115" data-commentid="439115" data-postid="2967" data-belowelement="comment-439115" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-439166" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-439166" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/fdf0453372d624a9c1b9774ecf4aad8c.jfif" srcset="https://secure.gravatar.com/avatar/fdf0453372d624a9c1b9774ecf4aad8c?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">amina</span>
	                <span class="date">May 31, 2018 at 1:38 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-439166" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hey,<br>
what refers 8 in the input dim ? i have a time serie problem a dataset with 41 observation how could i deal with this ?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-439166" data-commentid="439166" data-postid="2967" data-belowelement="comment-439166" data-respondelement="respond" aria-label="Reply to amina">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-439192" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-439192" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">May 31, 2018 at 6:20 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-439192" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>It refers to 8 input variables.</p>
<p>You could define a window of lag obs as input features. Perhaps experiment with different window sizes.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-439192" data-commentid="439192" data-postid="2967" data-belowelement="comment-439192" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-439169" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-439169" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/fdf0453372d624a9c1b9774ecf4aad8c.jfif" srcset="https://secure.gravatar.com/avatar/fdf0453372d624a9c1b9774ecf4aad8c?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">lara</span>
	                <span class="date">May 31, 2018 at 2:08 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-439169" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>could we use only one hiden layer that contain lstm bloc. i want 
to grid search hyperparametre for my lstm achitecture how could i 
specify this on code.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-439169" data-commentid="439169" data-postid="2967" data-belowelement="comment-439169" data-respondelement="respond" aria-label="Reply to lara">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-439195" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-439195" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">May 31, 2018 at 6:23 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-439195" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, you could adapt the above examples to search layers/nodes in an LSTM.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-439195" data-commentid="439195" data-postid="2967" data-belowelement="comment-439195" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-441102" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-441102" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/8e3a1cdcdb31afe5df43c4afad0e6022.jfif" srcset="https://secure.gravatar.com/avatar/8e3a1cdcdb31afe5df43c4afad0e6022?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Angelo</span>
	                <span class="date">June 18, 2018 at 5:06 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-441102" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Astounding post, thank you! I wonder how I could evaluate the 
loss and accuracy evolution of the KerasClassifier according to epoch. 
Is there something like the history class returned from the model.fit 
method from SciKitLearn?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-441102" data-commentid="441102" data-postid="2967" data-belowelement="comment-441102" data-respondelement="respond" aria-label="Reply to Angelo">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-441129" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-441129" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">June 18, 2018 at 6:45 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-441129" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Not that I am aware, I believe you would need to use the Keras API directly and collect history objects from each run.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-441129" data-commentid="441129" data-postid="2967" data-belowelement="comment-441129" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-442514" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-442514" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/19ed7abce4b19e9b49ab8942db6efb55.jfif" srcset="https://secure.gravatar.com/avatar/19ed7abce4b19e9b49ab8942db6efb55?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Babu</span>
	                <span class="date">July 2, 2018 at 6:49 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-442514" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Dear Jason,</p>
<p>I found this article as very useful for my research. Thank you very much.</p>
<p>Is it possible to find the best CNN architecture (No.of layers, 
Kernel size, Kernel initialization, Pooling Technique etc) for a given 
dataset by using GridSearch or RandomSearch?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-442514" data-commentid="442514" data-postid="2967" data-belowelement="comment-442514" data-respondelement="respond" aria-label="Reply to Babu">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-442539" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-442539" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">July 3, 2018 at 6:23 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-442539" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>There is no “best”, just good enough based on the time and resources we have available.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-442539" data-commentid="442539" data-postid="2967" data-belowelement="comment-442539" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-443380" class="comment even depth-3 parent">

	      	<div id="li-comment-443380" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/b1b9833fe84a840afbfd05455599c5b2.jfif" srcset="https://secure.gravatar.com/avatar/b1b9833fe84a840afbfd05455599c5b2?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">prateek bhadauria</span>
	                <span class="date">July 13, 2018 at 8:50 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-443380" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello Jason Sir , i want to know that how could i apply CNN 
concept for non image data which contains large datasets in form of rows
 and coloumns , and how could i apply padding in 50,000 Rows and 20 
coloumns , Kindly suggest an approach.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-443380" data-commentid="443380" data-postid="2967" data-belowelement="comment-443380" data-respondelement="respond" aria-label="Reply to prateek bhadauria">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-443425" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4 parent">

	      	<div id="li-comment-443425" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">July 14, 2018 at 6:17 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-443425" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>CNN is not appropriate unless there is some spatial relationship between the observations, e.g. time or space.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-443425" data-commentid="443425" data-postid="2967" data-belowelement="comment-443425" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-483106" class="comment even depth-5">

	      	<div id="li-comment-483106" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/3a74ea6007fe77df5f4ce609997adef3.jfif" srcset="https://secure.gravatar.com/avatar/3a74ea6007fe77df5f4ce609997adef3?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">maxv</span>
	                <span class="date">April 29, 2019 at 3:01 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-483106" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi </p>
<p>thanks for this post and the replies to questions.</p>
<p>I have a question on the properties of the cnn, if you have a dataset like the pollution dataset.</p>
<p>If we have one binary variable as target in a classification with 10 exogenous variables and it is a daily forecast.<br>
Let us say we have 500 days of data.</p>
<p>I can create a multivariate timeseries forecast and have  5 timesteps in my window so that my train shape will be (500,5,10)</p>
<p>If I apply Conv1D, it should extract features out of all the 10 variables right ?<br>
or does it apply a Conv1D on each exogenous variable separately.</p>
<p>What I try to understand is : does it capture interactions of exogenous variables ?</p>
<p>Does the Conv2D only work for images or for times series too ? </p>
<p>For each window of 5 timesteps, we have 5 timesteps and 10 exogenous variables so we could think this is 2D.</p>
<p>Thanks J</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-483155" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-5">

	      	<div id="li-comment-483155" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">April 29, 2019 at 8:24 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-483155" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, you van get stated here:<br>
<a href="https://machinelearningmastery.com/how-to-develop-convolutional-neural-network-models-for-time-series-forecasting/" rel="nofollow">https://machinelearningmastery.com/how-to-develop-convolutional-neural-network-models-for-time-series-forecasting/</a></p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-483507" class="comment even depth-5">

	      	<div id="li-comment-483507" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/3a74ea6007fe77df5f4ce609997adef3.jfif" srcset="https://secure.gravatar.com/avatar/3a74ea6007fe77df5f4ce609997adef3?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">maxv</span>
	                <span class="date">May 1, 2019 at 6:52 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-483507" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi<br>
I think you are pointing me again to the same tutorial but my questions come from this one.</p>
<p>Questions see above.</p>
<p>Question 1 :<br>
If I apply Conv1D, it should extract features out of all the 10 variables right ?<br>
or does it apply a Conv1D on each exogenous variable separately.</p>
<p>Question 2 : does it capture interactions of exogenous variables ?</p>
<p>Question 3 : </p>
<p>Does the Conv2D only work for images or for times series too ?</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-483531" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-5">

	      	<div id="li-comment-483531" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">May 1, 2019 at 7:11 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-483531" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>If you have multiple parallel time series, you can use separate 
Conv1D layers for each or one and merge into the model OR one Conv1D 
layer and treat each time series as a separate channel. </p>
<p>Test both, but I recommend the latter.</p>
<p>In both cases, the model will capture interactions.</p>
<p>No Conv2D can work for any data that has a temporal or spatial relationship in two dimensions.</p>

				
	                <div class="reply">
	                    	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-443049" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-443049" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/3cf8f70c2f3beffe2215471eda3a6329.jfif" srcset="https://secure.gravatar.com/avatar/3cf8f70c2f3beffe2215471eda3a6329?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">James</span>
	                <span class="date">July 10, 2018 at 12:34 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-443049" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks for the tutorial Jason, very informative. I wonder if you 
know of a relatively un-intrusive way of reducing the memory footprint 
of Grid (or equivalently Random) SearchCV, since they seem to store 
every model produced during the search in memory, instead of e.g just 
the best. I’m handling 3d data and trying 3d cnns, so the models quickly
 get too big to have e.g 25 in memory at once. </p>
<p>Wondered about hacky divide and conquer strategies on a higher level, e.g if the full space for a parameter is</p>
<p>[1,5,10,15,20,25], </p>
<p>do a grid search of [1,5,10], keep best model (m1) and discard the 
rest, search [15,20,25], keep best (m2), then keep best of [m1,m2], but 
this would still be fiddly/somewhat arbitrary to get correct for a given
 amount of memory and parameter space. I’d rather not have to implement 
my own parameter search, but if I go too far down this route I may as 
well end up doing so</p>
<p>Thanks</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-443049" data-commentid="443049" data-postid="2967" data-belowelement="comment-443049" data-respondelement="respond" aria-label="Reply to James">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-443085" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-443085" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">July 10, 2018 at 6:49 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-443085" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Split the search across multiple scripts and machines or implement the for-loops of the search yourself (preferred).</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-443085" data-commentid="443085" data-postid="2967" data-belowelement="comment-443085" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-443229" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-443229" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/78729a100e9f47e9d0a10ad5ee0c60a1.jfif" srcset="https://secure.gravatar.com/avatar/78729a100e9f47e9d0a10ad5ee0c60a1?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://farosikemas.tumblr.com/" rel="external nofollow" class="url">Kemas Farosi</a></span>
	                <span class="date">July 11, 2018 at 8:50 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-443229" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason, </p>
<p>Great tutorial, I have a question, is it possible to find how many 
hidden layers in my deep neural networks by grid search ? because i want
 to find the best layer numbers in my DNN. </p>
<p>thanks</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-443229" data-commentid="443229" data-postid="2967" data-belowelement="comment-443229" data-respondelement="respond" aria-label="Reply to Kemas Farosi">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-443257" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-443257" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">July 12, 2018 at 6:23 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-443257" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sure.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-443257" data-commentid="443257" data-postid="2967" data-belowelement="comment-443257" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-443917" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-443917" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1eff85a5bd70d28279a2aded7b814b79.jfif" srcset="https://secure.gravatar.com/avatar/1eff85a5bd70d28279a2aded7b814b79?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Vugar Bayramov</span>
	                <span class="date">July 19, 2018 at 11:33 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-443917" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason!!</p>
<p>Awesome content. Thanks very much for your effort.</p>
<p>I have a question regarding the model with multidimensional output. 
What i mean is my y_train is an array with [value1, value2, value3] 
which i am trying to predict. While using the example above for 
selection of the best activation function for my probelm i got this 
error below:</p>
<p>ValueError: y_true and y_pred have different number of output</p>
<p>How can i solve this issue?</p>
<p>Regards</p>
<p>Vugar</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-443917" data-commentid="443917" data-postid="2967" data-belowelement="comment-443917" data-respondelement="respond" aria-label="Reply to Vugar Bayramov">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-443940" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-443940" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">July 20, 2018 at 5:59 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-443940" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I believe scikit-learn does not support models that predict multiple outputs.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-443940" data-commentid="443940" data-postid="2967" data-belowelement="comment-443940" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-446107" class="comment even depth-2 parent">

	      	<div id="li-comment-446107" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/4832986d9349b1a0e21825477fbb64e2.jfif" srcset="https://secure.gravatar.com/avatar/4832986d9349b1a0e21825477fbb64e2?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Helmut</span>
	                <span class="date">August 15, 2018 at 12:33 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-446107" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Did you tried using the KerasRegressor instead of the KerasClassifier?</p>
<p><a href="https://keras.io/scikit-learn-api/" rel="nofollow">https://keras.io/scikit-learn-api/</a></p>
<p>This worked for me for predicting multiple values.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-446107" data-commentid="446107" data-postid="2967" data-belowelement="comment-446107" data-respondelement="respond" aria-label="Reply to Helmut">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-446136" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-3">

	      	<div id="li-comment-446136" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">August 15, 2018 at 6:05 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-446136" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Nice.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-446136" data-commentid="446136" data-postid="2967" data-belowelement="comment-446136" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-444547" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-444547" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/a786303cf3593cd112f117dd09200eef.jfif" srcset="https://secure.gravatar.com/avatar/a786303cf3593cd112f117dd09200eef?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Nick</span>
	                <span class="date">July 27, 2018 at 9:37 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-444547" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>While doing the grid search some combinations lead to a:<br>
ValueError: Input contains NaN, infinity or a value too large for dtype(‘float32’).</p>
<p>so the grid search stops. Do you know if its possible just to skip 
these combinations to prevent the search from stopping or why this 
happens with some NN hyperparameters?</p>
<p>Regards</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-444547" data-commentid="444547" data-postid="2967" data-belowelement="comment-444547" data-respondelement="respond" aria-label="Reply to Nick">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-444594" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-444594" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">July 28, 2018 at 6:35 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-444594" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Perhaps. It might be easier to run the grid search yourself with some for-loops.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-444594" data-commentid="444594" data-postid="2967" data-belowelement="comment-444594" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-444808" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-444808" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/409150541749ca67782c9bc8d71e9b78.jfif" srcset="https://secure.gravatar.com/avatar/409150541749ca67782c9bc8d71e9b78?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://-/" rel="external nofollow" class="url">billa</a></span>
	                <span class="date">July 30, 2018 at 10:29 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-444808" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Is it possible to tune the neurons inside the convolution layer for image classification?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-444808" data-commentid="444808" data-postid="2967" data-belowelement="comment-444808" data-respondelement="respond" aria-label="Reply to billa">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-444832" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-444832" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">July 31, 2018 at 6:01 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-444832" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sure.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-444832" data-commentid="444832" data-postid="2967" data-belowelement="comment-444832" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-444909" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-444909" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/fca5c1336412f6babdbf835e62cc4bb3.jfif" srcset="https://secure.gravatar.com/avatar/fca5c1336412f6babdbf835e62cc4bb3?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Zenon Uchida</span>
	                <span class="date">July 31, 2018 at 8:56 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-444909" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Do filters (in the code below) denote to number of neurons?<br>
conv = Conv1D(filters=64, kernel_size=5, activation=’relu’)(embedding)<br>
if not, should filters also be tuned?<br>
I’m pretty sure kernel_size should be tuned.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-444909" data-commentid="444909" data-postid="2967" data-belowelement="comment-444909" data-respondelement="respond" aria-label="Reply to Zenon Uchida">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-444956" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-444956" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">August 1, 2018 at 7:43 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-444956" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>No, they are the number of filters.</p>
<p>Yes, the number of filter pas and kernel size can and should be tuned.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-444956" data-commentid="444956" data-postid="2967" data-belowelement="comment-444956" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-445488" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-445488" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/9483a1bb083584ef5c8493741fb34bdf.jfif" srcset="https://secure.gravatar.com/avatar/9483a1bb083584ef5c8493741fb34bdf?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Khaw</span>
	                <span class="date">August 7, 2018 at 11:53 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-445488" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thank you for your awesome explanation.</p>
<p>Is it possible to do the same grid search for hyperparametrs in the R
 package Keras? I do not find the equivalent of the gridCV function</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-445488" data-commentid="445488" data-postid="2967" data-belowelement="comment-445488" data-respondelement="respond" aria-label="Reply to Khaw">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-445524" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-445524" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">August 8, 2018 at 6:22 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-445524" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>It may be, I don’t have an example, sorry.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-445524" data-commentid="445524" data-postid="2967" data-belowelement="comment-445524" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-446150" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-446150" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/75961a223c0229e2ccc30f4ad83b6248.jfif" srcset="https://secure.gravatar.com/avatar/75961a223c0229e2ccc30f4ad83b6248?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Beatriz</span>
	                <span class="date">August 15, 2018 at 10:05 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-446150" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>I’m trying to do a grid search in my Seq2Seq model.</p>
<p>I’m not sure if I understand the values X,Y I should put inside the grid.fit() function. </p>
<p>In my case, I tried two numpy arrays with three dimensions (samples, max length of words, number of characters)</p>
<p>Anyway, I’m not sure if that is the reason it is not working for me. I get the following error:</p>
<p>TypeError: Cannot clone object ” (type ): it does not seem to be a 
scikit-learn estimator as it does not implement a ‘get_params’ methods.</p>
<p>What do you think is going wrong?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-446150" data-commentid="446150" data-postid="2967" data-belowelement="comment-446150" data-respondelement="respond" aria-label="Reply to Beatriz">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-446153" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-446153" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">August 15, 2018 at 1:53 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-446153" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You might need to implement the for-loops of your grid search manually in order to have more control over the process.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-446153" data-commentid="446153" data-postid="2967" data-belowelement="comment-446153" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-446164" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-446164" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/b547d669b07df1f296903da2752d0adb.jfif" srcset="https://secure.gravatar.com/avatar/b547d669b07df1f296903da2752d0adb?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">ammara</span>
	                <span class="date">August 15, 2018 at 9:16 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-446164" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks for such a great content!!<br>
I have a query that what is the “random_state” used in deep models, is this a<br>
 hyper-parameter?if it is then how much it is important for model training. kindly guide me.<br>
Thanks in advance.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-446164" data-commentid="446164" data-postid="2967" data-belowelement="comment-446164" data-respondelement="respond" aria-label="Reply to ammara">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-446193" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-446193" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">August 16, 2018 at 6:05 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-446193" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>It seeds the random number generator, you can learn more here:<br>
<a href="https://machinelearningmastery.com/introduction-to-random-number-generators-for-machine-learning/" rel="nofollow">https://machinelearningmastery.com/introduction-to-random-number-generators-for-machine-learning/</a></p>
<p>Most algorithms use randomness in some way, and if you fix the seed, 
you get the same randomness each run. You can learn more here:<br>
<a href="https://machinelearningmastery.com/randomness-in-machine-learning/" rel="nofollow">https://machinelearningmastery.com/randomness-in-machine-learning/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-446193" data-commentid="446193" data-postid="2967" data-belowelement="comment-446193" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-446566" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-446566" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/a43d014cf72affb2f2e53168118c6e38.jfif" srcset="https://secure.gravatar.com/avatar/a43d014cf72affb2f2e53168118c6e38?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Hoo Yu Heng</span>
	                <span class="date">August 21, 2018 at 4:17 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-446566" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>For those who face the error of ‘cannot pickle object class’, 
make sure u use create_model and not create_model() in the 
KerasClassifier constructor:</p>
<p>model = KerasClassifier(build_fn=create_model, verbose=0, epochs=100)</p>
<p>not<br>
model = KerasClassifier(build_fn=create_model(), verbose=0, epochs=100)</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-446566" data-commentid="446566" data-postid="2967" data-belowelement="comment-446566" data-respondelement="respond" aria-label="Reply to Hoo Yu Heng">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-446588" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-446588" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">August 21, 2018 at 6:20 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-446588" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Great tip.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-446588" data-commentid="446588" data-postid="2967" data-belowelement="comment-446588" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-446648" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-446648" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1836f40f3d413a3d1c7ea847c865c667.jfif" srcset="https://secure.gravatar.com/avatar/1836f40f3d413a3d1c7ea847c865c667?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Natanos</span>
	                <span class="date">August 21, 2018 at 8:31 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-446648" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sorry but when I run this program, it ends in “Using TensorFlow backend” and not finished in almost 3 hours.</p>
<p>Is this normal? if not, what should I do? thanks</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-446648" data-commentid="446648" data-postid="2967" data-belowelement="comment-446648" data-respondelement="respond" aria-label="Reply to Natanos">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-446682" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-446682" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">August 22, 2018 at 6:11 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-446682" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Perhaps try searching fewer parameters?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-446682" data-commentid="446682" data-postid="2967" data-belowelement="comment-446682" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->

		<li id="comment-449330" class="comment even depth-2 parent">

	      	<div id="li-comment-449330" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1a57d923b9dffe385924bf4d7c5aa097.jfif" srcset="https://secure.gravatar.com/avatar/1a57d923b9dffe385924bf4d7c5aa097?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">clemm</span>
	                <span class="date">September 19, 2018 at 7:00 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-449330" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello,</p>
<p>Same problem here with a gridsearch reduced to one epoch and one 
batch_size : the fit function never ends (keras version : 2.2.2). But 
the same code worked with an other computer (keras version : 2.0.5).</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-449330" data-commentid="449330" data-postid="2967" data-belowelement="comment-449330" data-respondelement="respond" aria-label="Reply to clemm">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-449365" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-3">

	      	<div id="li-comment-449365" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">September 20, 2018 at 7:56 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-449365" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Perhaps run the grid search manually? Just some for-loops.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-449365" data-commentid="449365" data-postid="2967" data-belowelement="comment-449365" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-447045" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-447045" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/b1dbc589fffe735f9129587efe9ba597.jfif" srcset="https://secure.gravatar.com/avatar/b1dbc589fffe735f9129587efe9ba597?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Nathan Rasch</span>
	                <span class="date">August 27, 2018 at 10:28 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-447045" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Has anyone had a change to combine RandomizedSearchCV with SelectKBest?</p>
<p>I have a “FeatureUnion” that includes “SelectKBest”, but then the 
“model.add(Dense….” call in the model build function complains about the
 “input_dim” being incorrect.  I’m not sure how to attach to the value 
“SelectKBest” is currently considering as part of the random search, so 
that I can feed it to the build model function as a param for 
“input_dim”.</p>
<p>Ex:<br>
    features = []<br>
    features.append((‘Scaler’, StandardScaler()))<br>
    features.append((‘SelectKBest’, SelectKBest( k = 5)))<br>
    featureUnion = FeatureUnion(features)</p>
<p>def buildModel(optimizer = ‘Adam’, lr = 0.001, decay = 0.0, epsilon = None):<br>
    opt = None<br>
    model = Sequential()<br>
    model.add(Dense(20, input_dim = ???? …)</p>
<p>We get a nice, juicy error about the input dim when running this.  <img draggable="false" class="emoji" alt="🙁" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1f641.svg"></p>
<p>If anyone has a working example or link to some one who does I’d be very grateful.</p>
<p>Thanks!<br>
Nathan</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-447045" data-commentid="447045" data-postid="2967" data-belowelement="comment-447045" data-respondelement="respond" aria-label="Reply to Nathan Rasch">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-447047" class="comment odd alt depth-2 parent">

	      	<div id="li-comment-447047" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/b1dbc589fffe735f9129587efe9ba597.jfif" srcset="https://secure.gravatar.com/avatar/b1dbc589fffe735f9129587efe9ba597?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Nathan Rasch</span>
	                <span class="date">August 27, 2018 at 11:36 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-447047" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>OK, solved my own issue:</p>
<p>The key is just to remove the “input_dim” param from the “model.Add” 
method call.  Then you can pass whatever values you want to test with as
 part of the params dict.  </p>
<p>Ex:</p>
<p># Notice we don’t have a “Input dim” param on the model.add call anymore<br>
def buildModel():<br>
    model = Sequential()<br>
    model.add(Dense(20, kernel_initializer=’normal’, activation = ‘relu’))</p>
<p># We add the SelectKBest__k values we want to test to the “params” dict:<br>
params = {<br>
    ‘housingModel__epochs’ : [ 1, 2 ],<br>
    ‘housingModel__batch_size’ : [ 15, 30, 65 ],<br>
    ‘FeatureUnion__SelectKBest__k’: [5, 6, 7, 8, 9, 10]<br>
}</p>
<p># And create the FeatureUnion<br>
features = []<br>
    features.append((‘Scaler’, StandardScaler()))<br>
    features.append((‘SelectKBest’, SelectKBest()))<br>
    featureUnion = FeatureUnion(features)</p>
<p>And that’s that.  <img draggable="false" class="emoji" alt="🙂" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1f642.svg"></p>
<p>Thanks!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-447047" data-commentid="447047" data-postid="2967" data-belowelement="comment-447047" data-respondelement="respond" aria-label="Reply to Nathan Rasch">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-447053" class="comment byuser comment-author-jasonb bypostauthor even depth-3">

	      	<div id="li-comment-447053" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">August 27, 2018 at 1:57 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-447053" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Nice tip.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-447053" data-commentid="447053" data-postid="2967" data-belowelement="comment-447053" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-447052" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-447052" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">August 27, 2018 at 1:56 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-447052" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Perhaps write your own for-loop or use regularization to let the model ignore irrelevant features?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-447052" data-commentid="447052" data-postid="2967" data-belowelement="comment-447052" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-448339" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-448339" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/d888dc0858714aa7f9d6329f9adeafe1.jfif" srcset="https://secure.gravatar.com/avatar/d888dc0858714aa7f9d6329f9adeafe1?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Piyush</span>
	                <span class="date">September 11, 2018 at 2:15 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-448339" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>@Jason Brownlee</p>
<p>Great tutorial, though I suggest to combine all chunks of code and 
give a one final code which tunes all hyper parameters at once, e.g., 
define a grid with all hyper parameters rather than focusing on them one
 by one.</p>
<p>Also, once the tuned hyper parameters are found, provide a code with 
predictive model with tuned hyper parameters which can be used in actual
 problem to predict class labels.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-448339" data-commentid="448339" data-postid="2967" data-belowelement="comment-448339" data-respondelement="respond" aria-label="Reply to Piyush">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-448363" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-448363" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">September 11, 2018 at 6:31 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-448363" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks for the suggestion.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-448363" data-commentid="448363" data-postid="2967" data-belowelement="comment-448363" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-450188" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-450188" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/cd2fe67c3b0226aa004da122ffc5f96a.jfif" srcset="https://secure.gravatar.com/avatar/cd2fe67c3b0226aa004da122ffc5f96a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Michael Pappas</span>
	                <span class="date">September 29, 2018 at 7:23 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-450188" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Does anyone else has two problems with the first example? I’m using theano as backend and I run into two errors:</p>
<p>1) RuntimeError: You can’t initialize the GPU in a subprocess if the 
parent process already did it (goes away when I change .theanorc to cpu 
instead of cuda0)</p>
<p>2) 
sklearn.externals.joblib.externals.loky.process_executor.BrokenProcessPool:
 A task has failed to un-serialize. Please ensure that the arguments of 
the function are all picklable.</p>
<p>Any ideas?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-450188" data-commentid="450188" data-postid="2967" data-belowelement="comment-450188" data-respondelement="respond" aria-label="Reply to Michael Pappas">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-450284" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-450284" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">September 30, 2018 at 5:59 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-450284" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Perhaps try running on the CPU as a first step?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-450284" data-commentid="450284" data-postid="2967" data-belowelement="comment-450284" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-450436" class="comment even depth-3 parent">

	      	<div id="li-comment-450436" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/cd2fe67c3b0226aa004da122ffc5f96a.jfif" srcset="https://secure.gravatar.com/avatar/cd2fe67c3b0226aa004da122ffc5f96a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Michael Pappas</span>
	                <span class="date">October 2, 2018 at 1:04 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-450436" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Then I get the second error as mentioned above.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-450436" data-commentid="450436" data-postid="2967" data-belowelement="comment-450436" data-respondelement="respond" aria-label="Reply to Michael Pappas">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-450798" class="comment odd alt depth-4">

	      	<div id="li-comment-450798" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/ad91431ef6a6806eb1c298c282ceeefd.jfif" srcset="https://secure.gravatar.com/avatar/ad91431ef6a6806eb1c298c282ceeefd?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">FERNANDO FREGAPANE SCALIA</span>
	                <span class="date">October 6, 2018 at 2:52 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-450798" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I have the same error with all libraries updated.</p>
<p>Any ideas, please?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-450798" data-commentid="450798" data-postid="2967" data-belowelement="comment-450798" data-respondelement="respond" aria-label="Reply to FERNANDO FREGAPANE SCALIA">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-451540" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-451540" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/9211cbfeb8683cf11416b78fe0d213db.jfif" srcset="https://secure.gravatar.com/avatar/9211cbfeb8683cf11416b78fe0d213db?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Vasileios Papanikolaou</span>
	                <span class="date">October 13, 2018 at 11:23 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-451540" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hey Jason, thank you for this excellent post and your whole 
contribution to the ML/DL community! It really means a lot. I have quick
 q: Let’s say that once you define the model architecture and perform 
your first grid search over – say one hyperparameter. How can you 
redefine the model using the optimal hyperparameter, without rewriting 
the ‘create_model’ function? Thanks a lot in adavance</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-451540" data-commentid="451540" data-postid="2967" data-belowelement="comment-451540" data-respondelement="respond" aria-label="Reply to Vasileios Papanikolaou">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-451578" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-451578" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">October 14, 2018 at 5:59 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-451578" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You can create the model directly, using the hyperparametres found via the search.</p>
<p>Perhaps I’m missing something in your question?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-451578" data-commentid="451578" data-postid="2967" data-belowelement="comment-451578" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-453653" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-453653" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/019934e639e0ef77343573adc02800ed.jfif" srcset="https://secure.gravatar.com/avatar/019934e639e0ef77343573adc02800ed?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Janosh Riebesell</span>
	                <span class="date">November 4, 2018 at 9:04 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-453653" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Slight correction:</p>
<p>&gt; We can see that the dropout rate of 0.2% and the maxnorm weight constraint of 4 resulted in the best accuracy of about 72%.</p>
<p>Should be either 0.2 or 20 %.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-453653" data-commentid="453653" data-postid="2967" data-belowelement="comment-453653" data-respondelement="respond" aria-label="Reply to Janosh Riebesell">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-453688" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-453688" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">November 5, 2018 at 6:12 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-453688" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks, fixed.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-453688" data-commentid="453688" data-postid="2967" data-belowelement="comment-453688" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-453784" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-453784" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/ad21dd4eb0bfab329b8ff15e05d3bb87.jfif" srcset="https://secure.gravatar.com/avatar/ad21dd4eb0bfab329b8ff15e05d3bb87?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Robert Guenther</span>
	                <span class="date">November 6, 2018 at 5:51 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-453784" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Jason,</p>
<p>Ditto all the good things said above. You definitely are fulfilling 
your mission of making us (data scientist) better at machine learning.</p>
<p>Thank you,<br>
Robert</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-453784" data-commentid="453784" data-postid="2967" data-belowelement="comment-453784" data-respondelement="respond" aria-label="Reply to Robert Guenther">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-453801" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-453801" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">November 6, 2018 at 6:36 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-453801" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks Robert.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-453801" data-commentid="453801" data-postid="2967" data-belowelement="comment-453801" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-454782" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-454782" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/083010832ddcf73b18d982174fae8e39.jfif" srcset="https://secure.gravatar.com/avatar/083010832ddcf73b18d982174fae8e39?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">sukhpal</span>
	                <span class="date">November 15, 2018 at 12:43 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-454782" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>when i run the above code i got this message </p>
<p>model = Sequential()<br>
        ^<br>
IndentationError: expected an indented block<br>
kindly help me to remove this error</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-454782" data-commentid="454782" data-postid="2967" data-belowelement="comment-454782" data-respondelement="respond" aria-label="Reply to sukhpal">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-454806" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-454806" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">November 15, 2018 at 5:35 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-454806" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Ensure you indent the code correctly.</p>
<p>Here’s help on how to copy-paste the code:<br>
<a href="https://machinelearningmastery.com/faq/single-faq/how-do-i-copy-code-from-a-tutorial" rel="nofollow">https://machinelearningmastery.com/faq/single-faq/how-do-i-copy-code-from-a-tutorial</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-454806" data-commentid="454806" data-postid="2967" data-belowelement="comment-454806" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-454850" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-454850" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/48d9bedea509104bf12b0f7616b1a753.jfif" srcset="https://secure.gravatar.com/avatar/48d9bedea509104bf12b0f7616b1a753?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Long</span>
	                <span class="date">November 15, 2018 at 2:03 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-454850" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Great tutorial as always,</p>
<p>I also had 1 experience with Keras &amp; scikit-learn wrapper when 
doing the train-test split. It turned out that I should not use params 
like validation_split/validation_data in Keras because cross validation 
from GridSearchCV already takes care of that.</p>
<p>I would like to ask, should I use scoring metrics from Keras itself or should I use metrics provided by GridSearchCV?<br>
The docs here is not really clear <a href="https://keras.io/scikit-learn-api" rel="nofollow">https://keras.io/scikit-learn-api</a></p>
<p>And how about other parameters (if available) that appear to be 
overridden by scikit-learn wrapper), which ones should I pick, keras or 
scikit-learn?</p>
<p>Thank you so much Jason.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-454850" data-commentid="454850" data-postid="2967" data-belowelement="comment-454850" data-respondelement="respond" aria-label="Reply to Long">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-454924" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-454924" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">November 16, 2018 at 6:11 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-454924" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Probably use sklearn’s metrics.</p>
<p>What other parameters exactly?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-454924" data-commentid="454924" data-postid="2967" data-belowelement="comment-454924" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-455022" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-455022" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/083010832ddcf73b18d982174fae8e39.jfif" srcset="https://secure.gravatar.com/avatar/083010832ddcf73b18d982174fae8e39?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">sukhpal</span>
	                <span class="date">November 16, 2018 at 9:12 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-455022" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>when i run the code i receive this message instead of output.kindly help me</p>
<p>runfile(‘C:/Users/sukhpal/untitled9.py’, wdir=’C:/Users/sukhpal’)<br>
Using Theano backend.<br>
C:\Users\sukhpal\Anaconda2\lib\site-packages\sklearn\cross_validation.py:44:
 DeprecationWarning: This module was deprecated in version 0.18 in favor
 of the model_selection module into which all the refactored classes and
 functions are moved. Also note that the interface of the new CV 
iterators are different from that of this module. This module will be 
removed in 0.20.<br>
  “This module will be removed in 0.20.”, DeprecationWarning)</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-455022" data-commentid="455022" data-postid="2967" data-belowelement="comment-455022" data-respondelement="respond" aria-label="Reply to sukhpal">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-455075" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-455075" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">November 17, 2018 at 5:46 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-455075" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Looks like a warning, you can ignore for now.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-455075" data-commentid="455075" data-postid="2967" data-belowelement="comment-455075" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-455120" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-455120" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/083010832ddcf73b18d982174fae8e39.jfif" srcset="https://secure.gravatar.com/avatar/083010832ddcf73b18d982174fae8e39?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">sukhpal</span>
	                <span class="date">November 17, 2018 at 1:34 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-455120" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>but sir no output is displayed on screen</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-455120" data-commentid="455120" data-postid="2967" data-belowelement="comment-455120" data-respondelement="respond" aria-label="Reply to sukhpal">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-455227" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-455227" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">November 18, 2018 at 6:38 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-455227" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I have some suggestions here:<br>
<a href="https://machinelearningmastery.com/faq/single-faq/why-does-the-code-in-the-tutorial-not-work-for-me" rel="nofollow">https://machinelearningmastery.com/faq/single-faq/why-does-the-code-in-the-tutorial-not-work-for-me</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-455227" data-commentid="455227" data-postid="2967" data-belowelement="comment-455227" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-455129" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-455129" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/de204e435ab87b81f7991777c7b8abe9.jfif" srcset="https://secure.gravatar.com/avatar/de204e435ab87b81f7991777c7b8abe9?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">kamal</span>
	                <span class="date">November 17, 2018 at 4:44 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-455129" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>sir as my program also gives no error but no output is displayed on screen</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-455129" data-commentid="455129" data-postid="2967" data-belowelement="comment-455129" data-respondelement="respond" aria-label="Reply to kamal">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-455228" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-455228" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">November 18, 2018 at 6:38 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-455228" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Ensure you are running from the command line and wait a few minutes.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-455228" data-commentid="455228" data-postid="2967" data-belowelement="comment-455228" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-455366" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-455366" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/de204e435ab87b81f7991777c7b8abe9.jfif" srcset="https://secure.gravatar.com/avatar/de204e435ab87b81f7991777c7b8abe9?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">kamal</span>
	                <span class="date">November 19, 2018 at 12:57 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-455366" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>sir when i run the code from command prompt it gives me this error<br>
Traceback (most recent call last):<br>
  File “C:/Python27/oop1.py”, line 3, in<br>
    from sklearn.model_selection import GridSearchCV<br>
  File “C:\Python27\lib\site-packages\sklearn\__init__.py”, line 134, in<br>
    from .base import clone<br>
  File “C:\Python27\lib\site-packages\sklearn\base.py”, line 11, in<br>
    from scipy import sparse<br>
ImportError: No module named scipy</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-455366" data-commentid="455366" data-postid="2967" data-belowelement="comment-455366" data-respondelement="respond" aria-label="Reply to kamal">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-455437" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-455437" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">November 19, 2018 at 6:47 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-455437" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Looks like you need to install scipy, this might help:<br>
<a href="https://machinelearningmastery.com/setup-python-environment-machine-learning-deep-learning-anaconda/" rel="nofollow">https://machinelearningmastery.com/setup-python-environment-machine-learning-deep-learning-anaconda/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-455437" data-commentid="455437" data-postid="2967" data-belowelement="comment-455437" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-455525" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-455525" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/0b2c4ac32d16fe897ca349f7e48b1199.jfif" srcset="https://secure.gravatar.com/avatar/0b2c4ac32d16fe897ca349f7e48b1199?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Kareem JEIROUDI</span>
	                <span class="date">November 20, 2018 at 12:08 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-455525" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hey Jason,</p>
<p>A very helpful post, thanks for your efforts. However, I’m still 
wondering if you can put these optimizations together, do you think 
that’s possible?? And if so, how?<br>
The problem is that in your examples, you could configure the learning 
rate and momentum only as you used SGD but not any other optimizer.<br>
I’ll try to write a function such that one can specify all these 
parameters before grid-searching, plus I’d like to modify the number of 
layers in a network.<br>
Let me know what you think about all this.<br>
Thanks again for this awesome post!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-455525" data-commentid="455525" data-postid="2967" data-belowelement="comment-455525" data-respondelement="respond" aria-label="Reply to Kareem JEIROUDI">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-455565" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-455565" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">November 20, 2018 at 6:36 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-455565" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I’m not sure I understand, sorry. Perhaps you can elaborate?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-455565" data-commentid="455565" data-postid="2967" data-belowelement="comment-455565" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-455536" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-455536" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/de204e435ab87b81f7991777c7b8abe9.jfif" srcset="https://secure.gravatar.com/avatar/de204e435ab87b81f7991777c7b8abe9?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">kamal</span>
	                <span class="date">November 20, 2018 at 2:15 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-455536" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>sir as i have installed theano keras now my run option in editor 
window of python disappear.sir how i run my program as there is no 
direct option of run.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-455536" data-commentid="455536" data-postid="2967" data-belowelement="comment-455536" data-respondelement="respond" aria-label="Reply to kamal">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-455571" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-455571" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">November 20, 2018 at 6:38 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-455571" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Perhaps it will take a while to run?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-455571" data-commentid="455571" data-postid="2967" data-belowelement="comment-455571" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-455600" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-455600" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/de204e435ab87b81f7991777c7b8abe9.jfif" srcset="https://secure.gravatar.com/avatar/de204e435ab87b81f7991777c7b8abe9?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">kamal</span>
	                <span class="date">November 20, 2018 at 12:09 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-455600" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>sir my program give this error now…plz help me<br>
======================== RESTART: C:\Python27\oop1.py ========================<br>
Using Theano backend.</p>
<p>You can find the C code in this temporary file: c:\users\sukhpal\appdata\local\temp\theano_compilation_error_ei4ugz</p>
<p>Traceback (most recent call last):<br>
  File “C:\Python27\oop1.py”, line 4, in<br>
    from keras.models import Sequential<br>
  File “C:\Python27\lib\site-packages\keras\__init__.py”, line 3, in<br>
    from . import utils<br>
  File “C:\Python27\lib\site-packages\keras\utils\__init__.py”, line 6, in<br>
    from . import conv_utils<br>
  File “C:\Python27\lib\site-packages\keras\utils\conv_utils.py”, line 9, in<br>
    from .. import backend as K<br>
  File “C:\Python27\lib\site-packages\keras\backend\__init__.py”, line 86, in<br>
    from .theano_backend import *<br>
  File “C:\Python27\lib\site-packages\keras\backend\theano_backend.py”, line 7, in<br>
    import theano<br>
  File “C:\Python27\lib\site-packages\theano\__init__.py”, line 110, in<br>
    from theano.compile import (<br>
  File “C:\Python27\lib\site-packages\theano\compile\__init__.py”, line 12, in<br>
    from theano.compile.mode import *<br>
  File “C:\Python27\lib\site-packages\theano\compile\mode.py”, line 11, in<br>
    import theano.gof.vm<br>
  File “C:\Python27\lib\site-packages\theano\gof\vm.py”, line 674, in<br>
    from . import lazylinker_c<br>
  File “C:\Python27\lib\site-packages\theano\gof\lazylinker_c.py”, line 140, in<br>
    preargs=args)<br>
  File “C:\Python27\lib\site-packages\theano\gof\cmodule.py”, line 2388, in compile_str<br>
    (status, compile_stderr.replace(‘\n’, ‘. ‘)))<br>
Exception: Compilation failed (return status=1): The system cannot find the path specified.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-455600" data-commentid="455600" data-postid="2967" data-belowelement="comment-455600" data-respondelement="respond" aria-label="Reply to kamal">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-455618" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-455618" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">November 20, 2018 at 2:06 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-455618" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Looks like your environment is not setup correctly, perhaps this will help:<br>
<a href="https://machinelearningmastery.com/setup-python-environment-machine-learning-deep-learning-anaconda/" rel="nofollow">https://machinelearningmastery.com/setup-python-environment-machine-learning-deep-learning-anaconda/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-455618" data-commentid="455618" data-postid="2967" data-belowelement="comment-455618" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-455849" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-455849" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/de204e435ab87b81f7991777c7b8abe9.jfif" srcset="https://secure.gravatar.com/avatar/de204e435ab87b81f7991777c7b8abe9?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">kamal</span>
	                <span class="date">November 22, 2018 at 7:28 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-455849" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>sir when i run the program in python ieditor window i encounter this problem<br>
Using Theano backend.<br>
WARNING (theano.configdefaults): g++ not available, if using conda: <code>conda install m2w64-toolchain</code></p>
<p>Warning (from warnings module):<br>
  File “C:\Python27\lib\site-packages\theano\configdefaults.py”, line 560<br>
    warnings.warn(“DeprecationWarning: there is no c++ compiler.”<br>
UserWarning: DeprecationWarning: there is no c++ compiler.This is 
deprecated and with Theano 0.11 a c++ compiler will be mandatory<br>
WARNING (theano.configdefaults): g++ not detected ! Theano will be 
unable to execute optimized C-implementations (for both CPU and GPU) and
 will default to Python implementations. Performance will be severely 
degraded. To remove this warning, set Theano flags cxx to an empty 
string.<br>
WARNING (theano.tensor.blas): Using NumPy C-API based implementation for BLAS functions.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-455849" data-commentid="455849" data-postid="2967" data-belowelement="comment-455849" data-respondelement="respond" aria-label="Reply to kamal">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-455887" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-455887" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">November 23, 2018 at 7:47 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-455887" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Perhaps ignore these warnings for now.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-455887" data-commentid="455887" data-postid="2967" data-belowelement="comment-455887" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-456136" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-456136" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/fe19a21a7e3f3fea144484b5815c507d.jfif" srcset="https://secure.gravatar.com/avatar/fe19a21a7e3f3fea144484b5815c507d?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Steven Veenma</span>
	                <span class="date">November 26, 2018 at 1:50 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-456136" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks for this excellent tutorial. It helped me getting a 
feeling using different parameters.  I use Keras/Tensorflow/GPU and with
 smaller grids this works fine. But when I search for a larger grid I am
 running into errors. The GPU seems to keep old models in the memory. 
clear.session() apparently is not been implemented in 
keras.wrappers.scikit_learn.KerasClassifier. I raised an issue of this 
at <a href="https://github.com/keras-team/keras/issues/11693" rel="nofollow">https://github.com/keras-team/keras/issues/11693</a> where you can find more details. If this can’t be solved I have two options:<br>
1. Try it with Theano<br>
2. Program a function myself that does the job and implement clear.session() in it<br>
Or do you have another advice?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-456136" data-commentid="456136" data-postid="2967" data-belowelement="comment-456136" data-respondelement="respond" aria-label="Reply to Steven Veenma">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-456153" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-456153" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">November 26, 2018 at 6:20 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-456153" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Nice discovery.</p>
<p>For larger searches, I recommend writing a custom for-loop, output 
results to file and even spread the search across multiple machines 
(sub-grids).</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-456153" data-commentid="456153" data-postid="2967" data-belowelement="comment-456153" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-456517" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-456517" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/fe015aa325c37812caf0df181abc37c9.jfif" srcset="https://secure.gravatar.com/avatar/fe015aa325c37812caf0df181abc37c9?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Nate Star</span>
	                <span class="date">November 29, 2018 at 5:37 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-456517" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks for the great post! However, when we do hyper-parameter 
tuning, shouldn’t we be utilizing cross-fold validation and optimizing 
for the average validation error across folds? In this article we are 
optimizing for training accuracy which would bias our model towards the 
training data and may lead to parameters that do not generalize well.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-456517" data-commentid="456517" data-postid="2967" data-belowelement="comment-456517" data-respondelement="respond" aria-label="Reply to Nate Star">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-456547" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-456547" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">November 29, 2018 at 7:48 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-456547" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, we are using cross-validation for tuning in this tutorial.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-456547" data-commentid="456547" data-postid="2967" data-belowelement="comment-456547" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-459809" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-459809" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/55f6ddc282d914a3aa95572503af8133.jfif" srcset="https://secure.gravatar.com/avatar/55f6ddc282d914a3aa95572503af8133?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">MK</span>
	                <span class="date">December 24, 2018 at 6:24 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-459809" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi,</p>
<p>First of all thank you so much for this great post! I have one question:</p>
<p>Is it possible to optimize both learning rate and optimizer type 
together ? Because i am getting error when i try, error tells me that 
“learning_rate” is not a legal parameter”. Could you please give me some
 hint about it.</p>
<p>Thank you in advance</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-459809" data-commentid="459809" data-postid="2967" data-belowelement="comment-459809" data-respondelement="respond" aria-label="Reply to MK">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-459971" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-459971" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">December 25, 2018 at 7:15 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-459971" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Not really, pick an optimizer (e.g. SGD), then tune the learning rate.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-459971" data-commentid="459971" data-postid="2967" data-belowelement="comment-459971" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-460045" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-460045" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/681714f3c70a5fa1d1bb7bbecd2b0b2a.jfif" srcset="https://secure.gravatar.com/avatar/681714f3c70a5fa1d1bb7bbecd2b0b2a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Jitendra</span>
	                <span class="date">December 25, 2018 at 8:49 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-460045" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello Jason, I am building a stateful model and have initiated 
batch_size as 20. This works well while I am fitting the model after 
passing batch_size=batch_size in mode.fit. </p>
<p>However, batch_size=batch_size doesn’t seem to work while I am predicting on test set. </p>
<p>Is there a rule or something which I am missing which states that we 
have to use different batch sizes for train and test. One that I am 
aware of explains that train and test lengths have to be multiples of 
batch size. Request your help please.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-460045" data-commentid="460045" data-postid="2967" data-belowelement="comment-460045" data-respondelement="respond" aria-label="Reply to Jitendra">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-460097" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-460097" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">December 26, 2018 at 6:43 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-460097" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Batch size really only matters during training, it is part of 
SGD. It is only used for memory efficiency at test time – no effect on 
model skill.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-460097" data-commentid="460097" data-postid="2967" data-belowelement="comment-460097" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-460143" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-460143" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/083010832ddcf73b18d982174fae8e39.jfif" srcset="https://secure.gravatar.com/avatar/083010832ddcf73b18d982174fae8e39?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">kamal</span>
	                <span class="date">December 26, 2018 at 4:08 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-460143" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>sir can be combine all the codes into one to produce single optimal model</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-460143" data-commentid="460143" data-postid="2967" data-belowelement="comment-460143" data-respondelement="respond" aria-label="Reply to kamal">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-460214" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-460214" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">December 27, 2018 at 5:40 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-460214" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>The code finds a set of hyperparametres for configuring a model for your problem.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-460214" data-commentid="460214" data-postid="2967" data-belowelement="comment-460214" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-461237" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-461237" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/2fa03ae469511307600475fc8ffd2bee.jfif" srcset="https://secure.gravatar.com/avatar/2fa03ae469511307600475fc8ffd2bee?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Paul</span>
	                <span class="date">January 3, 2019 at 11:58 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-461237" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Would it be beneficial to do nested cross validation instead? So 
first doing a gridsearch, and then cross validating the gridsearch 
results.<br>
Thanks!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-461237" data-commentid="461237" data-postid="2967" data-belowelement="comment-461237" data-respondelement="respond" aria-label="Reply to Paul">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-461327" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-461327" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">January 4, 2019 at 6:24 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-461327" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>It might be, it depends on how much data you have. Not enough and the results may be optimistic.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-461327" data-commentid="461327" data-postid="2967" data-belowelement="comment-461327" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-464374" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-464374" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/070be68e6e594dcbed196bac4955792d.jfif" srcset="https://secure.gravatar.com/avatar/070be68e6e594dcbed196bac4955792d?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Martin</span>
	                <span class="date">January 21, 2019 at 5:17 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-464374" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>In those examples there are no hidden layers. The first layer, i.e. the input layer, isn’t hidden layer. Is that right?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-464374" data-commentid="464374" data-postid="2967" data-belowelement="comment-464374" data-respondelement="respond" aria-label="Reply to Martin">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-464389" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-464389" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">January 21, 2019 at 5:36 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-464389" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>There are input, hidden and output layers.</p>
<p>Recall, the input layer is defined via the “input_dim” argument on the first hidden layer.</p>
<p>More details here:<br>
<a href="https://machinelearningmastery.com/faq/single-faq/how-do-you-define-the-input-layer-in-keras" rel="nofollow">https://machinelearningmastery.com/faq/single-faq/how-do-you-define-the-input-layer-in-keras</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-464389" data-commentid="464389" data-postid="2967" data-belowelement="comment-464389" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-464395" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-464395" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/070be68e6e594dcbed196bac4955792d.jfif" srcset="https://secure.gravatar.com/avatar/070be68e6e594dcbed196bac4955792d?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Martin</span>
	                <span class="date">January 21, 2019 at 5:53 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-464395" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks Jason. In keras the first input layer is the first hidden layer!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-464395" data-commentid="464395" data-postid="2967" data-belowelement="comment-464395" data-respondelement="respond" aria-label="Reply to Martin">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-464419" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-464419" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">January 21, 2019 at 11:57 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-464419" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>No, the input layer is defined via an argument on the first hidden layer. A hidden layer is not an input layer.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-464419" data-commentid="464419" data-postid="2967" data-belowelement="comment-464419" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-465803" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-465803" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1dc56678cfe1de242da7fa6eb38cb31a.jfif" srcset="https://secure.gravatar.com/avatar/1dc56678cfe1de242da7fa6eb38cb31a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="https://www.linkedin.com/in/alexandregiulietti/" rel="external nofollow" class="url">Alex</a></span>
	                <span class="date">January 31, 2019 at 11:36 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-465803" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Jason, thank you for the excellent post. This was exactly what I 
needed. I have a feed-forward MLP network that I use to predict dam 
water inflow (for energy generation in Brazil) from past rainfall. By 
combining Keras and GridSearchCV I managed to find the best set of 
hyperparameters for my task.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-465803" data-commentid="465803" data-postid="2967" data-belowelement="comment-465803" data-respondelement="respond" aria-label="Reply to Alex">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-465864" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-465864" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">February 1, 2019 at 5:39 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-465864" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Well done!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-465864" data-commentid="465864" data-postid="2967" data-belowelement="comment-465864" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-465921" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-465921" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/24e53baac749e508e75a5d824f72caa6.jfif" srcset="https://secure.gravatar.com/avatar/24e53baac749e508e75a5d824f72caa6?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">jessy</span>
	                <span class="date">February 1, 2019 at 9:47 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-465921" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>sir,<br>
     i have tried above in anaconda prompt. its taking lot of time to 
execute …pls tell me another way(or) to execute same code in anaconda</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-465921" data-commentid="465921" data-postid="2967" data-belowelement="comment-465921" data-respondelement="respond" aria-label="Reply to jessy">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-465942" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-465942" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">February 1, 2019 at 11:05 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-465942" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I have some suggestions:</p>
<p>Perhaps try testing fewer hyperparameters?<br>
Perhaps try running on less data?<br>
Perhaps try running on a faster computer?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-465942" data-commentid="465942" data-postid="2967" data-belowelement="comment-465942" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-465924" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-465924" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/24e53baac749e508e75a5d824f72caa6.jfif" srcset="https://secure.gravatar.com/avatar/24e53baac749e508e75a5d824f72caa6?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">jagon</span>
	                <span class="date">February 1, 2019 at 10:08 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-465924" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>jagon<br>
             give me an idea to execute same code in diiferent ways ….tell me steps</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-465924" data-commentid="465924" data-postid="2967" data-belowelement="comment-465924" data-respondelement="respond" aria-label="Reply to jagon">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-465943" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-465943" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">February 1, 2019 at 11:05 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-465943" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>What do you mean exactly?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-465943" data-commentid="465943" data-postid="2967" data-belowelement="comment-465943" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-467474" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-467474" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/24e53baac749e508e75a5d824f72caa6.jfif" srcset="https://secure.gravatar.com/avatar/24e53baac749e508e75a5d824f72caa6?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">jagon</span>
	                <span class="date">February 8, 2019 at 9:54 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-467474" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>jagon<br>
          sir i have executed the above code in anaconda prompt,another way of executing same code ..tell me steps pls…</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-467474" data-commentid="467474" data-postid="2967" data-belowelement="comment-467474" data-respondelement="respond" aria-label="Reply to jagon">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-467483" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-467483" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">February 8, 2019 at 2:08 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-467483" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I explain how to run code here:<br>
<a href="https://machinelearningmastery.com/faq/single-faq/how-do-i-run-a-script-from-the-command-line" rel="nofollow">https://machinelearningmastery.com/faq/single-faq/how-do-i-run-a-script-from-the-command-line</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-467483" data-commentid="467483" data-postid="2967" data-belowelement="comment-467483" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-467792" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-467792" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/5f4a8c800d8bc7448b290942ea3679f6.jfif" srcset="https://secure.gravatar.com/avatar/5f4a8c800d8bc7448b290942ea3679f6?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Wonbin</span>
	                <span class="date">February 11, 2019 at 9:18 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-467792" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thank you so much for this really helpful post! I’ve been 
learning all about ML here in your posts since the beginning. Thank you <img draggable="false" class="emoji" alt="🙂" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1f642.svg"></p>
<p>I have still one question now even though I read all your comments and links about the question that people have asked.<br>
When it comes to regression tasks, we might configure in</p>
<p>———————————————-<br>
scoring=’neg_mean_squared_error’<br>
———————————————-</p>
<p>and the result will return ‘the negated value of the metric’ (this maybe means negative value?) like below.</p>
<p>——————————————————————————————<br>
Best: -19222385.393424 using {‘optimizer’: ‘Adamax’}<br>
-3704635991.649002 (2334839512.648289) with: {‘optimizer’: ‘SGD’}<br>
-21009285.029564 (9977061.839532) with: {‘optimizer’: ‘RMSprop’}<br>
-19966418.799906 (9785063.647908) with: {‘optimizer’: ‘Adagrad’}<br>
-21064977.853754 (9371950.402550) with: {‘optimizer’: ‘Adadelta’}<br>
-19659670.962081 (9634316.972027) with: {‘optimizer’: ‘Adam’}<br>
-19222385.393424 (9437755.930065) with: {‘optimizer’: ‘Adamax’}<br>
-19785109.598847 (9571852.777559) with: {‘optimizer’: ‘Nadam’}<br>
——————————————————————————————</p>
<p>So should I just use 19222385.393424 as MSE instead of minus 19222385.393424?<br>
Is the value (after deleting the minus) MSE of the model?<br>
I couldn’t really get what the minus is meaning…</p>
<p>I look forward to your reply. Thank you for your help!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-467792" data-commentid="467792" data-postid="2967" data-belowelement="comment-467792" data-respondelement="respond" aria-label="Reply to Wonbin">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-467911" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-467911" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">February 12, 2019 at 8:01 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-467911" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, the scikit-learn will invert the metric and make it negative. More here:<br>
<a href="https://machinelearningmastery.com/faq/single-faq/why-are-some-scores-like-mse-negative-in-scikit-learn" rel="nofollow">https://machinelearningmastery.com/faq/single-faq/why-are-some-scores-like-mse-negative-in-scikit-learn</a></p>
<p>That is a very large loss, perhaps the model can be improved?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-467911" data-commentid="467911" data-postid="2967" data-belowelement="comment-467911" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-467972" class="comment even depth-3 parent">

	      	<div id="li-comment-467972" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/5f4a8c800d8bc7448b290942ea3679f6.jfif" srcset="https://secure.gravatar.com/avatar/5f4a8c800d8bc7448b290942ea3679f6?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Wonbin</span>
	                <span class="date">February 12, 2019 at 2:36 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-467972" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Cheers mate! I checked your Frequently Asked Questions section 
and it looked the minus can be just ignored. But another reason I was 
confused with the number (‘Best: -19222385.393424′ in here) is like 
below, please see the output of my code.</p>
<p> In:<br>
——————————————————————————————<br>
def create_model(optimizer=’adam’):<br>
    …<br>
    # Compile model<br>
    model.compile(loss=’mae’, optimizer=optimizer, metrics=[‘mse’])<br>
    …</p>
<p># create model<br>
model = KerasRegressor(build_fn=create_model, verbose=2, epochs=300, batch_size=256)<br>
——————————————————————————————</p>
<p>Out:<br>
——————————————————————————————<br>
Epoch 1/1<br>
 – 41s – loss: 2958.7100 – mean_squared_error: 45877955.0626<br>
——————————————————————————————<br>
(I just set the eopch to 1)</p>
<p> In:<br>
——————————————————————————————<br>
# summarize results<br>
…<br>
——————————————————————————————</p>
<p>Out:<br>
——————————————————————————————<br>
Best: -19222385.393424 using {‘optimizer’: ‘Adamax’}</p>
<p>-3704635991.649002 (2334839512.648289) with: {‘optimizer’: ‘SGD’}<br>
-21009285.029564 (9977061.839532) with: {‘optimizer’: ‘RMSprop’}<br>
-19966418.799906 (9785063.647908) with: {‘optimizer’: ‘Adagrad’}<br>
-21064977.853754 (9371950.402550) with: {‘optimizer’: ‘Adadelta’}<br>
-19659670.962081 (9634316.972027) with: {‘optimizer’: ‘Adam’}<br>
-19222385.393424 (9437755.930065) with: {‘optimizer’: ‘Adamax’}<br>
-19785109.598847 (9571852.777559) with: {‘optimizer’: ‘Nadam’}<br>
——————————————————————————————</p>
<p>So, my question is why the best score(19222385.393424) quite 
different with the mean_squared_error (45877955.0626) which was the 
output of the first code?</p>
<p>About your comment “That is a very large loss, perhaps the model can be improved?”,<br>
I didn’t transform the target variable (like log-transformation). Is 
transforming the target variable necessary in neural networks?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-467972" data-commentid="467972" data-postid="2967" data-belowelement="comment-467972" data-respondelement="respond" aria-label="Reply to Wonbin">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-468048" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-4">

	      	<div id="li-comment-468048" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">February 13, 2019 at 7:48 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-468048" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, I recommend scaling the target variable (and input vars) before modeling. See this post:<br>
<a href="https://machinelearningmastery.com/how-to-improve-neural-network-stability-and-modeling-performance-with-data-scaling/" rel="nofollow">https://machinelearningmastery.com/how-to-improve-neural-network-stability-and-modeling-performance-with-data-scaling/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-468048" data-commentid="468048" data-postid="2967" data-belowelement="comment-468048" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-468465" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-468465" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/5f4a8c800d8bc7448b290942ea3679f6.jfif" srcset="https://secure.gravatar.com/avatar/5f4a8c800d8bc7448b290942ea3679f6?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Wonbin</span>
	                <span class="date">February 15, 2019 at 2:34 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-468465" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks for your help always!<br>
I spent about 2 weeks tuning hyperparameters, but very unfortunately I 
got in serious troubles and may have to redo all the things because of 
the two reasons…<br>
I want to ask you two questions..<br>
————————————————-<br>
Q1) Is there a good guideline on the sequence of hyperparameters to be tuned?<br>
e.g. What parameters should I last dive into especially to prevent from wasting time?</p>
<p>Q2) Between loss and metrics(like ‘mse, ‘mape’ and so on), which one should I see when choosing the best parameters?<br>
————————————————-<br>
Could you please give me some advice on the above questions….?</p>
<p>(p.s. I’m doing on a regression task)</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-468465" data-commentid="468465" data-postid="2967" data-belowelement="comment-468465" data-respondelement="respond" aria-label="Reply to Wonbin">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-468532" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2 parent">

	      	<div id="li-comment-468532" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">February 15, 2019 at 8:14 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-468532" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, learning rate is key. More details here:<br>
<a href="https://machinelearningmastery.com/learning-rate-for-deep-learning-neural-networks/" rel="nofollow">https://machinelearningmastery.com/learning-rate-for-deep-learning-neural-networks/</a></p>
<p>Minimizing loss (the thing optimized) is the area to focus on. The 
metric is the thing you care about when describing the performance of 
the model to others. Often better loss is better metrics, but not 
always.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-468532" data-commentid="468532" data-postid="2967" data-belowelement="comment-468532" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-468591" class="comment even depth-3">

	      	<div id="li-comment-468591" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/5f4a8c800d8bc7448b290942ea3679f6.jfif" srcset="https://secure.gravatar.com/avatar/5f4a8c800d8bc7448b290942ea3679f6?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Wonbin</span>
	                <span class="date">February 15, 2019 at 1:48 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-468591" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thank you so much!!! You’re an angle</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-468591" data-commentid="468591" data-postid="2967" data-belowelement="comment-468591" data-respondelement="respond" aria-label="Reply to Wonbin">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-469847" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-469847" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/e5317d84d233c64b37ddc627bb5496a8.jfif" srcset="https://secure.gravatar.com/avatar/e5317d84d233c64b37ddc627bb5496a8?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Edu</span>
	                <span class="date">February 22, 2019 at 10:21 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-469847" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi, Jones. Congratulations on the content. If possible, I would 
like to ask a question. I read and reread the part “How to Tune the 
Number of Neurons in the Hidden Layer” and I could not understand what 
would change in the code if the output was a value between 0 and 100 and
 not just a clipping of 0 and 1. I need to do ” gridsearch “in a time 
series using univariate LSTM. Sorry if my question is too simple. Thank 
you.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-469847" data-commentid="469847" data-postid="2967" data-belowelement="comment-469847" data-respondelement="respond" aria-label="Reply to Edu">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-469861" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-469861" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">February 22, 2019 at 2:46 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-469861" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Good question, I recommend this post for tuning an LSTM:<br>
<a href="https://machinelearningmastery.com/how-to-grid-search-deep-learning-models-for-time-series-forecasting/" rel="nofollow">https://machinelearningmastery.com/how-to-grid-search-deep-learning-models-for-time-series-forecasting/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-469861" data-commentid="469861" data-postid="2967" data-belowelement="comment-469861" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-469913" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-469913" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/05951c80dad74c38c28d4b0f257c0565.jfif" srcset="https://secure.gravatar.com/avatar/05951c80dad74c38c28d4b0f257c0565?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Adrian</span>
	                <span class="date">February 22, 2019 at 10:51 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-469913" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi, I am trying to use the dropout seleccion in my funciontal CNN and I get this error when I execute:<br>
Cannot clone object ” (type ): it does not seem to be a scikit-learn estimator as it does not implement a ‘get_params’ methods.</p>
<p>I have no idea how to solve it.<br>
Thanks</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-469913" data-commentid="469913" data-postid="2967" data-belowelement="comment-469913" data-respondelement="respond" aria-label="Reply to Adrian">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-469967" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-469967" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">February 23, 2019 at 6:32 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-469967" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Sorry to hear that, perhaps try manually grid searching:<br>
<a href="https://machinelearningmastery.com/how-to-grid-search-deep-learning-models-for-time-series-forecasting/" rel="nofollow">https://machinelearningmastery.com/how-to-grid-search-deep-learning-models-for-time-series-forecasting/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-469967" data-commentid="469967" data-postid="2967" data-belowelement="comment-469967" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-470127" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-470127" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/083010832ddcf73b18d982174fae8e39.jfif" srcset="https://secure.gravatar.com/avatar/083010832ddcf73b18d982174fae8e39?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">sukhpal</span>
	                <span class="date">February 23, 2019 at 11:32 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-470127" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>sir please provide me the python code of plots for comparison of 
various algorithm like adam adagrad,adadelta rmsprop for different 
epochs</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-470127" data-commentid="470127" data-postid="2967" data-belowelement="comment-470127" data-respondelement="respond" aria-label="Reply to sukhpal">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-470232" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-470232" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">February 24, 2019 at 9:09 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-470232" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks for the suggestion.</p>
<p>I believe you can perform this comparison yourself, perhaps start here:<br>
<a href="https://machinelearningmastery.com/understand-the-dynamics-of-learning-rate-on-deep-learning-neural-networks/" rel="nofollow">https://machinelearningmastery.com/understand-the-dynamics-of-learning-rate-on-deep-learning-neural-networks/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-470232" data-commentid="470232" data-postid="2967" data-belowelement="comment-470232" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-472260" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-472260" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/b0053e889e7f0728daef2240696bd16c.jfif" srcset="https://secure.gravatar.com/avatar/b0053e889e7f0728daef2240696bd16c?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">daifeng</span>
	                <span class="date">March 4, 2019 at 7:15 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-472260" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi， recently, I’m training using keras for a large data sets, so 
 only the function “fit_generator” in keras can be used. So, I am 
wondering how to use grid search for such function, for only “fit” is 
offered in GridSearchCV class.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-472260" data-commentid="472260" data-postid="2967" data-belowelement="comment-472260" data-respondelement="respond" aria-label="Reply to daifeng">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-472341" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-472341" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">March 5, 2019 at 6:34 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-472341" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I recommend performing the grid search yourself with for-loops. Here’s an example:<br>
<a href="https://machinelearningmastery.com/how-to-grid-search-deep-learning-models-for-time-series-forecasting/" rel="nofollow">https://machinelearningmastery.com/how-to-grid-search-deep-learning-models-for-time-series-forecasting/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-472341" data-commentid="472341" data-postid="2967" data-belowelement="comment-472341" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-474071" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-474071" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/505c3e54ea8d5888bc3e850f72815dfe.jfif" srcset="https://secure.gravatar.com/avatar/505c3e54ea8d5888bc3e850f72815dfe?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">ismetb</span>
	                <span class="date">March 13, 2019 at 9:03 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-474071" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Excellent post again Jason, thank you. My two questions are:</p>
<p>1) How can I search optimizer and learning rate together? When I write optimizer=optimizer(lr=lr), the code does not run. </p>
<p>2) Is there an importance order of parameters? I would like to grid 
search for several parameters and I want to group the most important 
ones </p>
<p>Regards</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-474071" data-commentid="474071" data-postid="2967" data-belowelement="comment-474071" data-respondelement="respond" aria-label="Reply to ismetb">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-474174" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-474174" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">March 14, 2019 at 9:21 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-474174" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I recommend sticking with SGD and testing different learning rates.</p>
<p>Yes, order is critical, more here (under the section “how to configure”):<br>
<a href="https://machinelearningmastery.com/gentle-introduction-mini-batch-gradient-descent-configure-batch-size/" rel="nofollow">https://machinelearningmastery.com/gentle-introduction-mini-batch-gradient-descent-configure-batch-size/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-474174" data-commentid="474174" data-postid="2967" data-belowelement="comment-474174" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-474417" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-474417" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/c74e62a57dfd924337c5cba8d33911a4.jfif" srcset="https://secure.gravatar.com/avatar/c74e62a57dfd924337c5cba8d33911a4?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Teresa Lisanti</span>
	                <span class="date">March 15, 2019 at 9:12 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-474417" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason, i am using a LeNet and i would like to say how to use 
the grid search. Is ti necessary write a function that return a model? I
 have a file named lenet.py where i wrote my neural network whit the 
class LeNet; can i use this file instead of make a new function?  Thanks
 you for your answer.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-474417" data-commentid="474417" data-postid="2967" data-belowelement="comment-474417" data-respondelement="respond" aria-label="Reply to Teresa Lisanti">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-474460" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-474460" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">March 15, 2019 at 2:26 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-474460" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You can develop the grid search any way you wish.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-474460" data-commentid="474460" data-postid="2967" data-belowelement="comment-474460" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-474692" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-474692" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/6671ba50a3ba26fbd794b59a010de656.jfif" srcset="https://secure.gravatar.com/avatar/6671ba50a3ba26fbd794b59a010de656?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Neel</span>
	                <span class="date">March 16, 2019 at 7:44 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-474692" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason, superhelful tutorial! Thanks for investing the time in writing this. </p>
<p>I am working on a multiclass classification problem using Keras. </p>
<p>Grid Search provides best parameters for the metrics defined in the 
model.compile. I tried disabling that and adding scoring= in the 
grid.fit command line. However, as others have also pointed out grid 
search only accepts “accuracy” as a valid score for optimisation and 
providing the best hyperparameters. For me the optimum hyperparameters 
would the one providing high accuracy, precision, recall on my unseen 
test data. </p>
<p>Is there a way I can save all models trained using gridsearch or as 
gridsearch iterates through a set of hyperparameter, I can extract the 
model and run a classification_report for that model. In the end, I want
 a model which gives the best results in the classification_report</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-474692" data-commentid="474692" data-postid="2967" data-belowelement="comment-474692" data-respondelement="respond" aria-label="Reply to Neel">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-474751" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-474751" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">March 17, 2019 at 6:19 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-474751" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I believe you can provide any sklearn metric for the scoring function:<br>
<a href="https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.GridSearchCV.html" rel="nofollow">https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.GridSearchCV.html</a></p>
<p>Listed here:<br>
<a href="https://scikit-learn.org/stable/modules/model_evaluation.html#scoring-parameter" rel="nofollow">https://scikit-learn.org/stable/modules/model_evaluation.html#scoring-parameter</a></p>
<p>I recommend picking one metric, not using the report.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-474751" data-commentid="474751" data-postid="2967" data-belowelement="comment-474751" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-474693" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-474693" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/6671ba50a3ba26fbd794b59a010de656.jfif" srcset="https://secure.gravatar.com/avatar/6671ba50a3ba26fbd794b59a010de656?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Neel</span>
	                <span class="date">March 16, 2019 at 7:53 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-474693" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Part 2 of the question:</p>
<p>I am currently splitting my data using train_test_split (Note1) and 
passing the testX and testY as a cross validation in grid_result. 
Purpose is to define a cross validation set to a model.</p>
<p>Note 1:</p>
<p>(trainX, testX, trainY, testY) = train_test_split(datatraincv, labeltraincv, test_size=0.40, random_state=42, shuffle=True)</p>
<p>grid_result = grid.fit(trainX, trainY, validation_data=(testX, testY), callbacks=[early_stopping_monitor])</p>
<p>*Question*: Is this required or sklearn automatically splits data in Train/Cross Val when we use grid.fit?</p>
<p>__</p>
<p>Additionally I have “datatest” and “labeltest” data which I use to predict and get the actual results on unseen data (Note 2)</p>
<p>Note 2:<br>
predictions = grid_result.best_estimator_.model.predict(datatest, batch_size=32)<br>
print(classification_report(labeltest.argmax(axis=1), predictions.argmax(axis=1), target_names=target_names))</p>
<p>*Question*: Is this required or the cross val data that I feed in is 
also unseen to the Keras algo? I used to earlier code in Matlab and CV 
data was for Theta selection such that Theta Train = the one which gets 
the highest accuracy in the Cross Val data.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-474693" data-commentid="474693" data-postid="2967" data-belowelement="comment-474693" data-respondelement="respond" aria-label="Reply to Neel">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-474752" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-474752" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">March 17, 2019 at 6:20 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-474752" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>The grid search will use k-fold cross validation to split the data.</p>
<p>Typically a new model is refit using the best parameters after the tuning process.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-474752" data-commentid="474752" data-postid="2967" data-belowelement="comment-474752" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-474976" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-474976" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/bc5f26eaf8f2bcc8685d325448b9ebdb.jfif" srcset="https://secure.gravatar.com/avatar/bc5f26eaf8f2bcc8685d325448b9ebdb?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Arian</span>
	                <span class="date">March 19, 2019 at 3:04 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-474976" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hey Jason,</p>
<p>thanks for the nice tutorial, i really enjoyed it!<br>
I would like to parallelize the process by setting n_jobs to -1 or 
something else than 1, but when i try to run fit on the grid i get this 
error:<br>
“_pickle.PicklingError: Could not pickle the task to send it to the workers.”</p>
<p>I did some research and found out, that this has to do something with Keras Objects not being pickle compatible.</p>
<p>Do you know a solution for my problem or a different method to parallelize Gridserach for Keras on CPUs?</p>
<p>Thank you very much!</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-474976" data-commentid="474976" data-postid="2967" data-belowelement="comment-474976" data-respondelement="respond" aria-label="Reply to Arian">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-475038" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-475038" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">March 19, 2019 at 8:59 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-475038" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You might have to run the grid search manually with for-loops.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-475038" data-commentid="475038" data-postid="2967" data-belowelement="comment-475038" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-476396" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-476396" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1f118d52590ed10b03a3aa33968ae7fd.jfif" srcset="https://secure.gravatar.com/avatar/1f118d52590ed10b03a3aa33968ae7fd?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Patrick</span>
	                <span class="date">March 26, 2019 at 8:55 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-476396" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Thanks for the detailed explanation! It’s very helpful. I have two questions for you:</p>
<p>In what order would you suggest to tune the parameters?<br>
Which parameters should be tuned together?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-476396" data-commentid="476396" data-postid="2967" data-belowelement="comment-476396" data-respondelement="respond" aria-label="Reply to Patrick">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-476422" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-476422" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">March 26, 2019 at 2:16 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-476422" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Great question, I recommend focusing on ensuring your model has 
enough capacity (layers/nodes) then tune learning rate, then later start
 adding regularization.</p>
<p>This section will give you tons of ideas:<br>
<a href="https://machinelearningmastery.com/start-here/#better" rel="nofollow">https://machinelearningmastery.com/start-here/#better</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-476422" data-commentid="476422" data-postid="2967" data-belowelement="comment-476422" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-480007" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-480007" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/5df54b0db34104bc13d2ee38efde0963.jfif" srcset="https://secure.gravatar.com/avatar/5df54b0db34104bc13d2ee38efde0963?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Jaime</span>
	                <span class="date">April 12, 2019 at 11:59 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-480007" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello Jason,</p>
<p>Is it possible to change the metric from Accuracy to mse. I am using 
LSTMs por trajectory forecasting, so the values are continous.  I am 
havine the error “ValueError: The model is not configured to compute 
accuracy. You should pass <code>metrics=["accuracy"]</code> to the <code>model.compile()</code> method.”</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-480007" data-commentid="480007" data-postid="2967" data-belowelement="comment-480007" data-respondelement="respond" aria-label="Reply to Jaime">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-480084" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-480084" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">April 13, 2019 at 6:32 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-480084" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>You must remove accuracy for regression problems.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-480084" data-commentid="480084" data-postid="2967" data-belowelement="comment-480084" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-480024" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-480024" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/5df54b0db34104bc13d2ee38efde0963.jfif" srcset="https://secure.gravatar.com/avatar/5df54b0db34104bc13d2ee38efde0963?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Jaime</span>
	                <span class="date">April 13, 2019 at 2:00 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-480024" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello Jason,</p>
<p>Sorry for the fool question. I found how to do it.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-480024" data-commentid="480024" data-postid="2967" data-belowelement="comment-480024" data-respondelement="respond" aria-label="Reply to Jaime">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-480090" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-480090" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">April 13, 2019 at 6:37 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-480090" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>No problem.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-480090" data-commentid="480090" data-postid="2967" data-belowelement="comment-480090" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-481469" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-481469" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/281870e9dc94766f78e70b0e20b34bb6.jfif" srcset="https://secure.gravatar.com/avatar/281870e9dc94766f78e70b0e20b34bb6?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">abhijit</span>
	                <span class="date">April 20, 2019 at 5:10 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-481469" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hello Jason,</p>
<p>I tried a custom AUC metric with gridsearch cv in keras , Can you 
just me where i am getting wrong. I am getting an error for this</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-481469" data-commentid="481469" data-postid="2967" data-belowelement="comment-481469" data-respondelement="respond" aria-label="Reply to abhijit">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-481563" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-481563" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">April 21, 2019 at 8:20 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-481563" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Perhaps try running the grid search manually?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-481563" data-commentid="481563" data-postid="2967" data-belowelement="comment-481563" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-482583" class="comment odd alt thread-even depth-1 parent">

	      	<div id="li-comment-482583" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/8539529f6fa88c231ff405447c5e6ce3.jfif" srcset="https://secure.gravatar.com/avatar/8539529f6fa88c231ff405447c5e6ce3?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="https://bagustris.blogspot.com/" rel="external nofollow" class="url">Bagus</a></span>
	                <span class="date">April 25, 2019 at 10:23 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-482583" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,</p>
<p>I don’t see splitting the dataset for test/train there. Is this (data
 splitting) done within cross-validation? If so, what is the percentage 
of division between train/test/validate inside the gridSearchCV?</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-482583" data-commentid="482583" data-postid="2967" data-belowelement="comment-482583" data-respondelement="respond" aria-label="Reply to Bagus">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-482657" class="comment byuser comment-author-jasonb bypostauthor even depth-2">

	      	<div id="li-comment-482657" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">April 26, 2019 at 8:34 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-482657" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>In the above tutorial, the dataset is split using k-fold cross validation as part of the grid search.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-482657" data-commentid="482657" data-postid="2967" data-belowelement="comment-482657" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-483848" class="comment odd alt thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-483848" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1b09de6d90f384cac2e02aa73531b3fb.jfif" srcset="https://secure.gravatar.com/avatar/1b09de6d90f384cac2e02aa73531b3fb?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">thiagu</span>
	                <span class="date">May 3, 2019 at 10:48 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-483848" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>HI JASON,</p>
<p>                 IN THE ABOVE EXAMPLE CAN WE USE LSTM MODEL.IS THAT POSSIBLE..</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-483848" data-commentid="483848" data-postid="2967" data-belowelement="comment-483848" data-respondelement="respond" aria-label="Reply to thiagu">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-483868" class="comment byuser comment-author-jasonb bypostauthor even depth-2 parent">

	      	<div id="li-comment-483868" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">May 3, 2019 at 2:43 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-483868" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>I would not recommend it as sequence prediction is best evaluated
 using walk-forward validation or careful management if samples.</p>
<p>For example, see this post:<br>
<a href="https://machinelearningmastery.com/how-to-grid-search-deep-learning-models-for-time-series-forecasting/" rel="nofollow">https://machinelearningmastery.com/how-to-grid-search-deep-learning-models-for-time-series-forecasting/</a></p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-483868" data-commentid="483868" data-postid="2967" data-belowelement="comment-483868" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-483870" class="comment odd alt depth-3">

	      	<div id="li-comment-483870" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1b09de6d90f384cac2e02aa73531b3fb.jfif" srcset="https://secure.gravatar.com/avatar/1b09de6d90f384cac2e02aa73531b3fb?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">thiagu</span>
	                <span class="date">May 3, 2019 at 3:04 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-483870" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>thanks a lot jason</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-483870" data-commentid="483870" data-postid="2967" data-belowelement="comment-483870" data-respondelement="respond" aria-label="Reply to thiagu">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-486015" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-486015" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/5dc1492a94c87f3ebecaae884fc61d41.jfif" srcset="https://secure.gravatar.com/avatar/5dc1492a94c87f3ebecaae884fc61d41?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">krs reddy</span>
	                <span class="date">May 20, 2019 at 7:33 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-486015" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>jason,</p>
<p>how to optimize for neuons in different layers? when model has 2 or 
more hidden layers and task is to get optimal no.of neurons in each 
layer– how to proceed??</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-486015" data-commentid="486015" data-postid="2967" data-belowelement="comment-486015" data-respondelement="respond" aria-label="Reply to krs reddy">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-486062" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-486062" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">May 21, 2019 at 6:33 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-486062" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>We never get an optimal model, we get a good enough model.</p>
<p>Try a suite of configurations and see what works well.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-486062" data-commentid="486062" data-postid="2967" data-belowelement="comment-486062" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-486017" class="comment even thread-odd thread-alt depth-1 parent">

	      	<div id="li-comment-486017" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/5dc1492a94c87f3ebecaae884fc61d41.jfif" srcset="https://secure.gravatar.com/avatar/5dc1492a94c87f3ebecaae884fc61d41?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">krs reddy</span>
	                <span class="date">May 20, 2019 at 7:37 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-486017" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>jason,</p>
<p>how to hyper parameter tune for optimization algorithm, learning rate and momentum in a single go??</p>
<p>here optimization algo is hyperparameter to a model , learning rate and momentum are hyperparameters to optimization function.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-486017" data-commentid="486017" data-postid="2967" data-belowelement="comment-486017" data-respondelement="respond" aria-label="Reply to krs reddy">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-486064" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-486064" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">May 21, 2019 at 6:34 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-486064" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Perhaps use multiple nested loops.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-486064" data-commentid="486064" data-postid="2967" data-belowelement="comment-486064" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-486103" class="comment even thread-even depth-1 parent">

	      	<div id="li-comment-486103" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/7c2d1138fa00ab1d31a753360ad415b4.jfif" srcset="https://secure.gravatar.com/avatar/7c2d1138fa00ab1d31a753360ad415b4?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Prem Alphonse</span>
	                <span class="date">May 21, 2019 at 2:31 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-486103" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Hi Jason,<br>
As you have shown one by one tuning of each parameters, can it be done 
in same way and combine the best values to build final model, or each 
parameter change may depend on others which we have to do nested loops 
to find the best set of parameters.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-486103" data-commentid="486103" data-postid="2967" data-belowelement="comment-486103" data-respondelement="respond" aria-label="Reply to Prem Alphonse">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	<ul class="children">

		<li id="comment-486110" class="comment byuser comment-author-jasonb bypostauthor odd alt depth-2">

	      	<div id="li-comment-486110" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_002.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name"><a href="http://machinelearningmastery.com/" rel="external nofollow" class="url">Jason Brownlee</a></span>
	                <span class="date">May 21, 2019 at 2:47 pm</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-486110" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>Yes, you can use nested loops across each hyperparameter if you wish.</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-486110" data-commentid="486110" data-postid="2967" data-belowelement="comment-486110" data-respondelement="respond" aria-label="Reply to Jason Brownlee">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->

		<li id="comment-487235" class="comment even thread-odd thread-alt depth-1">

	      	<div id="li-comment-487235" class="comment-container">

					                <div class="avatar"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/999a09c5ad98baadfc70226d7d31bae7.jfif" srcset="https://secure.gravatar.com/avatar/999a09c5ad98baadfc70226d7d31bae7?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" width="40" height="40"></div>
	            
		      	<div class="comment-head">

	                <span class="name">Marco Sabatini</span>
	                <span class="date">May 31, 2019 at 5:09 am</span>
	                <span class="perma"><a href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#comment-487235" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>

				</div><!-- /.comment-head -->

		   		<div class="comment-entry">

				<p>set cv=5 (0r 3) instead of jobs=-1</p>

				
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="#comment-487235" data-commentid="487235" data-postid="2967" data-belowelement="comment-487235" data-respondelement="respond" aria-label="Reply to Marco Sabatini">Reply</a>	                </div><!-- /.reply -->

				</div><!-- /comment-entry -->

			</div><!-- /.comment-container -->

	</li><!-- #comment-## -->
			</ol>
		 	</div>	<div id="respond" class="comment-respond">
		<h3 id="reply-title" class="comment-reply-title">Leave a Reply <small><a rel="nofollow" id="cancel-comment-reply-link" href="https://machinelearningmastery.com/grid-search-hyperparameters-deep-learning-models-python-keras/#respond" style="display:none;">Click here to cancel reply.</a></small></h3>			<form action="https://machinelearningmastery.com/wp-comments-post.php?wpe-comment-post=mlmastery" method="post" id="commentform" class="comment-form">
				<p class="comment-form-comment"><label class="hide" for="comment">Comment</label> <textarea tabindex="4" id="comment" name="comment" cols="50" rows="10" maxlength="65525" required="required"></textarea></p><p class="comment-form-author"><input id="author" name="author" class="txt" tabindex="1" size="30" aria-required="true" type="text"><label for="author">Name <span class="required">(required)</span></label> </p>
<p class="comment-form-email"><input id="email" name="email" class="txt" tabindex="2" size="30" aria-required="true" type="text"><label for="email">Email (will not be published) <span class="required">(required)</span></label> </p>
<p class="comment-form-url"><input id="url" name="url" class="txt" tabindex="3" size="30" type="text"><label for="url">Website</label></p>
<p class="form-submit"><input name="submit" id="submit" class="submit" value="Submit Comment" type="submit"> <input name="comment_post_ID" value="2967" id="comment_post_ID" type="hidden">
<input name="comment_parent" id="comment_parent" value="0" type="hidden">
</p><p style="display: none;"><input id="akismet_comment_nonce" name="akismet_comment_nonce" value="a6476fa1ae" type="hidden"></p><p style="display: none;"></p>			<input id="ak_js" name="ak_js" value="1559538179374" type="hidden"></form>
			</div><!-- #respond -->
	     
            </section><!-- /#main -->
                
            <aside id="sidebar">
<div id="woo_blogauthorinfo-2" class="widget widget_woo_blogauthorinfo"><h3>Welcome to Machine Learning Mastery!</h3><span class="left"><img alt="" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/1d75d46040c28497f0dee5d8e100db37_003.jfif" srcset="https://secure.gravatar.com/avatar/1d75d46040c28497f0dee5d8e100db37?s=200&amp;d=mm&amp;r=g 2x" class="avatar avatar-100 photo" width="100" height="100"></span>
<p>Hi, I'm <b>Jason Brownlee</b>, PhD.
<br>
I write tutorials to help developers (<i>like you</i>) get results with machine learning.</p>
<p><a href="https://machinelearningmastery.com/about">Read More</a></p>
<div class="fix"></div>
</div><div id="text-6" class="widget widget_text">			<div class="textwidget"><p></p><center><br>
<strong>Deep Learning with Python</strong><br>
No math, just tutorials and working code.<p></p>
<p><a href="https://machinelearningmastery.com/deep-learning-with-python/">Click to Get Started Now!</a><br>
<a href="https://machinelearningmastery.com/deep-learning-with-python/"><img src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/DeepLearningWithPython-220.png"></a><br>
</p></center><p></p>
</div>
		</div>
		<div id="woo_tabs-2" class="widget widget_woo_tabs"> 		<div id="tabs">

            <ul class="wooTabs">
                                <li class="popular"><a href="#tab-pop" class="selected">Popular</a></li>                                                            </ul>

            <div class="clear"></div>

            <div class="boxes box inside">

	            
                                <ul id="tab-pop" class="list" style="display: block;">
                    	<li>
		<a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-multi-step-time-series-forecasting-of-household-power-consumption/" title="How to Develop LSTM Models for Multi-Step Time Series Forecasting of Household Power Consumption"><img src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/How-to-Develop-LSTM-Models-for-Multi-Step-Time-Series-Forec.jfif" class="thumbnail wp-post-image" alt="How to Develop LSTM Models for Multi-Step Time Series Forecasting of Household Power Consumption" title="How to Develop LSTM Models for Multi-Step Time Series Forecasting of Household Power Consumption" width="45" height="45"></a>		<a title="How to Develop LSTM Models for Multi-Step Time Series Forecasting of Household Power Consumption" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-multi-step-time-series-forecasting-of-household-power-consumption/">How to Develop LSTM Models for Multi-Step Time Series Forecasting of Household Power Consumption</a>
		<span class="meta">October 10, 2018</span>
		<div class="fix"></div>
	</li>
		<li>
		<a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/" title="How to Develop LSTM Models for Time Series Forecasting"><img src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/How-to-Develop-LSTM-Models-for-Time-Series-Forecasting-150x.jfif" class="thumbnail wp-post-image" alt="How to Develop LSTM Models for Time Series Forecasting" title="How to Develop LSTM Models for Time Series Forecasting" width="45" height="45"></a>		<a title="How to Develop LSTM Models for Time Series Forecasting" href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-time-series-forecasting/">How to Develop LSTM Models for Time Series Forecasting</a>
		<span class="meta">November 14, 2018</span>
		<div class="fix"></div>
	</li>
		<li>
		<a href="https://machinelearningmastery.com/time-series-forecasting-methods-in-python-cheat-sheet/" title="11 Classical Time Series Forecasting Methods in Python (Cheat Sheet)"><img src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/11-Classical-Time-Series-Forecasting-Methods-in-Python-Chea.jfif" class="thumbnail wp-post-image" alt="11 Classical Time Series Forecasting Methods in Python (Cheat Sheet)" title="11 Classical Time Series Forecasting Methods in Python (Cheat Sheet)" width="45" height="45"></a>		<a title="11 Classical Time Series Forecasting Methods in Python (Cheat Sheet)" href="https://machinelearningmastery.com/time-series-forecasting-methods-in-python-cheat-sheet/">11 Classical Time Series Forecasting Methods in Python (Cheat Sheet)</a>
		<span class="meta">August 6, 2018</span>
		<div class="fix"></div>
	</li>
		<li>
		<a href="https://machinelearningmastery.com/lstm-autoencoders/" title="A Gentle Introduction to LSTM Autoencoders"><img src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/LSTM-Autoencoder-Model-With-Two-Decoders-150x150.png" class="thumbnail wp-post-image" alt="LSTM Autoencoder Model With Two Decoders" title="A Gentle Introduction to LSTM Autoencoders" srcset="https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/08/LSTM-Autoencoder-Model-With-Two-Decoders-150x150.png 150w, https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/08/LSTM-Autoencoder-Model-With-Two-Decoders-296x300.png 296w, https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/08/LSTM-Autoencoder-Model-With-Two-Decoders-768x778.png 768w, https://3qeqpr26caki16dnhd19sv6by6v-wpengine.netdna-ssl.com/wp-content/uploads/2018/08/LSTM-Autoencoder-Model-With-Two-Decoders.png 778w" sizes="(max-width: 45px) 100vw, 45px" width="45" height="45"></a>		<a title="A Gentle Introduction to LSTM Autoencoders" href="https://machinelearningmastery.com/lstm-autoencoders/">A Gentle Introduction to LSTM Autoencoders</a>
		<span class="meta">November 5, 2018</span>
		<div class="fix"></div>
	</li>
		<li>
		<a href="https://machinelearningmastery.com/how-to-develop-rnn-models-for-human-activity-recognition-time-series-classification/" title="How to Develop RNN Models for Human Activity Recognition Time Series Classification"><img src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/How-to-Develop-RNN-Models-for-Human-Activity-Recognition-Ti.jfif" class="thumbnail wp-post-image" alt="How to Develop RNN Models for Human Activity Recognition Time Series Classification" title="How to Develop RNN Models for Human Activity Recognition Time Series Classification" width="45" height="45"></a>		<a title="How to Develop RNN Models for Human Activity Recognition Time Series Classification" href="https://machinelearningmastery.com/how-to-develop-rnn-models-for-human-activity-recognition-time-series-classification/">How to Develop RNN Models for Human Activity Recognition Time Series Classification</a>
		<span class="meta">September 24, 2018</span>
		<div class="fix"></div>
	</li>
		<li>
		<a href="https://machinelearningmastery.com/how-to-develop-convolutional-neural-network-models-for-time-series-forecasting/" title="How to Develop Convolutional Neural Network Models for Time Series Forecasting"><img src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/Plot-of-Multi-Headed-1D-CNN-for-Multivariate-Time-Series-For.png" class="thumbnail wp-post-image" alt="Plot of Multi-Headed 1D CNN for Multivariate Time Series Forecasting" title="How to Develop Convolutional Neural Network Models for Time Series Forecasting" width="45" height="45"></a>		<a title="How to Develop Convolutional Neural Network Models for Time Series Forecasting" href="https://machinelearningmastery.com/how-to-develop-convolutional-neural-network-models-for-time-series-forecasting/">How to Develop Convolutional Neural Network Models for Time Series Forecasting</a>
		<span class="meta">November 12, 2018</span>
		<div class="fix"></div>
	</li>
		<li style="border-bottom: 0px none;">
		<a href="https://machinelearningmastery.com/when-to-use-mlp-cnn-and-rnn-neural-networks/" title="When to Use MLP, CNN, and RNN Neural Networks"><img src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/When-to-Use-MLP-CNN-and-RNN-Neural-Networks-150x150.jfif" class="thumbnail wp-post-image" alt="When to Use MLP, CNN, and RNN Neural Networks" title="When to Use MLP, CNN, and RNN Neural Networks" width="45" height="45"></a>		<a title="When to Use MLP, CNN, and RNN Neural Networks" href="https://machinelearningmastery.com/when-to-use-mlp-cnn-and-rnn-neural-networks/">When to Use MLP, CNN, and RNN Neural Networks</a>
		<span class="meta">July 23, 2018</span>
		<div class="fix"></div>
	</li>
	                </ul>
                                                                
            </div><!-- /.boxes -->

        </div><!-- /wooTabs -->

        </div>         <div id="custom_html-2" class="widget_text widget widget_custom_html"><h3>Top beginner tutorials:</h3><div class="textwidget custom-html-widget"><ul>
	<li><a href="https://machinelearningmastery.com/setup-python-environment-machine-learning-deep-learning-anaconda/">How to Install Python for Machine Learning</a></li>
  <li><a href="https://machinelearningmastery.com/machine-learning-in-python-step-by-step/">Your First Machine Learning Project in Python</a></li>
	<li><a href="https://machinelearningmastery.com/tutorial-first-neural-network-python-keras/">Your First Neural Network in Python</a></li>
	<li><a href="https://machinelearningmastery.com/how-to-run-your-first-classifier-in-weka/">Your First Classifier in Weka</a></li>
	<li><a href="https://machinelearningmastery.com/arima-for-time-series-forecasting-with-python/">Your First Time Series Forecasting Project</a></li>
</ul></div></div><div id="custom_html-3" class="widget_text widget widget_custom_html"><h3>Top project tutorials:</h3><div class="textwidget custom-html-widget"><ul>
	<li><a href="https://machinelearningmastery.com/develop-a-deep-learning-caption-generation-model-in-python/">Photo Captioning Project</a></li>
	<li><a href="https://machinelearningmastery.com/develop-neural-machine-translation-system-keras/">Neural Machine Translation Project</a></li>
	<li><a href="https://machinelearningmastery.com/develop-word-embedding-model-predicting-movie-review-sentiment/">Sentiment Analysis Project</a></li>
	<li><a href="https://machinelearningmastery.com/how-to-develop-lstm-models-for-multi-step-time-series-forecasting-of-household-power-consumption/">Power Forecasting Project</a></li>
</ul></div></div></aside><!-- /#sidebar -->

		</div><!-- /#main-sidebar-container -->         

		
    </div><!-- /#content -->
	
	<footer id="footer" class="col-full">

		
		<div id="copyright" class="col-left">
			<p>© 2019 Machine Learning Mastery. All Rights Reserved. </p>		</div>

		<div id="credit" class="col-right">
			<p></p><p>
<a href="https://machinelearningmastery.com/privacy/">Privacy</a> | 
<a href="https://machinelearningmastery.com/disclaimer/">Disclaimer</a> | 
<a href="https://machinelearningmastery.com/terms-of-service/">Terms</a> | 
<a href="https://machinelearningmastery.com/contact/">Contact</a>
</p><p></p>		</div>

	</footer>

	
	</div><!-- /#inner-wrapper -->

</div><!-- /#wrapper -->

<div class="fix"></div><!--/.fix-->

<!-- Drip -->
<script type="text/javascript">
  var _dcq = _dcq || [];
  var _dcs = _dcs || {};
  _dcs.account = '9556588';

  (function() {
    var dc = document.createElement('script');
    dc.type = 'text/javascript'; dc.async = true;
    dc.src = '//tag.getdrip.com/9556588.js';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(dc, s);
  })();
</script>
<!-- end Drip --><!-- Woo Tabs Widget -->
<script type="text/javascript">
jQuery(document).ready(function(){
	// UL = .wooTabs
	// Tab contents = .inside

	var tag_cloud_class = '#tagcloud';

	//Fix for tag clouds - unexpected height before .hide()
	var tag_cloud_height = jQuery( '#tagcloud').height();

	jQuery( '.inside ul li:last-child').css( 'border-bottom','0px' ); // remove last border-bottom from list in tab content
	jQuery( '.wooTabs').each(function(){
		jQuery(this).children( 'li').children( 'a:first').addClass( 'selected' ); // Add .selected class to first tab on load
	});
	jQuery( '.inside > *').hide();
	jQuery( '.inside > *:first-child').show();

	jQuery( '.wooTabs li a').click(function(evt){ // Init Click funtion on Tabs

		var clicked_tab_ref = jQuery(this).attr( 'href' ); // Strore Href value

		jQuery(this).parent().parent().children( 'li').children( 'a').removeClass( 'selected' ); //Remove selected from all tabs
		jQuery(this).addClass( 'selected' );
		jQuery(this).parent().parent().parent().children( '.inside').children( '*').hide();

		jQuery( '.inside ' + clicked_tab_ref).fadeIn(500);

		 evt.preventDefault();

	})
})
</script>
<script type="text/javascript" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/comment-reply.js"></script>
<script type="text/javascript">
/* <![CDATA[ */
var wpcf7 = {"apiSettings":{"root":"https:\/\/machinelearningmastery.com\/wp-json\/contact-form-7\/v1","namespace":"contact-form-7\/v1"},"cached":"1"};
/* ]]> */
</script>
<script type="text/javascript" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/scripts.js"></script>
<script type="text/javascript" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/wp-embed.js"></script>
<script async="async" type="text/javascript" src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/form.js"></script>
<script type="text/javascript">!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://static1.twitcount.com/js/twitcount.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitcount_plugins');</script>
<div style="position: absolute; right: 0px; left: 0px; bottom: 0px; top: 0px; z-index: 2147483646; background: black none repeat scroll 0% 0%; width: 100%; opacity: 0.5; display: none; height: 119559px;"></div><iframe src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/a_002.htm" style="position: absolute; left: 0px; top: 0px; width: 100%; display: none; border: medium none; z-index: 2147483647; height: 727px;"></iframe><iframe src="How%20to%20Grid%20Search%20Hyperparameters%20for%20Deep%20Learning%20Models%20in%20Python%20With%20Keras_files/a_002.htm" style="position: absolute; left: 0px; top: 0px; width: 100%; display: none; border: medium none; z-index: 2147483647; height: 727px;"></iframe><div class="drip-tab-container">
  <div id="drip-2211" class="drip-tab no-image classic bottom right">
    <div id="drip-header-2211" class="drip-header">
      <a href="#" id="drip-toggle-2211" class="drip-toggle">
        <h2 id="drip-teaser-2211">Your Start in Machine Learning</h2>
        <span id="drip-tab-up-2211" class="drip-arrow up">
          <svg width="12px" height="8px" viewBox="1362 659 12 8" version="1.1" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink">
            <polygon id="right_angle" stroke="none" fill="#FFFFFF" fill-rule="evenodd" transform="translate(1368.000000, 662.703125) rotate(-90.000000) translate(-1368.000000, -662.703125) " points="1364.29688 667.296875 1368.89062 662.703125 1364.29688 658.109375 1365.70312 656.703125 1371.70312 662.703125 1365.70312 668.703125"></polygon>
          </svg>
        </span>
        <span id="drip-tab-down-2211" class="drip-arrow down" style="display: none"></span>
      </a>
    </div>

    <div id="drip-content-2211" class="drip-content drip-clearfix" style="height: auto; bottom: -549px;">
      <div id="drip-form-panel-2211" class="drip-panel" style="display: block;">
        <a id="drip-close-2211" class="drip-close">×</a>
        <h3 id="drip-content-header-2211">Your Start in Machine Learning</h3>
        <div id="drip-scroll-2211" class="drip-scroll">
          <div class="drip-clearfix">
            
            <div class="drip-description">You can master applied Machine Learning&nbsp;<br>
<strong>without the math or fancy degree</strong>.<br>
Find out how in this <em>free</em>&nbsp;and <em>practical</em> email course.</div>
          </div>
          <form id="drip-form-2211">
            <div style="display: none">
              <input name="form_id" value="2211" type="hidden">
            </div>
            <dl class="no-labels">
              
                
                  <dt>Email Address</dt>
                  <dd class="drip-clearfix">
                    
                      <input name="fields[email]" placeholder="Email Address" class="drip-text-field" type="email">
                      <div id="drip-errors-for-email-2211" class="drip-errors"></div>
                    
                  </dd>
                
              
                
                  <dt></dt>
                  <dd class="drip-clearfix">
                    
                      <div class="classic--checkbox hidden" data-container="eu-checkbox">
                        <input name="fields[eu_consent]" id="drip-field-eu_consent-denied" value="denied" disabled="disabled" type="hidden">
                        <input name="fields[eu_consent]" id="drip-field-eu_consent" value="granted" disabled="disabled" type="checkbox">
                        <label for="drip-field-eu_consent">I consent to receive information about services and special offers by email. For more information, see the <a href="https://machinelearningmastery.com/privacy/">Privacy Policy</a>.</label>
                      </div>
                    
                  </dd>
                
              
                
                  <input name="fields[eu_consent_message]" value="I consent to receive information about services and special offers by email. For more information, see the Privacy Policy (https://machinelearningmastery.com/privacy/)." type="hidden">
                
              
              
              <div style="display: none;" aria-hidden="true">
                <dt for="website">Website</dt>
                <dd>
                  <input id="website" name="website" placeholder="Website" class="drip-text-field" tabindex="-1" autocomplete="false" type="text">
                </dd>
              </div>
            </dl>
            <div class="form-controls">
              <input name="submit" value="Start My Email Course" id="drip-submit-2211" class="drip-submit-button" type="submit">
            </div>
          </form>
        </div>
      </div>

      <div id="drip-success-panel-2211" class="drip-success drip-panel drip-clearfix" style="display: none">
        <a id="drip-hide-2211" class="drip-close">×</a>
        <h3>Thank you for signing up!</h3>
        <p class="drip-description">Please check your email and click the link provided to confirm your subscription.</p>
      </div>

      
    </div>
  </div>
</div></body></html>